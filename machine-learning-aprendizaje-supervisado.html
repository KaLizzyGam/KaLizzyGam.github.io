<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 6 MACHINE LEARNING: APRENDIZAJE SUPERVISADO | AMAT- Introducción a Ciencia de Datos y Machine Learning</title>
  <meta name="description" content="AMAT Curso 1 : Introduccion a Ciencia de Datos" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 6 MACHINE LEARNING: APRENDIZAJE SUPERVISADO | AMAT- Introducción a Ciencia de Datos y Machine Learning" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="AMAT Curso 1 : Introduccion a Ciencia de Datos" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 6 MACHINE LEARNING: APRENDIZAJE SUPERVISADO | AMAT- Introducción a Ciencia de Datos y Machine Learning" />
  
  <meta name="twitter:description" content="AMAT Curso 1 : Introduccion a Ciencia de Datos" />
  

<meta name="author" content="Karina Lizette Gamboa Puente" />
<meta name="author" content="Oscar Arturo Bringas López" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="machine-learning-conceptos-básicos.html"/>
<link rel="next" href="machine-learning-aprendizaje-no-supervisado.html"/>
<script src="libs/header-attrs-2.10/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.4.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.57.1/plotly-latest.min.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./"><img src="img/amat-logo.png" width="280"></a></li|
|:-:|  
<center>Introducción a Ciencia de Datos y Machine Learning</center>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> BIENVENIDA</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#objetivo"><i class="fa fa-check"></i><b>1.1</b> Objetivo</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#quienes-somos"><i class="fa fa-check"></i><b>1.2</b> ¿Quienes somos?</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> INTRODUCCIÓN</a>
<ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#lo-que-no-es-ciencia-de-datos"><i class="fa fa-check"></i><b>2.1</b> Lo que NO es Ciencia de Datos</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="intro.html"><a href="intro.html#definiendo-conceptos"><i class="fa fa-check"></i><b>2.1.1</b> Definiendo conceptos:</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#objetivo-de-la-ciencia-se-datos"><i class="fa fa-check"></i><b>2.2</b> Objetivo de la Ciencia se Datos</a></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#qué-se-requiere-para-hacer-ciencia-de-datos"><i class="fa fa-check"></i><b>2.3</b> ¿Qué se requiere para hacer Ciencia de Datos?</a></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#tipos-de-problemas-que-se-pueden-resolver-con-ciencia-de-datos"><i class="fa fa-check"></i><b>2.4</b> Tipos de problemas que se pueden resolver con Ciencia de Datos</a></li>
<li class="chapter" data-level="2.5" data-path="intro.html"><a href="intro.html#tipos-de-aprendizaje"><i class="fa fa-check"></i><b>2.5</b> Tipos de aprendizaje</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="intro.html"><a href="intro.html#aprendizaje-supervisado"><i class="fa fa-check"></i><b>2.5.1</b> Aprendizaje supervisado</a></li>
<li class="chapter" data-level="2.5.2" data-path="intro.html"><a href="intro.html#aprendizaje-no-supervisado"><i class="fa fa-check"></i><b>2.5.2</b> Aprendizaje no supervisado</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="intro.html"><a href="intro.html#ciclo-de-un-proyecto-de-ciencia-de-datos"><i class="fa fa-check"></i><b>2.6</b> Ciclo de un proyecto de Ciencia de Datos</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="transformacion-y-manipulacion-de-estructura-de-datos.html"><a href="transformacion-y-manipulacion-de-estructura-de-datos.html"><i class="fa fa-check"></i><b>3</b> TRANSFORMACION Y MANIPULACION DE ESTRUCTURA DE DATOS</a>
<ul>
<li class="chapter" data-level="3.1" data-path="transformacion-y-manipulacion-de-estructura-de-datos.html"><a href="transformacion-y-manipulacion-de-estructura-de-datos.html#importación-de-datos"><i class="fa fa-check"></i><b>3.1</b> Importación de datos</a></li>
<li class="chapter" data-level="3.2" data-path="transformacion-y-manipulacion-de-estructura-de-datos.html"><a href="transformacion-y-manipulacion-de-estructura-de-datos.html#lectura-de-datos"><i class="fa fa-check"></i><b>3.2</b> Lectura de datos</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="transformacion-y-manipulacion-de-estructura-de-datos.html"><a href="transformacion-y-manipulacion-de-estructura-de-datos.html#archivos-csv"><i class="fa fa-check"></i><b>3.2.1</b> Archivos <em>csv</em></a></li>
<li class="chapter" data-level="3.2.2" data-path="transformacion-y-manipulacion-de-estructura-de-datos.html"><a href="transformacion-y-manipulacion-de-estructura-de-datos.html#archivos-xls-y-xlsx"><i class="fa fa-check"></i><b>3.2.2</b> Archivos <em>xls</em> y <em>xlsx</em></a></li>
<li class="chapter" data-level="3.2.3" data-path="transformacion-y-manipulacion-de-estructura-de-datos.html"><a href="transformacion-y-manipulacion-de-estructura-de-datos.html#archivos-json"><i class="fa fa-check"></i><b>3.2.3</b> Archivos json</a></li>
<li class="chapter" data-level="3.2.4" data-path="transformacion-y-manipulacion-de-estructura-de-datos.html"><a href="transformacion-y-manipulacion-de-estructura-de-datos.html#bases-de-datos"><i class="fa fa-check"></i><b>3.2.4</b> Bases de Datos</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="transformacion-y-manipulacion-de-estructura-de-datos.html"><a href="transformacion-y-manipulacion-de-estructura-de-datos.html#consultas-de-datos-con-tidyverse"><i class="fa fa-check"></i><b>3.3</b> Consultas de datos con tidyverse</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="transformacion-y-manipulacion-de-estructura-de-datos.html"><a href="transformacion-y-manipulacion-de-estructura-de-datos.html#select"><i class="fa fa-check"></i><b>3.3.1</b> select()</a></li>
<li class="chapter" data-level="3.3.2" data-path="transformacion-y-manipulacion-de-estructura-de-datos.html"><a href="transformacion-y-manipulacion-de-estructura-de-datos.html#filter"><i class="fa fa-check"></i><b>3.3.2</b> filter()</a></li>
<li class="chapter" data-level="3.3.3" data-path="transformacion-y-manipulacion-de-estructura-de-datos.html"><a href="transformacion-y-manipulacion-de-estructura-de-datos.html#arrange"><i class="fa fa-check"></i><b>3.3.3</b> arrange()</a></li>
<li class="chapter" data-level="3.3.4" data-path="transformacion-y-manipulacion-de-estructura-de-datos.html"><a href="transformacion-y-manipulacion-de-estructura-de-datos.html#mutate"><i class="fa fa-check"></i><b>3.3.4</b> mutate()</a></li>
<li class="chapter" data-level="3.3.5" data-path="transformacion-y-manipulacion-de-estructura-de-datos.html"><a href="transformacion-y-manipulacion-de-estructura-de-datos.html#summarise"><i class="fa fa-check"></i><b>3.3.5</b> summarise()</a></li>
<li class="chapter" data-level="3.3.6" data-path="transformacion-y-manipulacion-de-estructura-de-datos.html"><a href="transformacion-y-manipulacion-de-estructura-de-datos.html#group_by"><i class="fa fa-check"></i><b>3.3.6</b> group_by()</a></li>
<li class="chapter" data-level="3.3.7" data-path="transformacion-y-manipulacion-de-estructura-de-datos.html"><a href="transformacion-y-manipulacion-de-estructura-de-datos.html#join"><i class="fa fa-check"></i><b>3.3.7</b> join()</a></li>
<li class="chapter" data-level="3.3.8" data-path="transformacion-y-manipulacion-de-estructura-de-datos.html"><a href="transformacion-y-manipulacion-de-estructura-de-datos.html#pivot_longer"><i class="fa fa-check"></i><b>3.3.8</b> pivot_longer()</a></li>
<li class="chapter" data-level="3.3.9" data-path="transformacion-y-manipulacion-de-estructura-de-datos.html"><a href="transformacion-y-manipulacion-de-estructura-de-datos.html#pivot_wider"><i class="fa fa-check"></i><b>3.3.9</b> pivot_wider()</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="transformacion-y-manipulacion-de-estructura-de-datos.html"><a href="transformacion-y-manipulacion-de-estructura-de-datos.html#referencias"><i class="fa fa-check"></i><b>3.4</b> Referencias:</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="analisis-exploratorio-y-visualización.html"><a href="analisis-exploratorio-y-visualización.html"><i class="fa fa-check"></i><b>4</b> ANALISIS EXPLORATORIO Y VISUALIZACIÓN</a>
<ul>
<li class="chapter" data-level="4.1" data-path="analisis-exploratorio-y-visualización.html"><a href="analisis-exploratorio-y-visualización.html#eda-análisis-exploratorio-de-datos"><i class="fa fa-check"></i><b>4.1</b> EDA: Análisis Exploratorio de Datos</a></li>
<li class="chapter" data-level="4.2" data-path="analisis-exploratorio-y-visualización.html"><a href="analisis-exploratorio-y-visualización.html#geda-análisis-exploratorio-de-datos-gráficos"><i class="fa fa-check"></i><b>4.2</b> GEDA: Análisis Exploratorio de Datos Gráficos</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="analisis-exploratorio-y-visualización.html"><a href="analisis-exploratorio-y-visualización.html#lo-que-no-se-debe-hacer"><i class="fa fa-check"></i><b>4.2.1</b> Lo que no se debe hacer…</a></li>
<li class="chapter" data-level="4.2.2" data-path="analisis-exploratorio-y-visualización.html"><a href="analisis-exploratorio-y-visualización.html#principios-de-visualización"><i class="fa fa-check"></i><b>4.2.2</b> Principios de visualización</a></li>
<li class="chapter" data-level="4.2.3" data-path="analisis-exploratorio-y-visualización.html"><a href="analisis-exploratorio-y-visualización.html#principios-generales-del-diseño-analítico"><i class="fa fa-check"></i><b>4.2.3</b> Principios generales del diseño analítico:</a></li>
<li class="chapter" data-level="4.2.4" data-path="analisis-exploratorio-y-visualización.html"><a href="analisis-exploratorio-y-visualización.html#técnicas-de-visualización"><i class="fa fa-check"></i><b>4.2.4</b> Técnicas de visualización:</a></li>
<li class="chapter" data-level="4.2.5" data-path="analisis-exploratorio-y-visualización.html"><a href="analisis-exploratorio-y-visualización.html#indicadores-de-calidad-gráfica"><i class="fa fa-check"></i><b>4.2.5</b> Indicadores de calidad gráfica:</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="analisis-exploratorio-y-visualización.html"><a href="analisis-exploratorio-y-visualización.html#uso-decisión-e-implementación-de-técnicas-gráficas."><i class="fa fa-check"></i><b>4.3</b> Uso, decisión e implementación de técnicas gráficas.</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="analisis-exploratorio-y-visualización.html"><a href="analisis-exploratorio-y-visualización.html#gráficos-univariados"><i class="fa fa-check"></i><b>4.3.1</b> Gráficos univariados:</a></li>
<li class="chapter" data-level="4.3.2" data-path="analisis-exploratorio-y-visualización.html"><a href="analisis-exploratorio-y-visualización.html#gráficos-multivariados"><i class="fa fa-check"></i><b>4.3.2</b> Gráficos multivariados</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="analisis-exploratorio-y-visualización.html"><a href="analisis-exploratorio-y-visualización.html#ggplot2"><i class="fa fa-check"></i><b>4.4</b> Ggplot2</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="analisis-exploratorio-y-visualización.html"><a href="analisis-exploratorio-y-visualización.html#objetos-aesteticos"><i class="fa fa-check"></i><b>4.4.1</b> Objetos aesteticos</a></li>
<li class="chapter" data-level="4.4.2" data-path="analisis-exploratorio-y-visualización.html"><a href="analisis-exploratorio-y-visualización.html#objetos-geométricos-o-capas"><i class="fa fa-check"></i><b>4.4.2</b> Objetos geométricos o capas</a></li>
<li class="chapter" data-level="4.4.3" data-path="analisis-exploratorio-y-visualización.html"><a href="analisis-exploratorio-y-visualización.html#facetas"><i class="fa fa-check"></i><b>4.4.3</b> Facetas</a></li>
<li class="chapter" data-level="4.4.4" data-path="analisis-exploratorio-y-visualización.html"><a href="analisis-exploratorio-y-visualización.html#más-sobre-estéticas"><i class="fa fa-check"></i><b>4.4.4</b> Más sobre estéticas</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="analisis-exploratorio-y-visualización.html"><a href="analisis-exploratorio-y-visualización.html#eda-y-geda-con-r"><i class="fa fa-check"></i><b>4.5</b> EDA y GEDA con R</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="analisis-exploratorio-y-visualización.html"><a href="analisis-exploratorio-y-visualización.html#un-vistazo-rápido-a-los-datos"><i class="fa fa-check"></i><b>4.5.1</b> Un vistazo rápido a los datos</a></li>
<li class="chapter" data-level="4.5.2" data-path="analisis-exploratorio-y-visualización.html"><a href="analisis-exploratorio-y-visualización.html#análisis-univariado"><i class="fa fa-check"></i><b>4.5.2</b> Análisis univariado</a></li>
<li class="chapter" data-level="4.5.3" data-path="analisis-exploratorio-y-visualización.html"><a href="analisis-exploratorio-y-visualización.html#análisis-multivariado"><i class="fa fa-check"></i><b>4.5.3</b> Análisis multivariado</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="analisis-exploratorio-y-visualización.html"><a href="analisis-exploratorio-y-visualización.html#referencias-1"><i class="fa fa-check"></i><b>4.6</b> Referencias:</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="machine-learning-conceptos-básicos.html"><a href="machine-learning-conceptos-básicos.html"><i class="fa fa-check"></i><b>5</b> MACHINE LEARNING: CONCEPTOS BÁSICOS</a>
<ul>
<li class="chapter" data-level="5.1" data-path="machine-learning-conceptos-básicos.html"><a href="machine-learning-conceptos-básicos.html#ml-y-algoritmos"><i class="fa fa-check"></i><b>5.1</b> ML y Algoritmos</a></li>
<li class="chapter" data-level="5.2" data-path="machine-learning-conceptos-básicos.html"><a href="machine-learning-conceptos-básicos.html#análisis-supervisado-vs-no-supervisado"><i class="fa fa-check"></i><b>5.2</b> Análisis Supervisado vs No supervisado</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="machine-learning-conceptos-básicos.html"><a href="machine-learning-conceptos-básicos.html#regresión-vs-clasificación"><i class="fa fa-check"></i><b>5.2.1</b> Regresión vs clasificación</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="machine-learning-conceptos-básicos.html"><a href="machine-learning-conceptos-básicos.html#sesgo-vs-varianza"><i class="fa fa-check"></i><b>5.3</b> Sesgo vs varianza</a></li>
<li class="chapter" data-level="5.4" data-path="machine-learning-conceptos-básicos.html"><a href="machine-learning-conceptos-básicos.html#pre-procesamiento-e-ingeniería-de-datos"><i class="fa fa-check"></i><b>5.4</b> Pre-procesamiento e ingeniería de datos</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="machine-learning-conceptos-básicos.html"><a href="machine-learning-conceptos-básicos.html#pre-procesamiento-de-datos"><i class="fa fa-check"></i><b>5.4.1</b> Pre-procesamiento de datos</a></li>
<li class="chapter" data-level="5.4.2" data-path="machine-learning-conceptos-básicos.html"><a href="machine-learning-conceptos-básicos.html#ingeniería-de-datos"><i class="fa fa-check"></i><b>5.4.2</b> Ingeniería de datos</a></li>
<li class="chapter" data-level="5.4.3" data-path="machine-learning-conceptos-básicos.html"><a href="machine-learning-conceptos-básicos.html#recetas"><i class="fa fa-check"></i><b>5.4.3</b> Recetas</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="machine-learning-conceptos-básicos.html"><a href="machine-learning-conceptos-básicos.html#partición-de-datos"><i class="fa fa-check"></i><b>5.5</b> Partición de datos</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="machine-learning-conceptos-básicos.html"><a href="machine-learning-conceptos-básicos.html#métodos-comunes-para-particionar-datos"><i class="fa fa-check"></i><b>5.5.1</b> Métodos comunes para particionar datos</a></li>
<li class="chapter" data-level="5.5.2" data-path="machine-learning-conceptos-básicos.html"><a href="machine-learning-conceptos-básicos.html#qué-proporción-debería-ser-usada"><i class="fa fa-check"></i><b>5.5.2</b> ¿Qué proporción debería ser usada?</a></li>
<li class="chapter" data-level="5.5.3" data-path="machine-learning-conceptos-básicos.html"><a href="machine-learning-conceptos-básicos.html#conjunto-de-validación"><i class="fa fa-check"></i><b>5.5.3</b> Conjunto de validación</a></li>
<li class="chapter" data-level="5.5.4" data-path="machine-learning-conceptos-básicos.html"><a href="machine-learning-conceptos-básicos.html#leave-one-out-cross-validation"><i class="fa fa-check"></i><b>5.5.4</b> Leave-one-out cross-validation</a></li>
<li class="chapter" data-level="5.5.5" data-path="machine-learning-conceptos-básicos.html"><a href="machine-learning-conceptos-básicos.html#v-fold-cross-validation"><i class="fa fa-check"></i><b>5.5.5</b> V Fold Cross Validation</a></li>
<li class="chapter" data-level="5.5.6" data-path="machine-learning-conceptos-básicos.html"><a href="machine-learning-conceptos-básicos.html#medidas-de-ajuste"><i class="fa fa-check"></i><b>5.5.6</b> Medidas de ajuste</a></li>
<li class="chapter" data-level="5.5.7" data-path="machine-learning-conceptos-básicos.html"><a href="machine-learning-conceptos-básicos.html#validación-cruzada-para-series-de-tiempo"><i class="fa fa-check"></i><b>5.5.7</b> Validación cruzada para series de tiempo</a></li>
<li class="chapter" data-level="5.5.8" data-path="machine-learning-conceptos-básicos.html"><a href="machine-learning-conceptos-básicos.html#otros-tipos-de-validación-cruzada"><i class="fa fa-check"></i><b>5.5.8</b> Otros tipos de validación cruzada</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="machine-learning-aprendizaje-supervisado.html"><a href="machine-learning-aprendizaje-supervisado.html"><i class="fa fa-check"></i><b>6</b> MACHINE LEARNING: APRENDIZAJE SUPERVISADO</a>
<ul>
<li class="chapter" data-level="6.1" data-path="machine-learning-aprendizaje-supervisado.html"><a href="machine-learning-aprendizaje-supervisado.html#regresión-preparación-de-conjunto-de-datos"><i class="fa fa-check"></i><b>6.1</b> <strong>Regresión</strong>: Preparación de conjunto de datos</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="machine-learning-aprendizaje-supervisado.html"><a href="machine-learning-aprendizaje-supervisado.html#datos-de-regresión-ames-housing-data"><i class="fa fa-check"></i><b>6.1.1</b> Datos de regresión: Ames Housing Data</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="machine-learning-aprendizaje-supervisado.html"><a href="machine-learning-aprendizaje-supervisado.html#clasificación-preparación-de-datos"><i class="fa fa-check"></i><b>6.2</b> <strong>Clasificación</strong>: Preparación de Datos</a></li>
<li class="chapter" data-level="6.3" data-path="machine-learning-aprendizaje-supervisado.html"><a href="machine-learning-aprendizaje-supervisado.html#regresión-lineal-simple-y-múltiple"><i class="fa fa-check"></i><b>6.3</b> Regresión lineal simple y múltiple</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="machine-learning-aprendizaje-supervisado.html"><a href="machine-learning-aprendizaje-supervisado.html#ajuste-de-modelo"><i class="fa fa-check"></i><b>6.3.1</b> Ajuste de modelo</a></li>
<li class="chapter" data-level="6.3.2" data-path="machine-learning-aprendizaje-supervisado.html"><a href="machine-learning-aprendizaje-supervisado.html#residuos-del-modelo"><i class="fa fa-check"></i><b>6.3.2</b> Residuos del modelo</a></li>
<li class="chapter" data-level="6.3.3" data-path="machine-learning-aprendizaje-supervisado.html"><a href="machine-learning-aprendizaje-supervisado.html#métricas-de-desempeño"><i class="fa fa-check"></i><b>6.3.3</b> Métricas de desempeño</a></li>
<li class="chapter" data-level="6.3.4" data-path="machine-learning-aprendizaje-supervisado.html"><a href="machine-learning-aprendizaje-supervisado.html#implementación-en-r"><i class="fa fa-check"></i><b>6.3.4</b> Implementación en R</a></li>
<li class="chapter" data-level="6.3.5" data-path="machine-learning-aprendizaje-supervisado.html"><a href="machine-learning-aprendizaje-supervisado.html#coeficientes-del-modelo"><i class="fa fa-check"></i><b>6.3.5</b> Coeficientes del modelo</a></li>
<li class="chapter" data-level="6.3.6" data-path="machine-learning-aprendizaje-supervisado.html"><a href="machine-learning-aprendizaje-supervisado.html#métricas-de-desempeño-1"><i class="fa fa-check"></i><b>6.3.6</b> Métricas de desempeño</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="machine-learning-aprendizaje-supervisado.html"><a href="machine-learning-aprendizaje-supervisado.html#métodos-se-selección-de-variables"><i class="fa fa-check"></i><b>6.4</b> Métodos se selección de variables</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="machine-learning-aprendizaje-supervisado.html"><a href="machine-learning-aprendizaje-supervisado.html#forward-selection-selección-hacia-adelante"><i class="fa fa-check"></i><b>6.4.1</b> Forward selection (selección hacia adelante)</a></li>
<li class="chapter" data-level="6.4.2" data-path="machine-learning-aprendizaje-supervisado.html"><a href="machine-learning-aprendizaje-supervisado.html#desventajas-de-la-selección-forward-backward-y-stepwise"><i class="fa fa-check"></i><b>6.4.2</b> Desventajas de la selección forward, backward y stepwise</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="machine-learning-aprendizaje-supervisado.html"><a href="machine-learning-aprendizaje-supervisado.html#regresión-logística"><i class="fa fa-check"></i><b>6.5</b> Regresión logística</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="machine-learning-aprendizaje-supervisado.html"><a href="machine-learning-aprendizaje-supervisado.html#función-sigmoide"><i class="fa fa-check"></i><b>6.5.1</b> Función sigmoide</a></li>
<li class="chapter" data-level="6.5.2" data-path="machine-learning-aprendizaje-supervisado.html"><a href="machine-learning-aprendizaje-supervisado.html#ajuste-del-modelo"><i class="fa fa-check"></i><b>6.5.2</b> Ajuste del modelo</a></li>
<li class="chapter" data-level="6.5.3" data-path="machine-learning-aprendizaje-supervisado.html"><a href="machine-learning-aprendizaje-supervisado.html#convertir-probabilidad-en-clasificación"><i class="fa fa-check"></i><b>6.5.3</b> Convertir probabilidad en clasificación</a></li>
<li class="chapter" data-level="6.5.4" data-path="machine-learning-aprendizaje-supervisado.html"><a href="machine-learning-aprendizaje-supervisado.html#métricas-de-desempeño-2"><i class="fa fa-check"></i><b>6.5.4</b> Métricas de desempeño</a></li>
<li class="chapter" data-level="6.5.5" data-path="machine-learning-aprendizaje-supervisado.html"><a href="machine-learning-aprendizaje-supervisado.html#implementación-en-r-1"><i class="fa fa-check"></i><b>6.5.5</b> Implementación en R</a></li>
<li class="chapter" data-level="6.5.6" data-path="machine-learning-aprendizaje-supervisado.html"><a href="machine-learning-aprendizaje-supervisado.html#métricas-de-desempeño-3"><i class="fa fa-check"></i><b>6.5.6</b> Métricas de desempeño</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="machine-learning-aprendizaje-supervisado.html"><a href="machine-learning-aprendizaje-supervisado.html#regresión-regularizada-ridge-lasso-elasticnet"><i class="fa fa-check"></i><b>6.6</b> Regresión regularizada: Ridge, Lasso &amp; ElasticNet</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="machine-learning-aprendizaje-supervisado.html"><a href="machine-learning-aprendizaje-supervisado.html#regularización-ridge"><i class="fa fa-check"></i><b>6.6.1</b> Regularización Ridge</a></li>
<li class="chapter" data-level="6.6.2" data-path="machine-learning-aprendizaje-supervisado.html"><a href="machine-learning-aprendizaje-supervisado.html#regularización-lasso"><i class="fa fa-check"></i><b>6.6.2</b> Regularización Lasso</a></li>
<li class="chapter" data-level="6.6.3" data-path="machine-learning-aprendizaje-supervisado.html"><a href="machine-learning-aprendizaje-supervisado.html#elasticnet"><i class="fa fa-check"></i><b>6.6.3</b> ElasticNet</a></li>
<li class="chapter" data-level="6.6.4" data-path="machine-learning-aprendizaje-supervisado.html"><a href="machine-learning-aprendizaje-supervisado.html#elasticnet-para-regresión-lineal"><i class="fa fa-check"></i><b>6.6.4</b> ElasticNet para regresión lineal</a></li>
<li class="chapter" data-level="6.6.5" data-path="machine-learning-aprendizaje-supervisado.html"><a href="machine-learning-aprendizaje-supervisado.html#elasticnet-para-regresión-logística"><i class="fa fa-check"></i><b>6.6.5</b> ElasticNet para regresión logística</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="machine-learning-aprendizaje-supervisado.html"><a href="machine-learning-aprendizaje-supervisado.html#knn-k-nearest-neighbor"><i class="fa fa-check"></i><b>6.7</b> KNN: K-Nearest-Neighbor</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="machine-learning-aprendizaje-supervisado.html"><a href="machine-learning-aprendizaje-supervisado.html#ajuste-del-modelo-1"><i class="fa fa-check"></i><b>6.7.1</b> Ajuste del modelo</a></li>
<li class="chapter" data-level="6.7.2" data-path="machine-learning-aprendizaje-supervisado.html"><a href="machine-learning-aprendizaje-supervisado.html#implementación-en-r-2"><i class="fa fa-check"></i><b>6.7.2</b> Implementación en R</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="machine-learning-aprendizaje-supervisado.html"><a href="machine-learning-aprendizaje-supervisado.html#árboles-de-decisión-decision-trees"><i class="fa fa-check"></i><b>6.8</b> Árboles de decisión (Decision trees)</a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="machine-learning-aprendizaje-supervisado.html"><a href="machine-learning-aprendizaje-supervisado.html#ajuste-del-modelo-2"><i class="fa fa-check"></i><b>6.8.1</b> Ajuste del modelo</a></li>
<li class="chapter" data-level="6.8.2" data-path="machine-learning-aprendizaje-supervisado.html"><a href="machine-learning-aprendizaje-supervisado.html#implementación-en-r-3"><i class="fa fa-check"></i><b>6.8.2</b> Implementación en R</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="machine-learning-aprendizaje-no-supervisado.html"><a href="machine-learning-aprendizaje-no-supervisado.html"><i class="fa fa-check"></i><b>7</b> MACHINE LEARNING: APRENDIZAJE NO SUPERVISADO</a>
<ul>
<li class="chapter" data-level="7.1" data-path="machine-learning-aprendizaje-no-supervisado.html"><a href="machine-learning-aprendizaje-no-supervisado.html#cluster-k--means"><i class="fa fa-check"></i><b>7.1</b> Cluster: K- means</a></li>
<li class="chapter" data-level="7.2" data-path="machine-learning-aprendizaje-no-supervisado.html"><a href="machine-learning-aprendizaje-no-supervisado.html#cluster-pam"><i class="fa fa-check"></i><b>7.2</b> Cluster: PAM</a></li>
<li class="chapter" data-level="7.3" data-path="machine-learning-aprendizaje-no-supervisado.html"><a href="machine-learning-aprendizaje-no-supervisado.html#dbscan"><i class="fa fa-check"></i><b>7.3</b> DBSCAN</a></li>
<li class="chapter" data-level="7.4" data-path="machine-learning-aprendizaje-no-supervisado.html"><a href="machine-learning-aprendizaje-no-supervisado.html#cluster-jerárquico"><i class="fa fa-check"></i><b>7.4</b> Cluster: Jerárquico</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="./"><img src="img/amat-logo.png" width="280"></a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">AMAT- Introducción a Ciencia de Datos y Machine Learning</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="machine-learning-aprendizaje-supervisado" class="section level1" number="6">
<h1><span class="header-section-number">Capítulo 6</span> MACHINE LEARNING: APRENDIZAJE SUPERVISADO</h1>
<div class="watermark">
<img src="img/header.png" width="400">
</div>
<div id="regresión-preparación-de-conjunto-de-datos" class="section level2" number="6.1">
<h2><span class="header-section-number">6.1</span> <strong>Regresión</strong>: Preparación de conjunto de datos</h2>
<p>En esta sección, prepararemos datos para ajustar modelos de regresión y de clasificación, usando la paquetería <em>recipes</em>. Primero ajustaremos la receta, después obtendremos la receta actualizada con las estimaciones y al final el conjunto de datos listo para el modelo.</p>
<div id="datos-de-regresión-ames-housing-data" class="section level3" number="6.1.1">
<h3><span class="header-section-number">6.1.1</span> Datos de regresión: Ames Housing Data</h3>
<p>Los datos que usaremos son los de <em>Ames Housing Data</em>, el conjunto de datos contiene información de la <em>Ames Assessor’s Office</em> utilizada para calcular valuaciones para propiedades residenciales individuales vendidas en Ames, IA, de 2006 a 2010.</p>
<p>Podemos encontrar más información en el siguiente link <a href="http://jse.amstat.org/v19n3/decock/DataDocumentation.txt"><em>Ames Housing Data</em></a>.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="machine-learning-aprendizaje-supervisado.html#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidymodels)</span>
<span id="cb127-2"><a href="machine-learning-aprendizaje-supervisado.html#cb127-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb127-3"><a href="machine-learning-aprendizaje-supervisado.html#cb127-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb127-4"><a href="machine-learning-aprendizaje-supervisado.html#cb127-4" aria-hidden="true" tabindex="-1"></a><span class="co">#library(modeldata) Esta paquetería también la carga el paquete tidymodels</span></span>
<span id="cb127-5"><a href="machine-learning-aprendizaje-supervisado.html#cb127-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-6"><a href="machine-learning-aprendizaje-supervisado.html#cb127-6" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(ames)</span>
<span id="cb127-7"><a href="machine-learning-aprendizaje-supervisado.html#cb127-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-8"><a href="machine-learning-aprendizaje-supervisado.html#cb127-8" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(ames)</span></code></pre></div>
<pre><code>##  [1] &quot;MS_SubClass&quot;        &quot;MS_Zoning&quot;          &quot;Lot_Frontage&quot;      
##  [4] &quot;Lot_Area&quot;           &quot;Street&quot;             &quot;Alley&quot;             
##  [7] &quot;Lot_Shape&quot;          &quot;Land_Contour&quot;       &quot;Utilities&quot;         
## [10] &quot;Lot_Config&quot;         &quot;Land_Slope&quot;         &quot;Neighborhood&quot;      
## [13] &quot;Condition_1&quot;        &quot;Condition_2&quot;        &quot;Bldg_Type&quot;         
## [16] &quot;House_Style&quot;        &quot;Overall_Cond&quot;       &quot;Year_Built&quot;        
## [19] &quot;Year_Remod_Add&quot;     &quot;Roof_Style&quot;         &quot;Roof_Matl&quot;         
## [22] &quot;Exterior_1st&quot;       &quot;Exterior_2nd&quot;       &quot;Mas_Vnr_Type&quot;      
## [25] &quot;Mas_Vnr_Area&quot;       &quot;Exter_Cond&quot;         &quot;Foundation&quot;        
## [28] &quot;Bsmt_Cond&quot;          &quot;Bsmt_Exposure&quot;      &quot;BsmtFin_Type_1&quot;    
## [31] &quot;BsmtFin_SF_1&quot;       &quot;BsmtFin_Type_2&quot;     &quot;BsmtFin_SF_2&quot;      
## [34] &quot;Bsmt_Unf_SF&quot;        &quot;Total_Bsmt_SF&quot;      &quot;Heating&quot;           
## [37] &quot;Heating_QC&quot;         &quot;Central_Air&quot;        &quot;Electrical&quot;        
## [40] &quot;First_Flr_SF&quot;       &quot;Second_Flr_SF&quot;      &quot;Gr_Liv_Area&quot;       
## [43] &quot;Bsmt_Full_Bath&quot;     &quot;Bsmt_Half_Bath&quot;     &quot;Full_Bath&quot;         
## [46] &quot;Half_Bath&quot;          &quot;Bedroom_AbvGr&quot;      &quot;Kitchen_AbvGr&quot;     
## [49] &quot;TotRms_AbvGrd&quot;      &quot;Functional&quot;         &quot;Fireplaces&quot;        
## [52] &quot;Garage_Type&quot;        &quot;Garage_Finish&quot;      &quot;Garage_Cars&quot;       
## [55] &quot;Garage_Area&quot;        &quot;Garage_Cond&quot;        &quot;Paved_Drive&quot;       
## [58] &quot;Wood_Deck_SF&quot;       &quot;Open_Porch_SF&quot;      &quot;Enclosed_Porch&quot;    
## [61] &quot;Three_season_porch&quot; &quot;Screen_Porch&quot;       &quot;Pool_Area&quot;         
## [64] &quot;Pool_QC&quot;            &quot;Fence&quot;              &quot;Misc_Feature&quot;      
## [67] &quot;Misc_Val&quot;           &quot;Mo_Sold&quot;            &quot;Year_Sold&quot;         
## [70] &quot;Sale_Type&quot;          &quot;Sale_Condition&quot;     &quot;Sale_Price&quot;        
## [73] &quot;Longitude&quot;          &quot;Latitude&quot;</code></pre>
<div id="separación-de-los-datos" class="section level4" number="6.1.1.1">
<h4><span class="header-section-number">6.1.1.1</span> Separación de los datos</h4>
<p>El primer paso para crear un modelo de regresión es dividir nuestros datos originales en un conjunto de entrenamiento y prueba.</p>
<p>No hay que olvidar usar siempre una semilla con la función <em>set.seed()</em> para que sus resultados sean reproducibles.</p>
<p>Primero usaremos la función <em>initial_split()</em> de <em>rsample</em> para dividir los datos <em>ames</em> en conjuntos de entrenamiento y prueba. Usamos el parámetro <em>prop</em> para indicar la proporción de los conjuntos <em>train</em> y <em>test</em>.</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="machine-learning-aprendizaje-supervisado.html#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4595</span>)</span>
<span id="cb129-2"><a href="machine-learning-aprendizaje-supervisado.html#cb129-2" aria-hidden="true" tabindex="-1"></a>ames_split <span class="ot">&lt;-</span> <span class="fu">initial_split</span>(ames, <span class="at">prop =</span> <span class="fl">0.70</span>)</span></code></pre></div>
<p>El objeto <em>ames_split</em> es un objeto <em>rsplit</em> y solo contiene la información de partición, para obtener los conjuntos de datos resultantes, aplicamos dos funciones adicionales, <em>training</em> y <em>testing</em>.</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="machine-learning-aprendizaje-supervisado.html#cb130-1" aria-hidden="true" tabindex="-1"></a>ames_train <span class="ot">&lt;-</span> <span class="fu">training</span>(ames_split)</span>
<span id="cb130-2"><a href="machine-learning-aprendizaje-supervisado.html#cb130-2" aria-hidden="true" tabindex="-1"></a>ames_test  <span class="ot">&lt;-</span> <span class="fu">testing</span>(ames_split)</span></code></pre></div>
<p>Estos objetos son <em>data frames</em> con las mismas columnas que los datos originales, pero solo las filas apropiadas para cada conjunto.</p>
<p>También existe la función <em>vfold_cv</em> que se usa para crear <strong>v</strong> particiones del conjunto de entrenamiento.</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="machine-learning-aprendizaje-supervisado.html#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2453</span>)</span>
<span id="cb131-2"><a href="machine-learning-aprendizaje-supervisado.html#cb131-2" aria-hidden="true" tabindex="-1"></a>ames_folds<span class="ot">&lt;-</span> <span class="fu">vfold_cv</span>(ames_train)</span></code></pre></div>
<p>Ya con los conjuntos de entrenamiento y prueba definidos, iniciaremos con <em>feature engeeniring</em> sobre el conjunto de entrenamiento.</p>
</div>
<div id="definición-de-la-receta" class="section level4" number="6.1.1.2">
<h4><span class="header-section-number">6.1.1.2</span> Definición de la receta</h4>
<p>Ahora usaremos la función vista en la sección anterior, <em>recipe()</em>, para definir los pasos de preprocesamiento antes de usar los datos para modelado.</p>
<ul>
<li><p>Usamos la función <em>step_mutate()</em> para generar nuevas variables dentro de la receta.</p></li>
<li><p>La función <em>step_interact()</em> nos ayuda a crear nuevas variables que son interacciones entre las variables especificadas.</p></li>
<li><p>Con la función <em>step_ratio()</em> creamos proporciones con las variables especificadas.</p></li>
<li><p><em>forcats::fct_collapse()</em> se usa para recategorizar variables, colapsando categorías de la variable.</p></li>
<li><p><em>step_relevel</em> nos ayuda a asignar la categoria deseada de una variable como referencia.</p></li>
<li><p><em>step_normalize()</em> es de gran utilidad ya que sirve para normalizar las variables que se le indiquen.</p></li>
<li><p><em>step_dummy()</em> Nos ayuda a crear variables <em>One Hot Encoding</em>.</p></li>
<li><p>Por último usamos la función <em>step_rm()</em> para eliminar variables que no son de utilidad para el modelo.</p></li>
</ul>
<p>Ahora crearemos algunas variables auxiliares que podrían ser de utilidad para el ajuste de un modelo de regresión, entre ella: <em>Log_SalePrice</em>, la cual será la variable a predecir. Una vez que el modelo haga la predicción del logaritmo del precio, es importante calcular con la función exponencial el precio real.</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="machine-learning-aprendizaje-supervisado.html#cb132-1" aria-hidden="true" tabindex="-1"></a>ames_train <span class="ot">&lt;-</span> ames_train <span class="sc">%&gt;%</span> </span>
<span id="cb132-2"><a href="machine-learning-aprendizaje-supervisado.html#cb132-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb132-3"><a href="machine-learning-aprendizaje-supervisado.html#cb132-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">Log_SalePrice =</span> <span class="fu">log</span>(Sale_Price)</span>
<span id="cb132-4"><a href="machine-learning-aprendizaje-supervisado.html#cb132-4" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb132-5"><a href="machine-learning-aprendizaje-supervisado.html#cb132-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Sale_Price)</span>
<span id="cb132-6"><a href="machine-learning-aprendizaje-supervisado.html#cb132-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-7"><a href="machine-learning-aprendizaje-supervisado.html#cb132-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-8"><a href="machine-learning-aprendizaje-supervisado.html#cb132-8" aria-hidden="true" tabindex="-1"></a>ames_test <span class="ot">&lt;-</span> ames_test <span class="sc">%&gt;%</span> </span>
<span id="cb132-9"><a href="machine-learning-aprendizaje-supervisado.html#cb132-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb132-10"><a href="machine-learning-aprendizaje-supervisado.html#cb132-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Log_SalePrice =</span> <span class="fu">log</span>(Sale_Price)</span>
<span id="cb132-11"><a href="machine-learning-aprendizaje-supervisado.html#cb132-11" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb132-12"><a href="machine-learning-aprendizaje-supervisado.html#cb132-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Sale_Price)</span></code></pre></div>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="machine-learning-aprendizaje-supervisado.html#cb133-1" aria-hidden="true" tabindex="-1"></a>receta_casas <span class="ot">&lt;-</span> <span class="fu">recipe</span>(Log_SalePrice <span class="sc">~</span> . , <span class="at">data =</span> ames_train) <span class="sc">%&gt;%</span></span>
<span id="cb133-2"><a href="machine-learning-aprendizaje-supervisado.html#cb133-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_unknown</span>(Alley) <span class="sc">%&gt;%</span></span>
<span id="cb133-3"><a href="machine-learning-aprendizaje-supervisado.html#cb133-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_unknown</span>(Fence) <span class="sc">%&gt;%</span></span>
<span id="cb133-4"><a href="machine-learning-aprendizaje-supervisado.html#cb133-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_unknown</span>(Garage_Type) <span class="sc">%&gt;%</span></span>
<span id="cb133-5"><a href="machine-learning-aprendizaje-supervisado.html#cb133-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_unknown</span>(Garage_Finish) <span class="sc">%&gt;%</span></span>
<span id="cb133-6"><a href="machine-learning-aprendizaje-supervisado.html#cb133-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_unknown</span>(Garage_Cond) <span class="sc">%&gt;%</span></span>
<span id="cb133-7"><a href="machine-learning-aprendizaje-supervisado.html#cb133-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_unknown</span>(Bsmt_Cond) <span class="sc">%&gt;%</span></span>
<span id="cb133-8"><a href="machine-learning-aprendizaje-supervisado.html#cb133-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_unknown</span>(Bsmt_Exposure) <span class="sc">%&gt;%</span></span>
<span id="cb133-9"><a href="machine-learning-aprendizaje-supervisado.html#cb133-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_unknown</span>(BsmtFin_Type_1) <span class="sc">%&gt;%</span></span>
<span id="cb133-10"><a href="machine-learning-aprendizaje-supervisado.html#cb133-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_unknown</span>(BsmtFin_Type_2) <span class="sc">%&gt;%</span></span>
<span id="cb133-11"><a href="machine-learning-aprendizaje-supervisado.html#cb133-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_unknown</span>(Mas_Vnr_Type) <span class="sc">%&gt;%</span></span>
<span id="cb133-12"><a href="machine-learning-aprendizaje-supervisado.html#cb133-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_unknown</span>(Electrical) <span class="sc">%&gt;%</span></span>
<span id="cb133-13"><a href="machine-learning-aprendizaje-supervisado.html#cb133-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_unknown</span>(Heating_QC) <span class="sc">%&gt;%</span></span>
<span id="cb133-14"><a href="machine-learning-aprendizaje-supervisado.html#cb133-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_unknown</span>(Pool_QC) <span class="sc">%&gt;%</span> </span>
<span id="cb133-15"><a href="machine-learning-aprendizaje-supervisado.html#cb133-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_rename</span>(<span class="at">Year_Remod =</span> Year_Remod_Add) <span class="sc">%&gt;%</span> </span>
<span id="cb133-16"><a href="machine-learning-aprendizaje-supervisado.html#cb133-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_rename</span>(<span class="at">ThirdSsn_Porch =</span> Three_season_porch) <span class="sc">%&gt;%</span> </span>
<span id="cb133-17"><a href="machine-learning-aprendizaje-supervisado.html#cb133-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_mutate</span>(<span class="at">TotalBaths =</span> Full_Bath <span class="sc">+</span> Bsmt_Full_Bath <span class="sc">+</span> <span class="fl">0.5</span> <span class="sc">*</span> (Half_Bath <span class="sc">+</span> Bsmt_Half_Bath),</span>
<span id="cb133-18"><a href="machine-learning-aprendizaje-supervisado.html#cb133-18" aria-hidden="true" tabindex="-1"></a>              <span class="at">Age_House =</span> Year_Sold <span class="sc">-</span> Year_Remod,</span>
<span id="cb133-19"><a href="machine-learning-aprendizaje-supervisado.html#cb133-19" aria-hidden="true" tabindex="-1"></a>              <span class="at">TotalSF   =</span> Gr_Liv_Area <span class="sc">+</span> Total_Bsmt_SF,</span>
<span id="cb133-20"><a href="machine-learning-aprendizaje-supervisado.html#cb133-20" aria-hidden="true" tabindex="-1"></a>              <span class="at">AvgRoomSF   =</span> Gr_Liv_Area <span class="sc">/</span> TotRms_AbvGrd,</span>
<span id="cb133-21"><a href="machine-learning-aprendizaje-supervisado.html#cb133-21" aria-hidden="true" tabindex="-1"></a>              <span class="at">Porch_SF     =</span> Enclosed_Porch <span class="sc">+</span> ThirdSsn_Porch <span class="sc">+</span> Open_Porch_SF,</span>
<span id="cb133-22"><a href="machine-learning-aprendizaje-supervisado.html#cb133-22" aria-hidden="true" tabindex="-1"></a>              <span class="at">Porch       =</span> <span class="fu">factor</span>(Porch_SF <span class="sc">&gt;</span> <span class="dv">0</span>),</span>
<span id="cb133-23"><a href="machine-learning-aprendizaje-supervisado.html#cb133-23" aria-hidden="true" tabindex="-1"></a>              <span class="at">Pool =</span> <span class="fu">if_else</span>(Pool_Area <span class="sc">&gt;</span> <span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb133-24"><a href="machine-learning-aprendizaje-supervisado.html#cb133-24" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb133-25"><a href="machine-learning-aprendizaje-supervisado.html#cb133-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_ratio</span>(Bedroom_AbvGr, <span class="at">denom =</span> <span class="fu">denom_vars</span>(Gr_Liv_Area)) <span class="sc">%&gt;%</span> </span>
<span id="cb133-26"><a href="machine-learning-aprendizaje-supervisado.html#cb133-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_ratio</span>(Second_Flr_SF, <span class="at">denom =</span> <span class="fu">denom_vars</span>(First_Flr_SF)) <span class="sc">%&gt;%</span> </span>
<span id="cb133-27"><a href="machine-learning-aprendizaje-supervisado.html#cb133-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_mutate</span>(<span class="at">Exter_Cond =</span> forcats<span class="sc">::</span><span class="fu">fct_collapse</span>(Exter_Cond, <span class="at">Good =</span> <span class="fu">c</span>(<span class="st">&quot;Typical&quot;</span>, <span class="st">&quot;Good&quot;</span>, <span class="st">&quot;Excellent&quot;</span>)),</span>
<span id="cb133-28"><a href="machine-learning-aprendizaje-supervisado.html#cb133-28" aria-hidden="true" tabindex="-1"></a>              <span class="at">Condition_1 =</span> forcats<span class="sc">::</span><span class="fu">fct_collapse</span>(Condition_1, </span>
<span id="cb133-29"><a href="machine-learning-aprendizaje-supervisado.html#cb133-29" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">Artery_Feedr =</span> <span class="fu">c</span>(<span class="st">&quot;Feedr&quot;</span>, <span class="st">&quot;Artery&quot;</span>), </span>
<span id="cb133-30"><a href="machine-learning-aprendizaje-supervisado.html#cb133-30" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">Railr =</span> <span class="fu">c</span>(<span class="st">&quot;RRAn&quot;</span>, <span class="st">&quot;RRNn&quot;</span>, <span class="st">&quot;RRNe&quot;</span>, <span class="st">&quot;RRAe&quot;</span>),</span>
<span id="cb133-31"><a href="machine-learning-aprendizaje-supervisado.html#cb133-31" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">Norm =</span> <span class="st">&quot;Norm&quot;</span>,</span>
<span id="cb133-32"><a href="machine-learning-aprendizaje-supervisado.html#cb133-32" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">Pos =</span> <span class="fu">c</span>(<span class="st">&quot;PosN&quot;</span>, <span class="st">&quot;PosA&quot;</span>)), </span>
<span id="cb133-33"><a href="machine-learning-aprendizaje-supervisado.html#cb133-33" aria-hidden="true" tabindex="-1"></a>              <span class="at">Land_Slope =</span> forcats<span class="sc">::</span><span class="fu">fct_collapse</span>(Land_Slope, <span class="at">Mod_Sev =</span> <span class="fu">c</span>(<span class="st">&quot;Mod&quot;</span>, <span class="st">&quot;Sev&quot;</span>)),</span>
<span id="cb133-34"><a href="machine-learning-aprendizaje-supervisado.html#cb133-34" aria-hidden="true" tabindex="-1"></a>              <span class="at">Land_Contour =</span> forcats<span class="sc">::</span><span class="fu">fct_collapse</span>(Land_Contour, <span class="at">Low_HLS =</span> <span class="fu">c</span>(<span class="st">&quot;Low&quot;</span>,<span class="st">&quot;HLS&quot;</span>),</span>
<span id="cb133-35"><a href="machine-learning-aprendizaje-supervisado.html#cb133-35" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">Bnk_Lvl =</span> <span class="fu">c</span>(<span class="st">&quot;Lvl&quot;</span>,<span class="st">&quot;Bnk&quot;</span>)),</span>
<span id="cb133-36"><a href="machine-learning-aprendizaje-supervisado.html#cb133-36" aria-hidden="true" tabindex="-1"></a>              <span class="at">Lot_Shape =</span> forcats<span class="sc">::</span><span class="fu">fct_collapse</span>(Lot_Shape, <span class="at">IRREG =</span> <span class="fu">c</span>(<span class="st">&quot;Slightly_Irregular&quot;</span>, <span class="st">&quot;Moderately_Irregular&quot;</span>, <span class="st">&quot;Irregular&quot;</span>)),</span>
<span id="cb133-37"><a href="machine-learning-aprendizaje-supervisado.html#cb133-37" aria-hidden="true" tabindex="-1"></a>              <span class="at">Bsmt_Cond =</span> forcats<span class="sc">::</span><span class="fu">fct_collapse</span>(Bsmt_Cond, <span class="at">Exc =</span> <span class="fu">c</span>(<span class="st">&quot;Good&quot;</span>, <span class="st">&quot;Excellent&quot;</span>)),</span>
<span id="cb133-38"><a href="machine-learning-aprendizaje-supervisado.html#cb133-38" aria-hidden="true" tabindex="-1"></a>              <span class="at">BsmtFin_Type_1 =</span> forcats<span class="sc">::</span><span class="fu">fct_collapse</span>(BsmtFin_Type_1, <span class="at">Rec_BLQ =</span> <span class="fu">c</span>(<span class="st">&quot;Rec&quot;</span>, <span class="st">&quot;BLQ&quot;</span>)),</span>
<span id="cb133-39"><a href="machine-learning-aprendizaje-supervisado.html#cb133-39" aria-hidden="true" tabindex="-1"></a>              <span class="at">BsmtFin_Type_2 =</span> forcats<span class="sc">::</span><span class="fu">fct_collapse</span>(BsmtFin_Type_2, <span class="at">Rec_BLQ =</span> <span class="fu">c</span>(<span class="st">&quot;Rec&quot;</span>, <span class="st">&quot;BLQ&quot;</span>,<span class="st">&quot;LwQ&quot;</span>)),</span>
<span id="cb133-40"><a href="machine-learning-aprendizaje-supervisado.html#cb133-40" aria-hidden="true" tabindex="-1"></a>              <span class="at">Neighborhood =</span> forcats<span class="sc">::</span><span class="fu">fct_collapse</span>(Neighborhood, </span>
<span id="cb133-41"><a href="machine-learning-aprendizaje-supervisado.html#cb133-41" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">NoRidge_GrnHill =</span> <span class="fu">c</span>(<span class="st">&quot;Northridge&quot;</span>, <span class="st">&quot;Green_Hills&quot;</span>),</span>
<span id="cb133-42"><a href="machine-learning-aprendizaje-supervisado.html#cb133-42" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">Crawfor_Greens =</span> <span class="fu">c</span>(<span class="st">&quot;Crawford&quot;</span>, <span class="st">&quot;Greens&quot;</span>),</span>
<span id="cb133-43"><a href="machine-learning-aprendizaje-supervisado.html#cb133-43" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">Blueste_Mitchel =</span> <span class="fu">c</span>(<span class="st">&quot;Blueste&quot;</span>, <span class="st">&quot;Mitchell&quot;</span>),</span>
<span id="cb133-44"><a href="machine-learning-aprendizaje-supervisado.html#cb133-44" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">Blmngtn_CollgCr =</span> <span class="fu">c</span>(<span class="st">&quot;Bloomington_Heights&quot;</span>, <span class="st">&quot;College_Creek&quot;</span>),</span>
<span id="cb133-45"><a href="machine-learning-aprendizaje-supervisado.html#cb133-45" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">NPkVill_NAmes =</span> <span class="fu">c</span>(<span class="st">&quot;Northpark_Villa&quot;</span>, <span class="st">&quot;North_Ames&quot;</span>),</span>
<span id="cb133-46"><a href="machine-learning-aprendizaje-supervisado.html#cb133-46" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">Veenker_StoneBr =</span> <span class="fu">c</span>(<span class="st">&quot;Veenker&quot;</span>, <span class="st">&quot;Stone_Brook&quot;</span>),</span>
<span id="cb133-47"><a href="machine-learning-aprendizaje-supervisado.html#cb133-47" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">BrDale_IDOTRR =</span> <span class="fu">c</span>(<span class="st">&quot;Briardale&quot;</span>, <span class="st">&quot;Iowa_DOT_and_Rail_Road&quot;</span>),</span>
<span id="cb133-48"><a href="machine-learning-aprendizaje-supervisado.html#cb133-48" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">SWISU_Sawyer =</span> <span class="fu">c</span>(<span class="st">&quot;South_and_West_of_Iowa_State_University&quot;</span>, <span class="st">&quot;Sawyer&quot;</span>),</span>
<span id="cb133-49"><a href="machine-learning-aprendizaje-supervisado.html#cb133-49" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">ClearCr_Somerst =</span> <span class="fu">c</span>(<span class="st">&quot;Clear_Creek&quot;</span>, <span class="st">&quot;Somerset&quot;</span>)),</span>
<span id="cb133-50"><a href="machine-learning-aprendizaje-supervisado.html#cb133-50" aria-hidden="true" tabindex="-1"></a>              <span class="at">Heating =</span> forcats<span class="sc">::</span><span class="fu">fct_collapse</span>(Heating, <span class="at">Grav_Wall =</span> <span class="fu">c</span>(<span class="st">&quot;Grav&quot;</span>, <span class="st">&quot;Wall&quot;</span>),</span>
<span id="cb133-51"><a href="machine-learning-aprendizaje-supervisado.html#cb133-51" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">GasA_W =</span> <span class="fu">c</span>(<span class="st">&quot;GasA&quot;</span>, <span class="st">&quot;GasW&quot;</span>, <span class="st">&quot;OthW&quot;</span>)),</span>
<span id="cb133-52"><a href="machine-learning-aprendizaje-supervisado.html#cb133-52" aria-hidden="true" tabindex="-1"></a>              <span class="at">MS_Zoning =</span> forcats<span class="sc">::</span><span class="fu">fct_collapse</span>(MS_Zoning, <span class="at">I_R_M_H =</span> <span class="fu">c</span>(<span class="st">&quot;Residential_Medium_Density&quot;</span>, <span class="st">&quot;I_all&quot;</span>, <span class="st">&quot;Residential_High_Density&quot;</span> )),</span>
<span id="cb133-53"><a href="machine-learning-aprendizaje-supervisado.html#cb133-53" aria-hidden="true" tabindex="-1"></a>              <span class="at">Bldg_Type =</span> forcats<span class="sc">::</span><span class="fu">fct_collapse</span>(Bldg_Type, <span class="at">Du_Tu =</span> <span class="fu">c</span>(<span class="st">&quot;Duplex&quot;</span>, <span class="st">&quot;Twnhs&quot;</span>)),</span>
<span id="cb133-54"><a href="machine-learning-aprendizaje-supervisado.html#cb133-54" aria-hidden="true" tabindex="-1"></a>              <span class="at">Foundation =</span> forcats<span class="sc">::</span><span class="fu">fct_collapse</span>(Foundation, <span class="at">Wood_Stone =</span> <span class="fu">c</span>(<span class="st">&quot;Wood&quot;</span>, <span class="st">&quot;Stone&quot;</span>)),</span>
<span id="cb133-55"><a href="machine-learning-aprendizaje-supervisado.html#cb133-55" aria-hidden="true" tabindex="-1"></a>              <span class="at">Functional =</span> forcats<span class="sc">::</span><span class="fu">fct_collapse</span>(Functional, <span class="at">Min =</span> <span class="fu">c</span>(<span class="st">&quot;Min1&quot;</span>, <span class="st">&quot;Min2&quot;</span>),  </span>
<span id="cb133-56"><a href="machine-learning-aprendizaje-supervisado.html#cb133-56" aria-hidden="true" tabindex="-1"></a>                                                    <span class="at">Maj =</span> <span class="fu">c</span>(<span class="st">&quot;Maj1&quot;</span>, <span class="st">&quot;Maj2&quot;</span>, <span class="st">&quot;Mod&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb133-57"><a href="machine-learning-aprendizaje-supervisado.html#cb133-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_relevel</span>(Exter_Cond, <span class="at">ref_level =</span> <span class="st">&quot;Good&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb133-58"><a href="machine-learning-aprendizaje-supervisado.html#cb133-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_relevel</span>(Condition_1, <span class="at">ref_level =</span> <span class="st">&quot;Norm&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb133-59"><a href="machine-learning-aprendizaje-supervisado.html#cb133-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_normalize</span>(<span class="fu">all_predictors</span>(), <span class="sc">-</span><span class="fu">all_nominal</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb133-60"><a href="machine-learning-aprendizaje-supervisado.html#cb133-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_dummy</span>(<span class="fu">all_nominal</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb133-61"><a href="machine-learning-aprendizaje-supervisado.html#cb133-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_interact</span>(<span class="sc">~</span> Second_Flr_SF<span class="sc">:</span>Bedroom_AbvGr) <span class="sc">%&gt;%</span></span>
<span id="cb133-62"><a href="machine-learning-aprendizaje-supervisado.html#cb133-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_interact</span>(<span class="sc">~</span> TotalSF<span class="sc">:</span>TotRms_AbvGrd) <span class="sc">%&gt;%</span></span>
<span id="cb133-63"><a href="machine-learning-aprendizaje-supervisado.html#cb133-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_interact</span>(<span class="sc">~</span> Age_House<span class="sc">:</span>TotRms_AbvGrd) <span class="sc">%&gt;%</span></span>
<span id="cb133-64"><a href="machine-learning-aprendizaje-supervisado.html#cb133-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_interact</span>(<span class="sc">~</span> Second_Flr_SF<span class="sc">:</span>First_Flr_SF) <span class="sc">%&gt;%</span> </span>
<span id="cb133-65"><a href="machine-learning-aprendizaje-supervisado.html#cb133-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_interact</span>(<span class="sc">~</span> <span class="fu">matches</span>(<span class="st">&quot;Bsmt_Cond&quot;</span>)<span class="sc">:</span>TotRms_AbvGrd) <span class="sc">%&gt;%</span> </span>
<span id="cb133-66"><a href="machine-learning-aprendizaje-supervisado.html#cb133-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_interact</span>(<span class="sc">~</span> <span class="fu">matches</span>(<span class="st">&quot;BsmtFin_Type_1&quot;</span>)<span class="sc">:</span>BsmtFin_SF_1) <span class="sc">%&gt;%</span> </span>
<span id="cb133-67"><a href="machine-learning-aprendizaje-supervisado.html#cb133-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_interact</span>(<span class="sc">~</span> <span class="fu">matches</span>(<span class="st">&quot;BsmtFin_Type_1&quot;</span>)<span class="sc">:</span>Total_Bsmt_SF) <span class="sc">%&gt;%</span> </span>
<span id="cb133-68"><a href="machine-learning-aprendizaje-supervisado.html#cb133-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_interact</span>(<span class="sc">~</span> <span class="fu">matches</span>(<span class="st">&quot;Heating_QC&quot;</span>)<span class="sc">:</span>TotRms_AbvGrd) <span class="sc">%&gt;%</span> </span>
<span id="cb133-69"><a href="machine-learning-aprendizaje-supervisado.html#cb133-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_interact</span>(<span class="sc">~</span> <span class="fu">matches</span>(<span class="st">&quot;Heating_QC&quot;</span>)<span class="sc">:</span>TotalSF) <span class="sc">%&gt;%</span></span>
<span id="cb133-70"><a href="machine-learning-aprendizaje-supervisado.html#cb133-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_interact</span>(<span class="sc">~</span> <span class="fu">matches</span>(<span class="st">&quot;Heating_QC&quot;</span>)<span class="sc">:</span>Second_Flr_SF) <span class="sc">%&gt;%</span></span>
<span id="cb133-71"><a href="machine-learning-aprendizaje-supervisado.html#cb133-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_interact</span>(<span class="sc">~</span> <span class="fu">matches</span>(<span class="st">&quot;Neighborhood&quot;</span>)<span class="sc">:</span><span class="fu">matches</span>(<span class="st">&quot;Condition_1&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb133-72"><a href="machine-learning-aprendizaje-supervisado.html#cb133-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_rm</span>(First_Flr_SF, Second_Flr_SF, Year_Remod,</span>
<span id="cb133-73"><a href="machine-learning-aprendizaje-supervisado.html#cb133-73" aria-hidden="true" tabindex="-1"></a>          Bsmt_Full_Bath, Bsmt_Half_Bath, </span>
<span id="cb133-74"><a href="machine-learning-aprendizaje-supervisado.html#cb133-74" aria-hidden="true" tabindex="-1"></a>          Kitchen_AbvGr, BsmtFin_Type_1_Unf, </span>
<span id="cb133-75"><a href="machine-learning-aprendizaje-supervisado.html#cb133-75" aria-hidden="true" tabindex="-1"></a>          Total_Bsmt_SF, Kitchen_AbvGr, Pool_Area, </span>
<span id="cb133-76"><a href="machine-learning-aprendizaje-supervisado.html#cb133-76" aria-hidden="true" tabindex="-1"></a>          Gr_Liv_Area,</span>
<span id="cb133-77"><a href="machine-learning-aprendizaje-supervisado.html#cb133-77" aria-hidden="true" tabindex="-1"></a>          Porch_SF,</span>
<span id="cb133-78"><a href="machine-learning-aprendizaje-supervisado.html#cb133-78" aria-hidden="true" tabindex="-1"></a>          Sale_Type_Oth, Sale_Type_VWD</span>
<span id="cb133-79"><a href="machine-learning-aprendizaje-supervisado.html#cb133-79" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb133-80"><a href="machine-learning-aprendizaje-supervisado.html#cb133-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prep</span>()</span></code></pre></div>
<p>Recordemos que la función <strong>recipe()</strong> solo son los pasos a seguir, necesitamos usar la función <strong>prep()</strong> que nos devuelve una receta actualizada con las estimaciones y la función <strong>juice()</strong> que nos devuelve la matriz de diseño.</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="machine-learning-aprendizaje-supervisado.html#cb134-1" aria-hidden="true" tabindex="-1"></a>casa_juiced <span class="ot">&lt;-</span> <span class="fu">juice</span>(receta_casas)</span>
<span id="cb134-2"><a href="machine-learning-aprendizaje-supervisado.html#cb134-2" aria-hidden="true" tabindex="-1"></a>casa_test_bake <span class="ot">&lt;-</span> <span class="fu">bake</span>(receta_casas, <span class="at">new_data =</span> ames_test)</span></code></pre></div>
</div>
</div>
</div>
<div id="clasificación-preparación-de-datos" class="section level2" number="6.2">
<h2><span class="header-section-number">6.2</span> <strong>Clasificación</strong>: Preparación de Datos</h2>
<p>Ahora prepararemos los datos para un ejemplo de churn, es decir, la tasa de cancelación de clientes. Usaremos datos de <a href="https://www.kaggle.com/blastchar/telco-customer-churn">Telco</a>.</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="machine-learning-aprendizaje-supervisado.html#cb135-1" aria-hidden="true" tabindex="-1"></a>telco <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/Churn.csv&quot;</span>)</span>
<span id="cb135-2"><a href="machine-learning-aprendizaje-supervisado.html#cb135-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(telco)</span></code></pre></div>
<pre><code>##  [1] &quot;customerID&quot;       &quot;gender&quot;           &quot;SeniorCitizen&quot;    &quot;Partner&quot;         
##  [5] &quot;Dependents&quot;       &quot;tenure&quot;           &quot;PhoneService&quot;     &quot;MultipleLines&quot;   
##  [9] &quot;InternetService&quot;  &quot;OnlineSecurity&quot;   &quot;OnlineBackup&quot;     &quot;DeviceProtection&quot;
## [13] &quot;TechSupport&quot;      &quot;StreamingTV&quot;      &quot;StreamingMovies&quot;  &quot;Contract&quot;        
## [17] &quot;PaperlessBilling&quot; &quot;PaymentMethod&quot;    &quot;MonthlyCharges&quot;   &quot;TotalCharges&quot;    
## [21] &quot;Churn&quot;</code></pre>
<p>Como en el ejemplo de regresión, primero crearemos los conjuntos de entrenamiento y de prueba.</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="machine-learning-aprendizaje-supervisado.html#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb137-2"><a href="machine-learning-aprendizaje-supervisado.html#cb137-2" aria-hidden="true" tabindex="-1"></a>telco_split <span class="ot">&lt;-</span> <span class="fu">initial_split</span>(telco, <span class="at">prop =</span> .<span class="dv">7</span>)</span>
<span id="cb137-3"><a href="machine-learning-aprendizaje-supervisado.html#cb137-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-4"><a href="machine-learning-aprendizaje-supervisado.html#cb137-4" aria-hidden="true" tabindex="-1"></a>telco_train <span class="ot">&lt;-</span> <span class="fu">training</span>(telco_split)</span>
<span id="cb137-5"><a href="machine-learning-aprendizaje-supervisado.html#cb137-5" aria-hidden="true" tabindex="-1"></a>telco_test  <span class="ot">&lt;-</span> <span class="fu">testing</span>(telco_split)</span></code></pre></div>
<p>En el siguiente chunk definiremos la receta con funciones usadas en el ejemplo anterior más la función <em>step_num2factor()</em> que nos ayuda a categorizar una variable continua.</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="machine-learning-aprendizaje-supervisado.html#cb138-1" aria-hidden="true" tabindex="-1"></a>binner <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb138-2"><a href="machine-learning-aprendizaje-supervisado.html#cb138-2" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">cut</span>(x, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">12</span>, <span class="dv">24</span>, <span class="dv">36</span>,<span class="dv">48</span>,<span class="dv">60</span>,<span class="dv">72</span>), <span class="at">include.lowest =</span> <span class="cn">TRUE</span>)</span>
<span id="cb138-3"><a href="machine-learning-aprendizaje-supervisado.html#cb138-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.numeric</span>(x)</span>
<span id="cb138-4"><a href="machine-learning-aprendizaje-supervisado.html#cb138-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb138-5"><a href="machine-learning-aprendizaje-supervisado.html#cb138-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-6"><a href="machine-learning-aprendizaje-supervisado.html#cb138-6" aria-hidden="true" tabindex="-1"></a>telco_rec <span class="ot">&lt;-</span> <span class="fu">recipe</span>(Churn <span class="sc">~</span> ., <span class="at">data =</span> telco_train) <span class="sc">%&gt;%</span> </span>
<span id="cb138-7"><a href="machine-learning-aprendizaje-supervisado.html#cb138-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_mutate</span>(<span class="at">MultipleLines =</span> forcats<span class="sc">::</span><span class="fu">fct_collapse</span>(MultipleLines, <span class="at">No =</span> <span class="st">&quot;No phone service&quot;</span>),</span>
<span id="cb138-8"><a href="machine-learning-aprendizaje-supervisado.html#cb138-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">OnlineSecurity =</span> forcats<span class="sc">::</span><span class="fu">fct_collapse</span>(OnlineSecurity, <span class="at">No =</span> <span class="st">&quot;No internet service&quot;</span>),</span>
<span id="cb138-9"><a href="machine-learning-aprendizaje-supervisado.html#cb138-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">OnlineBackup =</span> forcats<span class="sc">::</span><span class="fu">fct_collapse</span>(OnlineBackup, <span class="at">No =</span> <span class="st">&quot;No internet service&quot;</span>),</span>
<span id="cb138-10"><a href="machine-learning-aprendizaje-supervisado.html#cb138-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">DeviceProtection =</span> forcats<span class="sc">::</span><span class="fu">fct_collapse</span>(DeviceProtection, <span class="at">No =</span> <span class="st">&quot;No internet service&quot;</span>),</span>
<span id="cb138-11"><a href="machine-learning-aprendizaje-supervisado.html#cb138-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">TechSupport =</span> forcats<span class="sc">::</span><span class="fu">fct_collapse</span>(TechSupport, <span class="at">No =</span> <span class="st">&quot;No internet service&quot;</span>),</span>
<span id="cb138-12"><a href="machine-learning-aprendizaje-supervisado.html#cb138-12" aria-hidden="true" tabindex="-1"></a>              <span class="at">StreamingTV =</span> forcats<span class="sc">::</span><span class="fu">fct_collapse</span>(StreamingTV, <span class="at">No =</span> <span class="st">&quot;No internet service&quot;</span>),</span>
<span id="cb138-13"><a href="machine-learning-aprendizaje-supervisado.html#cb138-13" aria-hidden="true" tabindex="-1"></a>              <span class="at">StreamingMovies =</span> forcats<span class="sc">::</span><span class="fu">fct_collapse</span>(StreamingMovies, <span class="at">No =</span> <span class="st">&quot;No internet service&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb138-14"><a href="machine-learning-aprendizaje-supervisado.html#cb138-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_num2factor</span>(tenure, <span class="at">transform =</span> binner, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;0-1 year&quot;</span>, <span class="st">&quot;1-2 years&quot;</span>, <span class="st">&quot;2-3 years&quot;</span>, <span class="st">&quot;3-4 years&quot;</span>, <span class="st">&quot;4-5 years&quot;</span>, <span class="st">&quot;5-6 years&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb138-15"><a href="machine-learning-aprendizaje-supervisado.html#cb138-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_rm</span>(customerID) <span class="sc">%&gt;%</span> </span>
<span id="cb138-16"><a href="machine-learning-aprendizaje-supervisado.html#cb138-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_normalize</span>(<span class="fu">all_numeric_predictors</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb138-17"><a href="machine-learning-aprendizaje-supervisado.html#cb138-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_dummy</span>(<span class="fu">all_nominal_predictors</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb138-18"><a href="machine-learning-aprendizaje-supervisado.html#cb138-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_impute_median</span>(<span class="fu">all_numeric_predictors</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb138-19"><a href="machine-learning-aprendizaje-supervisado.html#cb138-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prep</span>()</span></code></pre></div>
<p>Ahora recuperamos la matriz de diseño con las funciones <em>prep()</em> y <em>juice()</em>.</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="machine-learning-aprendizaje-supervisado.html#cb139-1" aria-hidden="true" tabindex="-1"></a>telco_juiced <span class="ot">&lt;-</span> <span class="fu">juice</span>(telco_rec)</span>
<span id="cb139-2"><a href="machine-learning-aprendizaje-supervisado.html#cb139-2" aria-hidden="true" tabindex="-1"></a>telco_juiced</span></code></pre></div>
<pre><code>## # A tibble: 4,930 × 28
##    SeniorCitizen MonthlyCharges TotalCharges Churn gender_Male Partner_Yes
##            &lt;dbl&gt;          &lt;dbl&gt;        &lt;dbl&gt; &lt;fct&gt;       &lt;dbl&gt;       &lt;dbl&gt;
##  1        -0.442         -1.50        -0.663 No              0           0
##  2        -0.442          0.664        0.472 No              1           1
##  3        -0.442         -0.508       -0.546 No              0           0
##  4         2.26           0.649       -0.850 Yes             0           0
##  5        -0.442          0.167       -0.979 Yes             0           0
##  6        -0.442          0.842        0.975 No              1           1
##  7        -0.442          0.260       -0.648 No              1           0
##  8        -0.442         -0.668        0.178 No              1           1
##  9        -0.442         -1.20        -0.706 No              1           1
## 10        -0.442         -0.407       -0.348 No              0           0
## # … with 4,920 more rows, and 22 more variables: Dependents_Yes &lt;dbl&gt;,
## #   tenure_X1.2.years &lt;dbl&gt;, tenure_X2.3.years &lt;dbl&gt;, tenure_X3.4.years &lt;dbl&gt;,
## #   tenure_X4.5.years &lt;dbl&gt;, tenure_X5.6.years &lt;dbl&gt;, PhoneService_Yes &lt;dbl&gt;,
## #   MultipleLines_Yes &lt;dbl&gt;, InternetService_Fiber.optic &lt;dbl&gt;,
## #   InternetService_No &lt;dbl&gt;, OnlineSecurity_Yes &lt;dbl&gt;, OnlineBackup_Yes &lt;dbl&gt;,
## #   DeviceProtection_Yes &lt;dbl&gt;, TechSupport_Yes &lt;dbl&gt;, StreamingTV_Yes &lt;dbl&gt;,
## #   StreamingMovies_Yes &lt;dbl&gt;, Contract_One.year &lt;dbl&gt;, …</code></pre>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="machine-learning-aprendizaje-supervisado.html#cb141-1" aria-hidden="true" tabindex="-1"></a>telco_test_bake <span class="ot">&lt;-</span>  <span class="fu">bake</span>(telco_rec, <span class="at">new_data =</span> telco_test)</span>
<span id="cb141-2"><a href="machine-learning-aprendizaje-supervisado.html#cb141-2" aria-hidden="true" tabindex="-1"></a>telco_test_bake</span></code></pre></div>
<pre><code>## # A tibble: 2,113 × 28
##    SeniorCitizen MonthlyCharges TotalCharges Churn gender_Male Partner_Yes
##            &lt;dbl&gt;          &lt;dbl&gt;        &lt;dbl&gt; &lt;fct&gt;       &lt;dbl&gt;       &lt;dbl&gt;
##  1        -0.442         -0.271       -0.175 No              1           0
##  2        -0.442          1.15        -0.647 Yes             0           0
##  3        -0.442         -1.18        -0.876 No              0           0
##  4        -0.442         -1.53        -0.865 No              1           0
##  5        -0.442          1.38         2.25  No              1           0
##  6        -0.442          0.830       -0.187 No              0           0
##  7        -0.442         -1.51        -0.920 No              1           1
##  8        -0.442         -0.183        0.302 No              1           1
##  9        -0.442         -1.16        -0.996 Yes             1           1
## 10        -0.442          0.837        1.80  No              1           1
## # … with 2,103 more rows, and 22 more variables: Dependents_Yes &lt;dbl&gt;,
## #   tenure_X1.2.years &lt;dbl&gt;, tenure_X2.3.years &lt;dbl&gt;, tenure_X3.4.years &lt;dbl&gt;,
## #   tenure_X4.5.years &lt;dbl&gt;, tenure_X5.6.years &lt;dbl&gt;, PhoneService_Yes &lt;dbl&gt;,
## #   MultipleLines_Yes &lt;dbl&gt;, InternetService_Fiber.optic &lt;dbl&gt;,
## #   InternetService_No &lt;dbl&gt;, OnlineSecurity_Yes &lt;dbl&gt;, OnlineBackup_Yes &lt;dbl&gt;,
## #   DeviceProtection_Yes &lt;dbl&gt;, TechSupport_Yes &lt;dbl&gt;, StreamingTV_Yes &lt;dbl&gt;,
## #   StreamingMovies_Yes &lt;dbl&gt;, Contract_One.year &lt;dbl&gt;, …</code></pre>
<p>Estos fueron dos ejemplos aplicados de la paquetería <em>recipies</em>, existen distintas funciones <em>step</em> que pueden implementarse en recetas para usarse con <em>tidymodels</em>, en las secciones siguientes les daremos su uso para ajustar un modelo completo.</p>
</div>
<div id="regresión-lineal-simple-y-múltiple" class="section level2" number="6.3">
<h2><span class="header-section-number">6.3</span> Regresión lineal simple y múltiple</h2>
<p>En esta sección aprenderemos sobre regresión lineal simple y múltiple, como se ajusta un modelo de regresión en R, las métricas de desempeño para problemas de regresión y como podemos comparar modelos con estas métricas.</p>
<p>Existen dos tipos de modelos de regresión lineal: regresión simple y regresión múltiple. La regresión lineal simple es cuando se utiliza <strong>una</strong> variable independiente para estimar una variable dependiente. Cuando se utiliza <strong>más de una</strong> variable independiente, el proceso se denomina regresión lineal múltiple.</p>
<p>En un modelo de regresión lineal simple tratamos de explicar la relación que existe entre la
variable respuesta <span class="math inline">\(Y\)</span> y una única variable explicativa <span class="math inline">\(X\)</span>, el modelo es de la forma:</p>
<p><span class="math display">\[Y = \beta_0 + \beta_1X_1 + \epsilon\]</span>
Con <span class="math inline">\(\beta_0\)</span> la ordenada al origen, <span class="math inline">\(\beta_1\)</span> la pendiente y <span class="math inline">\(\epsilon_i\)</span> como el error aleatorio.</p>
<div id="htmlwidget-496422692c96fb684152" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-496422692c96fb684152">{"x":{"visdat":{"bbe73a20bb1c":["function () ","plotlyVisDat"]},"cur_data":"bbe73a20bb1c","attrs":{"bbe73a20bb1c":{"x":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"y":{},"type":"scatter","mode":"markers","inherit":true},"bbe73a20bb1c.1":{"x":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"y":[55.7960652924429,52.4655115657131,26.9312663274514,33.0372814931227,14.1641437083206,49.1349578389834,20.2701588739918,-14.7006552566709,58.5715267313844,43.0289426733121,45.8044041122536,36.3678352198525,23.6007126007216,33.0372814931227,30.2618200541812,-5.26408636426985,33.0372814931227,43.0289426733121,43.0289426733121,4.72757481591949,43.0289426733121,30.2618200541812,30.2618200541812,14.1641437083206,65.232634184844,55.7960652924429,43.0289426733121,20.2701588739918,33.0372814931227,52.4655115657131,14.1641437083206,-18.0312089834007,45.8044041122536,33.0372814931227,39.6983889465823,74.1141107894568,45.8044041122536,45.8044041122536,71.3386493505153,36.3678352198525,68.5631879115738,61.9020804581142,65.232634184844,55.7960652924429,17.4946974350504,14.1641437083206,17.4946974350504,58.5715267313844,39.6983889465823,61.9020804581142,68.5631879115738,33.0372814931227,58.5715267313844,49.1349578389834,52.4655115657131,49.1349578389834,30.2618200541812,55.7960652924429,55.7960652924429,55.7960652924429,45.8044041122536,58.5715267313844,20.2701588739918,55.7960652924429,58.5715267313844,55.7960652924429,71.3386493505153,74.6692030772451,39.6983889465823,52.4655115657131,33.0372814931227,33.0372814931227,43.0289426733121,39.6983889465823,61.9020804581142,55.7960652924429,36.3678352198525,39.6983889465823,10.8335899815908,17.4946974350504,43.0289426733121,77.9997568039748,52.4655115657131,43.0289426733121,84.1057719696461,61.9020804581142,61.9020804581142,58.5715267313844,68.5631879115738,81.3303105307046,71.3386493505153,55.7960652924429,10.8335899815908,36.3678352198525,39.6983889465823,36.3678352198525,43.0289426733121,14.1641437083206,10.8335899815908,61.9020804581142,36.3678352198525,33.0372814931227,58.5715267313844,20.2701588739918,39.6983889465823,39.6983889465823,52.4655115657131,26.9312663274514,45.8044041122536,39.6983889465823,39.6983889465823,4.72757481591949,58.5715267313844,17.4946974350504,52.4655115657131,33.0372814931227],"type":"scatter","mode":"lines","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"Wind"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Ozone"},"hovermode":"closest","showlegend":true},"source":"A","config":{"showSendToCloud":false},"data":[{"x":[7.4,8,12.6,11.5,14.9,8.6,13.8,20.1,6.9,9.7,9.2,10.9,13.2,11.5,12,18.4,11.5,9.7,9.7,16.6,9.7,12,12,14.9,5.7,7.4,9.7,13.8,11.5,8,14.9,20.7,9.2,11.5,10.3,4.1,9.2,9.2,4.6,10.9,5.1,6.3,5.7,7.4,14.3,14.9,14.3,6.9,10.3,6.3,5.1,11.5,6.9,8.6,8,8.6,12,7.4,7.4,7.4,9.2,6.9,13.8,7.4,6.9,7.4,4.6,4,10.3,8,11.5,11.5,9.7,10.3,6.3,7.4,10.9,10.3,15.5,14.3,9.7,3.4,8,9.7,2.3,6.3,6.3,6.9,5.1,2.8,4.6,7.4,15.5,10.9,10.3,10.9,9.7,14.9,15.5,6.3,10.9,11.5,6.9,13.8,10.3,10.3,8,12.6,9.2,10.3,10.3,16.6,6.9,14.3,8,11.5],"y":[41,36,12,18,28,23,19,8,7,16,11,14,18,14,34,6,30,11,1,11,4,32,23,45,115,37,29,71,39,23,21,37,20,12,13,135,49,32,64,40,77,97,97,85,10,27,7,48,35,61,79,63,16,80,108,20,52,82,50,64,59,39,9,16,78,35,66,122,89,110,44,28,65,22,59,23,31,44,21,9,45,168,73,76,118,84,85,96,78,73,91,47,32,20,23,21,24,44,21,28,9,13,46,18,13,24,16,13,23,36,7,14,30,14,18,20],"type":"scatter","mode":"markers","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2.3,2.8,3.4,4,4.1,4.6,4.6,4.6,5.1,5.1,5.1,5.7,5.7,6.3,6.3,6.3,6.3,6.3,6.3,6.9,6.9,6.9,6.9,6.9,6.9,6.9,6.9,7.4,7.4,7.4,7.4,7.4,7.4,7.4,7.4,7.4,7.4,8,8,8,8,8,8,8,8.6,8.6,8.6,9.2,9.2,9.2,9.2,9.2,9.2,9.7,9.7,9.7,9.7,9.7,9.7,9.7,9.7,9.7,10.3,10.3,10.3,10.3,10.3,10.3,10.3,10.3,10.3,10.3,10.9,10.9,10.9,10.9,10.9,10.9,11.5,11.5,11.5,11.5,11.5,11.5,11.5,11.5,11.5,11.5,12,12,12,12,12.6,12.6,13.2,13.8,13.8,13.8,13.8,14.3,14.3,14.3,14.3,14.9,14.9,14.9,14.9,14.9,15.5,15.5,15.5,16.6,16.6,18.4,20.1,20.7],"y":[84.1057719696461,81.3303105307046,77.9997568039748,74.6692030772451,74.1141107894568,71.3386493505153,71.3386493505153,71.3386493505153,68.5631879115738,68.5631879115738,68.5631879115738,65.232634184844,65.232634184844,61.9020804581142,61.9020804581142,61.9020804581142,61.9020804581142,61.9020804581142,61.9020804581142,58.5715267313844,58.5715267313844,58.5715267313844,58.5715267313844,58.5715267313844,58.5715267313844,58.5715267313844,58.5715267313844,55.7960652924429,55.7960652924429,55.7960652924429,55.7960652924429,55.7960652924429,55.7960652924429,55.7960652924429,55.7960652924429,55.7960652924429,55.7960652924429,52.4655115657131,52.4655115657131,52.4655115657131,52.4655115657131,52.4655115657131,52.4655115657131,52.4655115657131,49.1349578389834,49.1349578389834,49.1349578389834,45.8044041122536,45.8044041122536,45.8044041122536,45.8044041122536,45.8044041122536,45.8044041122536,43.0289426733121,43.0289426733121,43.0289426733121,43.0289426733121,43.0289426733121,43.0289426733121,43.0289426733121,43.0289426733121,43.0289426733121,39.6983889465823,39.6983889465823,39.6983889465823,39.6983889465823,39.6983889465823,39.6983889465823,39.6983889465823,39.6983889465823,39.6983889465823,39.6983889465823,36.3678352198525,36.3678352198525,36.3678352198525,36.3678352198525,36.3678352198525,36.3678352198525,33.0372814931227,33.0372814931227,33.0372814931227,33.0372814931227,33.0372814931227,33.0372814931227,33.0372814931227,33.0372814931227,33.0372814931227,33.0372814931227,30.2618200541812,30.2618200541812,30.2618200541812,30.2618200541812,26.9312663274514,26.9312663274514,23.6007126007216,20.2701588739918,20.2701588739918,20.2701588739918,20.2701588739918,17.4946974350504,17.4946974350504,17.4946974350504,17.4946974350504,14.1641437083206,14.1641437083206,14.1641437083206,14.1641437083206,14.1641437083206,10.8335899815908,10.8335899815908,10.8335899815908,4.72757481591949,4.72757481591949,-5.26408636426985,-14.7006552566709,-18.0312089834007],"type":"scatter","mode":"lines","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>El objetivo de un modelo de regresión múltiple es tratar de explicar la relación que existe entre una
variable dependiente (variable respuesta) <span class="math inline">\(Y\)</span> un conjunto de variables independientes (variables
explicativas) <span class="math inline">\(X1,..., Xm\)</span>, el modelo es de la forma:</p>
<p><span class="math display">\[Y = \beta_0 + \beta_1X_1 + \cdot \cdot \cdot + \beta_mX_m + \epsilon\]</span>
Con:</p>
<ul>
<li><p><span class="math inline">\(Y\)</span> como variable respuesta.</p></li>
<li><p><span class="math inline">\(X_1,X_2,...,X_m\)</span> como las variables explicativas, independientes o regresoras.</p></li>
<li><p><span class="math inline">\(\beta_1, \beta_2,...,\beta_m\)</span> es el efecto promedio que tiene el incremento en una unidad de la variable predictora Xi sobre la variable dependiente Y, manteniéndose constantes el resto de variables. Se conocen como coeficientes parciales de regresión.</p></li>
</ul>
<div id="htmlwidget-cbaf367b0db9f3e16843" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-cbaf367b0db9f3e16843">{"x":{"visdat":{"bbe75441de3c":["function () ","plotlyVisDat"]},"cur_data":"bbe75441de3c","attrs":{"bbe75441de3c":{"x":{},"y":{},"z":{},"text":{},"mode":"markers","marker":{"color":["red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green"]},"size":1,"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d"},"bbe75441de3c.1":{"x":[4.3,4.35,4.4,4.45,4.5,4.55,4.6,4.65,4.7,4.75,4.8,4.85,4.9,4.95,5,5.05,5.1,5.15,5.2,5.25,5.3,5.35,5.4,5.45,5.5,5.55,5.6,5.65,5.7,5.75,5.8,5.85,5.9,5.95,6,6.05,6.1,6.15,6.2,6.25,6.3,6.35,6.4,6.45,6.5,6.55,6.6,6.65,6.7,6.75,6.8,6.85,6.9,6.95,7,7.05,7.1,7.15,7.2,7.25,7.3,7.35,7.4,7.45,7.5,7.55,7.6,7.65,7.7,7.75,7.8,7.85,7.9],"y":[2,2.05,2.1,2.15,2.2,2.25,2.3,2.35,2.4,2.45,2.5,2.55,2.6,2.65,2.7,2.75,2.8,2.85,2.9,2.95,3,3.05,3.1,3.15,3.2,3.25,3.3,3.35,3.4,3.45,3.5,3.55,3.6,3.65,3.7,3.75,3.8,3.85,3.9,3.95,4,4.05,4.1,4.15,4.2,4.25,4.3,4.35,4.4],"z":[[3.21788560449766,3.29590065492145,3.37391570534525,3.45193075576905,3.52994580619284,3.60796085661664,3.68597590704044,3.76399095746423,3.84200600788803,3.92002105831182,3.99803610873562,4.07605115915942,4.15406620958321,4.23208126000701,4.3100963104308,4.3881113608546,4.4661264112784,4.54414146170219,4.62215651212599,4.70017156254978,4.77818661297358,4.85620166339737,4.93421671382117,5.01223176424497,5.09024681466876,5.16826186509256,5.24627691551636,5.32429196594015,5.40230701636395,5.48032206678774,5.55833711721154,5.63635216763534,5.71436721805913,5.79238226848293,5.87039731890672,5.94841236933052,6.02642741975431,6.10444247017811,6.18245752060191,6.2604725710257,6.3384876214495,6.4165026718733,6.49451772229709,6.57253277272089,6.65054782314468,6.72856287356848,6.80657792399228,6.88459297441607,6.96260802483987,7.04062307526366,7.11863812568746,7.19665317611126,7.27466822653505,7.35268327695885,7.43069832738265,7.50871337780644,7.58672842823024,7.66474347865403,7.74275852907783,7.82077357950162,7.89878862992542,7.97680368034922,8.05481873077301,8.13283378119681,8.2108488316206,8.2888638820444,8.3668789324682,8.44489398289199,8.52290903331579,8.60092408373959,8.67893913416338,8.75695418458718,8.83496923501097],[3.13060038619894,3.20861543662274,3.28663048704653,3.36464553747033,3.44266058789412,3.52067563831792,3.59869068874172,3.67670573916551,3.75472078958931,3.8327358400131,3.9107508904369,3.9887659408607,4.06678099128449,4.14479604170829,4.22281109213208,4.30082614255588,4.37884119297968,4.45685624340347,4.53487129382727,4.61288634425106,4.69090139467486,4.76891644509865,4.84693149552245,4.92494654594625,5.00296159637004,5.08097664679384,5.15899169721764,5.23700674764143,5.31502179806523,5.39303684848902,5.47105189891282,5.54906694933662,5.62708199976041,5.70509705018421,5.783112100608,5.8611271510318,5.93914220145559,6.01715725187939,6.09517230230319,6.17318735272698,6.25120240315078,6.32921745357458,6.40723250399837,6.48524755442217,6.56326260484596,6.64127765526976,6.71929270569356,6.79730775611735,6.87532280654115,6.95333785696494,7.03135290738874,7.10936795781254,7.18738300823633,7.26539805866013,7.34341310908392,7.42142815950772,7.49944320993152,7.57745826035531,7.65547331077911,7.7334883612029,7.8115034116267,7.8895184620505,7.96753351247429,8.04554856289809,8.12356361332188,8.20157866374568,8.27959371416948,8.35760876459327,8.43562381501707,8.51363886544086,8.59165391586466,8.66966896628846,8.74768401671225],[3.04331516790022,3.12133021832401,3.19934526874781,3.27736031917161,3.3553753695954,3.4333904200192,3.511405470443,3.58942052086679,3.66743557129059,3.74545062171438,3.82346567213818,3.90148072256198,3.97949577298577,4.05751082340957,4.13552587383336,4.21354092425716,4.29155597468096,4.36957102510475,4.44758607552855,4.52560112595234,4.60361617637614,4.68163122679993,4.75964627722373,4.83766132764753,4.91567637807132,4.99369142849512,5.07170647891892,5.14972152934271,5.22773657976651,5.3057516301903,5.3837666806141,5.4617817310379,5.53979678146169,5.61781183188549,5.69582688230928,5.77384193273308,5.85185698315687,5.92987203358067,6.00788708400447,6.08590213442826,6.16391718485206,6.24193223527586,6.31994728569965,6.39796233612345,6.47597738654724,6.55399243697104,6.63200748739484,6.71002253781863,6.78803758824243,6.86605263866622,6.94406768909002,7.02208273951382,7.10009778993761,7.17811284036141,7.2561278907852,7.334142941209,7.4121579916328,7.49017304205659,7.56818809248039,7.64620314290418,7.72421819332798,7.80223324375178,7.88024829417557,7.95826334459937,8.03627839502316,8.11429344544696,8.19230849587076,8.27032354629455,8.34833859671835,8.42635364714214,8.50436869756594,8.58238374798974,8.66039879841353],[2.9560299496015,3.0340450000253,3.11206005044909,3.19007510087289,3.26809015129668,3.34610520172048,3.42412025214428,3.50213530256807,3.58015035299187,3.65816540341566,3.73618045383946,3.81419550426326,3.89221055468705,3.97022560511085,4.04824065553464,4.12625570595844,4.20427075638224,4.28228580680603,4.36030085722983,4.43831590765362,4.51633095807742,4.59434600850121,4.67236105892501,4.75037610934881,4.8283911597726,4.9064062101964,4.9844212606202,5.06243631104399,5.14045136146779,5.21846641189158,5.29648146231538,5.37449651273918,5.45251156316297,5.53052661358677,5.60854166401056,5.68655671443436,5.76457176485815,5.84258681528195,5.92060186570575,5.99861691612954,6.07663196655334,6.15464701697714,6.23266206740093,6.31067711782473,6.38869216824852,6.46670721867232,6.54472226909612,6.62273731951991,6.70075236994371,6.7787674203675,6.8567824707913,6.9347975212151,7.01281257163889,7.09082762206269,7.16884267248648,7.24685772291028,7.32487277333408,7.40288782375787,7.48090287418167,7.55891792460546,7.63693297502926,7.71494802545306,7.79296307587685,7.87097812630065,7.94899317672444,8.02700822714824,8.10502327757204,8.18303832799583,8.26105337841963,8.33906842884343,8.41708347926722,8.49509852969102,8.57311358011481],[2.86874473130278,2.94675978172657,3.02477483215037,3.10278988257417,3.18080493299796,3.25881998342176,3.33683503384556,3.41485008426935,3.49286513469315,3.57088018511694,3.64889523554074,3.72691028596454,3.80492533638833,3.88294038681213,3.96095543723592,4.03897048765972,4.11698553808352,4.19500058850731,4.27301563893111,4.3510306893549,4.4290457397787,4.50706079020249,4.58507584062629,4.66309089105009,4.74110594147388,4.81912099189768,4.89713604232148,4.97515109274527,5.05316614316907,5.13118119359286,5.20919624401666,5.28721129444046,5.36522634486425,5.44324139528805,5.52125644571184,5.59927149613564,5.67728654655943,5.75530159698323,5.83331664740703,5.91133169783082,5.98934674825462,6.06736179867842,6.14537684910221,6.22339189952601,6.3014069499498,6.3794220003736,6.4574370507974,6.53545210122119,6.61346715164499,6.69148220206878,6.76949725249258,6.84751230291638,6.92552735334017,7.00354240376397,7.08155745418776,7.15957250461156,7.23758755503536,7.31560260545915,7.39361765588295,7.47163270630674,7.54964775673054,7.62766280715434,7.70567785757813,7.78369290800193,7.86170795842572,7.93972300884952,8.01773805927332,8.09575310969711,8.17376816012091,8.2517832105447,8.3297982609685,8.4078133113923,8.48582836181609],[2.78145951300406,2.85947456342786,2.93748961385165,3.01550466427545,3.09351971469924,3.17153476512304,3.24954981554684,3.32756486597063,3.40557991639443,3.48359496681822,3.56161001724202,3.63962506766582,3.71764011808961,3.79565516851341,3.8736702189372,3.951685269361,4.0297003197848,4.10771537020859,4.18573042063239,4.26374547105618,4.34176052147998,4.41977557190377,4.49779062232757,4.57580567275137,4.65382072317516,4.73183577359896,4.80985082402276,4.88786587444655,4.96588092487035,5.04389597529414,5.12191102571794,5.19992607614174,5.27794112656553,5.35595617698933,5.43397122741312,5.51198627783692,5.59000132826071,5.66801637868451,5.74603142910831,5.8240464795321,5.9020615299559,5.9800765803797,6.05809163080349,6.13610668122729,6.21412173165108,6.29213678207488,6.37015183249868,6.44816688292247,6.52618193334627,6.60419698377006,6.68221203419386,6.76022708461766,6.83824213504145,6.91625718546525,6.99427223588904,7.07228728631284,7.15030233673664,7.22831738716043,7.30633243758423,7.38434748800802,7.46236253843182,7.54037758885562,7.61839263927941,7.69640768970321,7.774422740127,7.8524377905508,7.9304528409746,8.00846789139839,8.08648294182219,8.16449799224598,8.24251304266978,8.32052809309357,8.39854314351737],[2.69417429470534,2.77218934512914,2.85020439555293,2.92821944597673,3.00623449640052,3.08424954682432,3.16226459724812,3.24027964767191,3.31829469809571,3.3963097485195,3.4743247989433,3.5523398493671,3.63035489979089,3.70836995021469,3.78638500063848,3.86440005106228,3.94241510148608,4.02043015190987,4.09844520233367,4.17646025275746,4.25447530318126,4.33249035360506,4.41050540402885,4.48852045445265,4.56653550487645,4.64455055530024,4.72256560572404,4.80058065614783,4.87859570657163,4.95661075699542,5.03462580741922,5.11264085784302,5.19065590826681,5.26867095869061,5.3466860091144,5.4247010595382,5.502716109962,5.58073116038579,5.65874621080959,5.73676126123339,5.81477631165718,5.89279136208098,5.97080641250477,6.04882146292857,6.12683651335237,6.20485156377616,6.28286661419996,6.36088166462375,6.43889671504755,6.51691176547134,6.59492681589514,6.67294186631894,6.75095691674273,6.82897196716653,6.90698701759033,6.98500206801412,7.06301711843792,7.14103216886171,7.21904721928551,7.29706226970931,7.3750773201331,7.4530923705569,7.53110742098069,7.60912247140449,7.68713752182828,7.76515257225208,7.84316762267588,7.92118267309967,7.99919772352347,8.07721277394727,8.15522782437106,8.23324287479486,8.31125792521865],[2.60688907640662,2.68490412683042,2.76291917725421,2.84093422767801,2.9189492781018,2.9969643285256,3.0749793789494,3.15299442937319,3.23100947979699,3.30902453022078,3.38703958064458,3.46505463106838,3.54306968149217,3.62108473191597,3.69909978233976,3.77711483276356,3.85512988318736,3.93314493361115,4.01115998403495,4.08917503445874,4.16719008488254,4.24520513530633,4.32322018573013,4.40123523615393,4.47925028657772,4.55726533700152,4.63528038742532,4.71329543784911,4.79131048827291,4.8693255386967,4.9473405891205,5.0253556395443,5.10337068996809,5.18138574039189,5.25940079081568,5.33741584123948,5.41543089166327,5.49344594208707,5.57146099251087,5.64947604293466,5.72749109335846,5.80550614378226,5.88352119420605,5.96153624462985,6.03955129505364,6.11756634547744,6.19558139590124,6.27359644632503,6.35161149674883,6.42962654717262,6.50764159759642,6.58565664802022,6.66367169844401,6.74168674886781,6.8197017992916,6.8977168497154,6.9757319001392,7.05374695056299,7.13176200098679,7.20977705141058,7.28779210183438,7.36580715225818,7.44382220268197,7.52183725310577,7.59985230352956,7.67786735395336,7.75588240437716,7.83389745480095,7.91191250522475,7.98992755564854,8.06794260607234,8.14595765649614,8.22397270691993],[2.5196038581079,2.5976189085317,2.67563395895549,2.75364900937929,2.83166405980308,2.90967911022688,2.98769416065068,3.06570921107447,3.14372426149827,3.22173931192206,3.29975436234586,3.37776941276966,3.45578446319345,3.53379951361725,3.61181456404104,3.68982961446484,3.76784466488864,3.84585971531243,3.92387476573623,4.00188981616002,4.07990486658382,4.15791991700762,4.23593496743141,4.31395001785521,4.39196506827901,4.4699801187028,4.5479951691266,4.62601021955039,4.70402526997419,4.78204032039798,4.86005537082178,4.93807042124558,5.01608547166937,5.09410052209317,5.17211557251696,5.25013062294076,5.32814567336456,5.40616072378835,5.48417577421215,5.56219082463595,5.64020587505974,5.71822092548354,5.79623597590733,5.87425102633113,5.95226607675492,6.03028112717872,6.10829617760252,6.18631122802631,6.26432627845011,6.3423413288739,6.4203563792977,6.4983714297215,6.57638648014529,6.65440153056909,6.73241658099289,6.81043163141668,6.88844668184048,6.96646173226427,7.04447678268807,7.12249183311186,7.20050688353566,7.27852193395946,7.35653698438325,7.43455203480705,7.51256708523084,7.59058213565464,7.66859718607844,7.74661223650223,7.82462728692603,7.90264233734983,7.98065738777362,8.05867243819742,8.13668748862121],[2.43231863980918,2.51033369023297,2.58834874065677,2.66636379108057,2.74437884150436,2.82239389192816,2.90040894235196,2.97842399277575,3.05643904319955,3.13445409362334,3.21246914404714,3.29048419447094,3.36849924489473,3.44651429531853,3.52452934574232,3.60254439616612,3.68055944658991,3.75857449701371,3.83658954743751,3.9146045978613,3.9926196482851,4.07063469870889,4.14864974913269,4.22666479955649,4.30467984998028,4.38269490040408,4.46070995082788,4.53872500125167,4.61674005167547,4.69475510209926,4.77277015252306,4.85078520294686,4.92880025337065,5.00681530379445,5.08483035421824,5.16284540464204,5.24086045506583,5.31887550548963,5.39689055591343,5.47490560633722,5.55292065676102,5.63093570718482,5.70895075760861,5.78696580803241,5.8649808584562,5.94299590888,6.0210109593038,6.09902600972759,6.17704106015139,6.25505611057518,6.33307116099898,6.41108621142278,6.48910126184657,6.56711631227037,6.64513136269416,6.72314641311796,6.80116146354176,6.87917651396555,6.95719156438935,7.03520661481314,7.11322166523694,7.19123671566074,7.26925176608453,7.34726681650833,7.42528186693212,7.50329691735592,7.58131196777972,7.65932701820351,7.73734206862731,7.8153571190511,7.8933721694749,7.9713872198987,8.04940227032249],[2.34503342151046,2.42304847193426,2.50106352235805,2.57907857278185,2.65709362320564,2.73510867362944,2.81312372405324,2.89113877447703,2.96915382490083,3.04716887532462,3.12518392574842,3.20319897617222,3.28121402659601,3.35922907701981,3.4372441274436,3.5152591778674,3.5932742282912,3.67128927871499,3.74930432913879,3.82731937956258,3.90533442998638,3.98334948041018,4.06136453083397,4.13937958125777,4.21739463168157,4.29540968210536,4.37342473252916,4.45143978295295,4.52945483337675,4.60746988380054,4.68548493422434,4.76349998464814,4.84151503507193,4.91953008549573,4.99754513591952,5.07556018634332,5.15357523676712,5.23159028719091,5.30960533761471,5.38762038803851,5.4656354384623,5.5436504888861,5.62166553930989,5.69968058973369,5.77769564015748,5.85571069058128,5.93372574100508,6.01174079142887,6.08975584185267,6.16777089227646,6.24578594270026,6.32380099312406,6.40181604354785,6.47983109397165,6.55784614439545,6.63586119481924,6.71387624524304,6.79189129566683,6.86990634609063,6.94792139651442,7.02593644693822,7.10395149736202,7.18196654778581,7.25998159820961,7.3379966486334,7.4160116990572,7.494026749481,7.57204179990479,7.65005685032859,7.72807190075239,7.80608695117618,7.88410200159998,7.96211705202377],[2.25774820321174,2.33576325363554,2.41377830405933,2.49179335448313,2.56980840490692,2.64782345533072,2.72583850575452,2.80385355617831,2.88186860660211,2.9598836570259,3.0378987074497,3.1159137578735,3.19392880829729,3.27194385872109,3.34995890914488,3.42797395956868,3.50598900999248,3.58400406041627,3.66201911084007,3.74003416126386,3.81804921168766,3.89606426211146,3.97407931253525,4.05209436295905,4.13010941338285,4.20812446380664,4.28613951423044,4.36415456465423,4.44216961507803,4.52018466550182,4.59819971592562,4.67621476634942,4.75422981677321,4.83224486719701,4.9102599176208,4.9882749680446,5.0662900184684,5.14430506889219,5.22232011931599,5.30033516973979,5.37835022016358,5.45636527058738,5.53438032101117,5.61239537143497,5.69041042185876,5.76842547228256,5.84644052270636,5.92445557313015,6.00247062355395,6.08048567397774,6.15850072440154,6.23651577482534,6.31453082524913,6.39254587567293,6.47056092609673,6.54857597652052,6.62659102694432,6.70460607736811,6.78262112779191,6.8606361782157,6.9386512286395,7.0166662790633,7.09468132948709,7.17269637991089,7.25071143033468,7.32872648075848,7.40674153118228,7.48475658160607,7.56277163202987,7.64078668245367,7.71880173287746,7.79681678330126,7.87483183372505],[2.17046298491302,2.24847803533682,2.32649308576061,2.40450813618441,2.4825231866082,2.560538237032,2.6385532874558,2.71656833787959,2.79458338830339,2.87259843872718,2.95061348915098,3.02862853957478,3.10664358999857,3.18465864042237,3.26267369084616,3.34068874126996,3.41870379169376,3.49671884211755,3.57473389254135,3.65274894296514,3.73076399338894,3.80877904381274,3.88679409423653,3.96480914466033,4.04282419508413,4.12083924550792,4.19885429593172,4.27686934635551,4.35488439677931,4.4328994472031,4.5109144976269,4.5889295480507,4.66694459847449,4.74495964889829,4.82297469932208,4.90098974974588,4.97900480016968,5.05701985059347,5.13503490101727,5.21304995144107,5.29106500186486,5.36908005228866,5.44709510271245,5.52511015313625,5.60312520356004,5.68114025398384,5.75915530440764,5.83717035483143,5.91518540525523,5.99320045567902,6.07121550610282,6.14923055652662,6.22724560695041,6.30526065737421,6.38327570779801,6.4612907582218,6.5393058086456,6.61732085906939,6.69533590949319,6.77335095991698,6.85136601034078,6.92938106076458,7.00739611118837,7.08541116161217,7.16342621203596,7.24144126245976,7.31945631288356,7.39747136330735,7.47548641373115,7.55350146415495,7.63151651457874,7.70953156500254,7.78754661542633],[2.0831777666143,2.1611928170381,2.23920786746189,2.31722291788569,2.39523796830948,2.47325301873328,2.55126806915708,2.62928311958087,2.70729817000467,2.78531322042846,2.86332827085226,2.94134332127606,3.01935837169985,3.09737342212365,3.17538847254744,3.25340352297124,3.33141857339504,3.40943362381883,3.48744867424263,3.56546372466642,3.64347877509022,3.72149382551402,3.79950887593781,3.87752392636161,3.95553897678541,4.0335540272092,4.111569077633,4.18958412805679,4.26759917848059,4.34561422890438,4.42362927932818,4.50164432975198,4.57965938017577,4.65767443059957,4.73568948102336,4.81370453144716,4.89171958187096,4.96973463229475,5.04774968271855,5.12576473314235,5.20377978356614,5.28179483398994,5.35980988441373,5.43782493483753,5.51583998526132,5.59385503568512,5.67187008610892,5.74988513653271,5.82790018695651,5.9059152373803,5.9839302878041,6.0619453382279,6.13996038865169,6.21797543907549,6.29599048949929,6.37400553992308,6.45202059034688,6.53003564077067,6.60805069119447,6.68606574161826,6.76408079204206,6.84209584246586,6.92011089288965,6.99812594331345,7.07614099373724,7.15415604416104,7.23217109458484,7.31018614500863,7.38820119543243,7.46621624585623,7.54423129628002,7.62224634670382,7.70026139712761],[1.99589254831558,2.07390759873938,2.15192264916317,2.22993769958697,2.30795275001076,2.38596780043456,2.46398285085836,2.54199790128215,2.62001295170595,2.69802800212974,2.77604305255354,2.85405810297734,2.93207315340113,3.01008820382493,3.08810325424872,3.16611830467252,3.24413335509632,3.32214840552011,3.40016345594391,3.4781785063677,3.5561935567915,3.6342086072153,3.71222365763909,3.79023870806289,3.86825375848669,3.94626880891048,4.02428385933428,4.10229890975807,4.18031396018187,4.25832901060566,4.33634406102946,4.41435911145326,4.49237416187705,4.57038921230085,4.64840426272464,4.72641931314844,4.80443436357224,4.88244941399603,4.96046446441983,5.03847951484363,5.11649456526742,5.19450961569122,5.27252466611501,5.35053971653881,5.4285547669626,5.5065698173864,5.5845848678102,5.66259991823399,5.74061496865779,5.81863001908158,5.89664506950538,5.97466011992918,6.05267517035297,6.13069022077677,6.20870527120057,6.28672032162436,6.36473537204816,6.44275042247195,6.52076547289575,6.59878052331954,6.67679557374334,6.75481062416714,6.83282567459093,6.91084072501473,6.98885577543852,7.06687082586232,7.14488587628612,7.22290092670991,7.30091597713371,7.37893102755751,7.4569460779813,7.5349611284051,7.61297617882889],[1.90860733001686,1.98662238044066,2.06463743086445,2.14265248128825,2.22066753171204,2.29868258213584,2.37669763255964,2.45471268298343,2.53272773340723,2.61074278383103,2.68875783425482,2.76677288467862,2.84478793510241,2.92280298552621,3.00081803595001,3.0788330863738,3.1568481367976,3.23486318722139,3.31287823764519,3.39089328806898,3.46890833849278,3.54692338891658,3.62493843934037,3.70295348976417,3.78096854018797,3.85898359061176,3.93699864103556,4.01501369145935,4.09302874188315,4.17104379230695,4.24905884273074,4.32707389315454,4.40508894357833,4.48310399400213,4.56111904442592,4.63913409484972,4.71714914527352,4.79516419569731,4.87317924612111,4.95119429654491,5.0292093469687,5.1072243973925,5.18523944781629,5.26325449824009,5.34126954866389,5.41928459908768,5.49729964951148,5.57531469993527,5.65332975035907,5.73134480078286,5.80935985120666,5.88737490163046,5.96538995205425,6.04340500247805,6.12142005290185,6.19943510332564,6.27745015374944,6.35546520417323,6.43348025459703,6.51149530502083,6.58951035544462,6.66752540586842,6.74554045629221,6.82355550671601,6.9015705571398,6.9795856075636,7.0576006579874,7.13561570841119,7.21363075883499,7.29164580925879,7.36966085968258,7.44767591010638,7.52569096053017],[1.82132211171814,1.89933716214194,1.97735221256573,2.05536726298953,2.13338231341332,2.21139736383712,2.28941241426092,2.36742746468471,2.44544251510851,2.52345756553231,2.6014726159561,2.6794876663799,2.75750271680369,2.83551776722749,2.91353281765129,2.99154786807508,3.06956291849888,3.14757796892267,3.22559301934647,3.30360806977026,3.38162312019406,3.45963817061786,3.53765322104165,3.61566827146545,3.69368332188925,3.77169837231304,3.84971342273684,3.92772847316063,4.00574352358443,4.08375857400823,4.16177362443202,4.23978867485582,4.31780372527961,4.39581877570341,4.4738338261272,4.551848876551,4.6298639269748,4.70787897739859,4.78589402782239,4.86390907824619,4.94192412866998,5.01993917909378,5.09795422951757,5.17596927994137,5.25398433036517,5.33199938078896,5.41001443121276,5.48802948163655,5.56604453206035,5.64405958248414,5.72207463290794,5.80008968333174,5.87810473375553,5.95611978417933,6.03413483460313,6.11214988502692,6.19016493545072,6.26817998587451,6.34619503629831,6.42421008672211,6.5022251371459,6.5802401875697,6.65825523799349,6.73627028841729,6.81428533884108,6.89230038926488,6.97031543968868,7.04833049011247,7.12634554053627,7.20436059096007,7.28237564138386,7.36039069180766,7.43840574223145],[1.73403689341942,1.81205194384322,1.89006699426701,1.96808204469081,2.0460970951146,2.1241121455384,2.2021271959622,2.28014224638599,2.35815729680979,2.43617234723359,2.51418739765738,2.59220244808118,2.67021749850497,2.74823254892877,2.82624759935257,2.90426264977636,2.98227770020016,3.06029275062395,3.13830780104775,3.21632285147154,3.29433790189534,3.37235295231914,3.45036800274293,3.52838305316673,3.60639810359053,3.68441315401432,3.76242820443812,3.84044325486191,3.91845830528571,3.99647335570951,4.0744884061333,4.1525034565571,4.23051850698089,4.30853355740469,4.38654860782848,4.46456365825228,4.54257870867608,4.62059375909987,4.69860880952367,4.77662385994747,4.85463891037126,4.93265396079506,5.01066901121885,5.08868406164265,5.16669911206645,5.24471416249024,5.32272921291404,5.40074426333783,5.47875931376163,5.55677436418542,5.63478941460922,5.71280446503302,5.79081951545681,5.86883456588061,5.94684961630441,6.0248646667282,6.102879717152,6.18089476757579,6.25890981799959,6.33692486842339,6.41493991884718,6.49295496927098,6.57097001969477,6.64898507011857,6.72700012054236,6.80501517096616,6.88303022138996,6.96104527181375,7.03906032223755,7.11707537266135,7.19509042308514,7.27310547350894,7.35112052393273],[1.6467516751207,1.7247667255445,1.80278177596829,1.88079682639209,1.95881187681588,2.03682692723968,2.11484197766348,2.19285702808727,2.27087207851107,2.34888712893486,2.42690217935866,2.50491722978246,2.58293228020625,2.66094733063005,2.73896238105385,2.81697743147764,2.89499248190144,2.97300753232523,3.05102258274903,3.12903763317282,3.20705268359662,3.28506773402042,3.36308278444421,3.44109783486801,3.51911288529181,3.5971279357156,3.6751429861394,3.75315803656319,3.83117308698699,3.90918813741079,3.98720318783458,4.06521823825838,4.14323328868217,4.22124833910597,4.29926338952976,4.37727843995356,4.45529349037736,4.53330854080115,4.61132359122495,4.68933864164875,4.76735369207254,4.84536874249634,4.92338379292013,5.00139884334393,5.07941389376773,5.15742894419152,5.23544399461532,5.31345904503911,5.39147409546291,5.4694891458867,5.5475041963105,5.6255192467343,5.70353429715809,5.78154934758189,5.85956439800569,5.93757944842948,6.01559449885328,6.09360954927707,6.17162459970087,6.24963965012467,6.32765470054846,6.40566975097226,6.48368480139605,6.56169985181985,6.63971490224364,6.71772995266744,6.79574500309124,6.87376005351503,6.95177510393883,7.02979015436263,7.10780520478642,7.18582025521022,7.26383530563401],[1.55946645682198,1.63748150724578,1.71549655766957,1.79351160809337,1.87152665851716,1.94954170894096,2.02755675936476,2.10557180978855,2.18358686021235,2.26160191063614,2.33961696105994,2.41763201148374,2.49564706190753,2.57366211233133,2.65167716275513,2.72969221317892,2.80770726360272,2.88572231402651,2.96373736445031,3.0417524148741,3.1197674652979,3.1977825157217,3.27579756614549,3.35381261656929,3.43182766699309,3.50984271741688,3.58785776784068,3.66587281826447,3.74388786868827,3.82190291911207,3.89991796953586,3.97793301995966,4.05594807038345,4.13396312080725,4.21197817123104,4.28999322165484,4.36800827207864,4.44602332250243,4.52403837292623,4.60205342335003,4.68006847377382,4.75808352419762,4.83609857462141,4.91411362504521,4.99212867546901,5.0701437258928,5.1481587763166,5.22617382674039,5.30418887716419,5.38220392758798,5.46021897801178,5.53823402843558,5.61624907885937,5.69426412928317,5.77227917970697,5.85029423013076,5.92830928055456,6.00632433097835,6.08433938140215,6.16235443182595,6.24036948224974,6.31838453267354,6.39639958309733,6.47441463352113,6.55242968394492,6.63044473436872,6.70845978479252,6.78647483521631,6.86448988564011,6.94250493606391,7.0205199864877,7.0985350369115,7.17655008733529],[1.47218123852326,1.55019628894706,1.62821133937085,1.70622638979465,1.78424144021844,1.86225649064224,1.94027154106604,2.01828659148983,2.09630164191363,2.17431669233742,2.25233174276122,2.33034679318502,2.40836184360881,2.48637689403261,2.56439194445641,2.6424069948802,2.720422045304,2.79843709572779,2.87645214615159,2.95446719657538,3.03248224699918,3.11049729742298,3.18851234784677,3.26652739827057,3.34454244869437,3.42255749911816,3.50057254954196,3.57858759996575,3.65660265038955,3.73461770081335,3.81263275123714,3.89064780166094,3.96866285208473,4.04667790250853,4.12469295293232,4.20270800335612,4.28072305377992,4.35873810420371,4.43675315462751,4.51476820505131,4.5927832554751,4.6707983058989,4.74881335632269,4.82682840674649,4.90484345717029,4.98285850759408,5.06087355801788,5.13888860844167,5.21690365886547,5.29491870928926,5.37293375971306,5.45094881013686,5.52896386056065,5.60697891098445,5.68499396140825,5.76300901183204,5.84102406225584,5.91903911267963,5.99705416310343,6.07506921352723,6.15308426395102,6.23109931437482,6.30911436479861,6.38712941522241,6.4651444656462,6.54315951607,6.6211745664938,6.69918961691759,6.77720466734139,6.85521971776519,6.93323476818898,7.01124981861278,7.08926486903657],[1.38489602022454,1.46291107064834,1.54092612107213,1.61894117149593,1.69695622191973,1.77497127234352,1.85298632276732,1.93100137319111,2.00901642361491,2.08703147403871,2.1650465244625,2.2430615748863,2.32107662531009,2.39909167573389,2.47710672615769,2.55512177658148,2.63313682700528,2.71115187742907,2.78916692785287,2.86718197827667,2.94519702870046,3.02321207912426,3.10122712954805,3.17924217997185,3.25725723039565,3.33527228081944,3.41328733124324,3.49130238166703,3.56931743209083,3.64733248251463,3.72534753293842,3.80336258336222,3.88137763378601,3.95939268420981,4.03740773463361,4.1154227850574,4.1934378354812,4.27145288590499,4.34946793632879,4.42748298675259,4.50549803717638,4.58351308760018,4.66152813802398,4.73954318844777,4.81755823887157,4.89557328929536,4.97358833971916,5.05160339014295,5.12961844056675,5.20763349099055,5.28564854141434,5.36366359183814,5.44167864226193,5.51969369268573,5.59770874310953,5.67572379353332,5.75373884395712,5.83175389438092,5.90976894480471,5.98778399522851,6.0657990456523,6.1438140960761,6.22182914649989,6.29984419692369,6.37785924734749,6.45587429777128,6.53388934819508,6.61190439861887,6.68991944904267,6.76793449946647,6.84594954989026,6.92396460031406,7.00197965073786],[1.29761080192582,1.37562585234962,1.45364090277341,1.53165595319721,1.609671003621,1.6876860540448,1.7657011044686,1.84371615489239,1.92173120531619,1.99974625573998,2.07776130616378,2.15577635658758,2.23379140701137,2.31180645743517,2.38982150785897,2.46783655828276,2.54585160870656,2.62386665913035,2.70188170955415,2.77989675997794,2.85791181040174,2.93592686082554,3.01394191124933,3.09195696167313,3.16997201209693,3.24798706252072,3.32600211294452,3.40401716336831,3.48203221379211,3.56004726421591,3.6380623146397,3.7160773650635,3.79409241548729,3.87210746591109,3.95012251633488,4.02813756675868,4.10615261718248,4.18416766760627,4.26218271803007,4.34019776845387,4.41821281887766,4.49622786930146,4.57424291972525,4.65225797014905,4.73027302057285,4.80828807099664,4.88630312142044,4.96431817184423,5.04233322226803,5.12034827269182,5.19836332311562,5.27637837353942,5.35439342396321,5.43240847438701,5.51042352481081,5.5884385752346,5.6664536256584,5.74446867608219,5.82248372650599,5.90049877692979,5.97851382735358,6.05652887777738,6.13454392820117,6.21255897862497,6.29057402904876,6.36858907947256,6.44660412989636,6.52461918032015,6.60263423074395,6.68064928116775,6.75866433159154,6.83667938201534,6.91469443243913],[1.2103255836271,1.2883406340509,1.36635568447469,1.44437073489849,1.52238578532228,1.60040083574608,1.67841588616988,1.75643093659367,1.83444598701747,1.91246103744126,1.99047608786506,2.06849113828886,2.14650618871265,2.22452123913645,2.30253628956025,2.38055133998404,2.45856639040784,2.53658144083163,2.61459649125543,2.69261154167922,2.77062659210302,2.84864164252682,2.92665669295061,3.00467174337441,3.08268679379821,3.160701844222,3.2387168946458,3.31673194506959,3.39474699549339,3.47276204591719,3.55077709634098,3.62879214676478,3.70680719718857,3.78482224761237,3.86283729803616,3.94085234845996,4.01886739888376,4.09688244930755,4.17489749973135,4.25291255015515,4.33092760057894,4.40894265100274,4.48695770142653,4.56497275185033,4.64298780227413,4.72100285269792,4.79901790312172,4.87703295354551,4.95504800396931,5.0330630543931,5.1110781048169,5.1890931552407,5.26710820566449,5.34512325608829,5.42313830651209,5.50115335693588,5.57916840735968,5.65718345778347,5.73519850820727,5.81321355863107,5.89122860905486,5.96924365947866,6.04725870990245,6.12527376032625,6.20328881075004,6.28130386117384,6.35931891159764,6.43733396202143,6.51534901244523,6.59336406286903,6.67137911329282,6.74939416371662,6.82740921414041],[1.12304036532838,1.20105541575218,1.27907046617597,1.35708551659977,1.43510056702356,1.51311561744736,1.59113066787116,1.66914571829495,1.74716076871875,1.82517581914254,1.90319086956634,1.98120591999014,2.05922097041393,2.13723602083773,2.21525107126152,2.29326612168532,2.37128117210912,2.44929622253291,2.52731127295671,2.6053263233805,2.6833413738043,2.7613564242281,2.83937147465189,2.91738652507569,2.99540157549949,3.07341662592328,3.15143167634708,3.22944672677087,3.30746177719467,3.38547682761847,3.46349187804226,3.54150692846606,3.61952197888985,3.69753702931365,3.77555207973744,3.85356713016124,3.93158218058504,4.00959723100883,4.08761228143263,4.16562733185643,4.24364238228022,4.32165743270402,4.39967248312781,4.47768753355161,4.55570258397541,4.6337176343992,4.711732684823,4.78974773524679,4.86776278567059,4.94577783609438,5.02379288651818,5.10180793694198,5.17982298736577,5.25783803778957,5.33585308821337,5.41386813863716,5.49188318906096,5.56989823948475,5.64791328990855,5.72592834033235,5.80394339075614,5.88195844117994,5.95997349160373,6.03798854202753,6.11600359245132,6.19401864287512,6.27203369329892,6.35004874372271,6.42806379414651,6.50607884457031,6.5840938949941,6.6621089454179,6.74012399584169],[1.03575514702966,1.11377019745346,1.19178524787725,1.26980029830105,1.34781534872485,1.42583039914864,1.50384544957244,1.58186049999623,1.65987555042003,1.73789060084383,1.81590565126762,1.89392070169142,1.97193575211521,2.04995080253901,2.12796585296281,2.2059809033866,2.2839959538104,2.36201100423419,2.44002605465799,2.51804110508179,2.59605615550558,2.67407120592938,2.75208625635317,2.83010130677697,2.90811635720077,2.98613140762456,3.06414645804836,3.14216150847215,3.22017655889595,3.29819160931975,3.37620665974354,3.45422171016734,3.53223676059113,3.61025181101493,3.68826686143873,3.76628191186252,3.84429696228632,3.92231201271011,4.00032706313391,4.07834211355771,4.1563571639815,4.2343722144053,4.31238726482909,4.39040231525289,4.46841736567669,4.54643241610048,4.62444746652428,4.70246251694807,4.78047756737187,4.85849261779567,4.93650766821946,5.01452271864326,5.09253776906705,5.17055281949085,5.24856786991465,5.32658292033844,5.40459797076224,5.48261302118603,5.56062807160983,5.63864312203363,5.71665817245742,5.79467322288122,5.87268827330501,5.95070332372881,6.02871837415261,6.1067334245764,6.1847484750002,6.26276352542399,6.34077857584779,6.41879362627159,6.49680867669538,6.57482372711918,6.65283877754297],[0.948469928730941,1.02648497915474,1.10450002957853,1.18251508000233,1.26053013042613,1.33854518084992,1.41656023127372,1.49457528169751,1.57259033212131,1.65060538254511,1.7286204329689,1.8066354833927,1.88465053381649,1.96266558424029,2.04068063466409,2.11869568508788,2.19671073551168,2.27472578593547,2.35274083635927,2.43075588678307,2.50877093720686,2.58678598763066,2.66480103805445,2.74281608847825,2.82083113890205,2.89884618932584,2.97686123974964,3.05487629017343,3.13289134059723,3.21090639102103,3.28892144144482,3.36693649186862,3.44495154229241,3.52296659271621,3.60098164314001,3.6789966935638,3.7570117439876,3.83502679441139,3.91304184483519,3.99105689525899,4.06907194568278,4.14708699610658,4.22510204653037,4.30311709695417,4.38113214737797,4.45914719780176,4.53716224822556,4.61517729864935,4.69319234907315,4.77120739949695,4.84922244992074,4.92723750034454,5.00525255076833,5.08326760119213,5.16128265161593,5.23929770203972,5.31731275246352,5.39532780288731,5.47334285331111,5.55135790373491,5.6293729541587,5.7073880045825,5.78540305500629,5.86341810543009,5.94143315585389,6.01944820627768,6.09746325670148,6.17547830712527,6.25349335754907,6.33150840797287,6.40952345839666,6.48753850882046,6.56555355924425],[0.861184710432221,0.939199760856017,1.01721481127981,1.09522986170361,1.17324491212741,1.2512599625512,1.329275012975,1.40729006339879,1.48530511382259,1.56332016424639,1.64133521467018,1.71935026509398,1.79736531551777,1.87538036594157,1.95339541636537,2.03141046678916,2.10942551721296,2.18744056763675,2.26545561806055,2.34347066848435,2.42148571890814,2.49950076933194,2.57751581975573,2.65553087017953,2.73354592060333,2.81156097102712,2.88957602145092,2.96759107187471,3.04560612229851,3.12362117272231,3.2016362231461,3.2796512735699,3.35766632399369,3.43568137441749,3.51369642484129,3.59171147526508,3.66972652568888,3.74774157611267,3.82575662653647,3.90377167696027,3.98178672738406,4.05980177780786,4.13781682823165,4.21583187865545,4.29384692907925,4.37186197950304,4.44987702992684,4.52789208035063,4.60590713077443,4.68392218119823,4.76193723162202,4.83995228204582,4.91796733246961,4.99598238289341,5.07399743331721,5.152012483741,5.2300275341648,5.30804258458859,5.38605763501239,5.46407268543619,5.54208773585998,5.62010278628378,5.69811783670757,5.77613288713137,5.85414793755517,5.93216298797896,6.01017803840276,6.08819308882655,6.16620813925035,6.24422318967415,6.32223824009794,6.40025329052174,6.47826834094553],[0.773899492133501,0.851914542557297,0.929929592981092,1.00794464340489,1.08595969382869,1.16397474425248,1.24198979467628,1.32000484510007,1.39801989552387,1.47603494594767,1.55404999637146,1.63206504679526,1.71008009721905,1.78809514764285,1.86611019806665,1.94412524849044,2.02214029891424,2.10015534933803,2.17817039976183,2.25618545018563,2.33420050060942,2.41221555103322,2.49023060145701,2.56824565188081,2.64626070230461,2.7242757527284,2.8022908031522,2.88030585357599,2.95832090399979,3.03633595442359,3.11435100484738,3.19236605527118,3.27038110569497,3.34839615611877,3.42641120654257,3.50442625696636,3.58244130739016,3.66045635781395,3.73847140823775,3.81648645866155,3.89450150908534,3.97251655950914,4.05053160993293,4.12854666035673,4.20656171078053,4.28457676120432,4.36259181162812,4.44060686205191,4.51862191247571,4.59663696289951,4.6746520133233,4.7526670637471,4.83068211417089,4.90869716459469,4.98671221501849,5.06472726544228,5.14274231586608,5.22075736628987,5.29877241671367,5.37678746713747,5.45480251756126,5.53281756798506,5.61083261840885,5.68884766883265,5.76686271925645,5.84487776968024,5.92289282010404,6.00090787052783,6.07892292095163,6.15693797137543,6.23495302179922,6.31296807222302,6.39098312264681],[0.686614273834781,0.764629324258577,0.842644374682372,0.920659425106169,0.998674475529965,1.07668952595376,1.15470457637756,1.23271962680135,1.31073467722515,1.38874972764895,1.46676477807274,1.54477982849654,1.62279487892033,1.70080992934413,1.77882497976793,1.85684003019172,1.93485508061552,2.01287013103931,2.09088518146311,2.16890023188691,2.2469152823107,2.3249303327345,2.40294538315829,2.48096043358209,2.55897548400589,2.63699053442968,2.71500558485348,2.79302063527727,2.87103568570107,2.94905073612487,3.02706578654866,3.10508083697246,3.18309588739625,3.26111093782005,3.33912598824385,3.41714103866764,3.49515608909144,3.57317113951523,3.65118618993903,3.72920124036283,3.80721629078662,3.88523134121042,3.96324639163421,4.04126144205801,4.11927649248181,4.1972915429056,4.2753065933294,4.35332164375319,4.43133669417699,4.50935174460079,4.58736679502458,4.66538184544838,4.74339689587217,4.82141194629597,4.89942699671977,4.97744204714356,5.05545709756736,5.13347214799115,5.21148719841495,5.28950224883875,5.36751729926254,5.44553234968634,5.52354740011013,5.60156245053393,5.67957750095773,5.75759255138152,5.83560760180532,5.91362265222911,5.99163770265291,6.06965275307671,6.1476678035005,6.2256828539243,6.30369790434809],[0.599329055536062,0.677344105959858,0.755359156383653,0.83337420680745,0.911389257231246,0.989404307655042,1.06741935807884,1.14543440850263,1.22344945892643,1.30146450935023,1.37947955977402,1.45749461019782,1.53550966062161,1.61352471104541,1.69153976146921,1.769554811893,1.8475698623168,1.92558491274059,2.00359996316439,2.08161501358819,2.15963006401198,2.23764511443578,2.31566016485957,2.39367521528337,2.47169026570717,2.54970531613096,2.62772036655476,2.70573541697856,2.78375046740235,2.86176551782615,2.93978056824994,3.01779561867374,3.09581066909753,3.17382571952133,3.25184076994513,3.32985582036892,3.40787087079272,3.48588592121651,3.56390097164031,3.64191602206411,3.7199310724879,3.7979461229117,3.8759611733355,3.95397622375929,4.03199127418309,4.11000632460688,4.18802137503068,4.26603642545447,4.34405147587827,4.42206652630207,4.50008157672586,4.57809662714966,4.65611167757345,4.73412672799725,4.81214177842105,4.89015682884484,4.96817187926864,5.04618692969244,5.12420198011623,5.20221703054003,5.28023208096382,5.35824713138762,5.43626218181141,5.51427723223521,5.59229228265901,5.6703073330828,5.7483223835066,5.82633743393039,5.90435248435419,5.98236753477799,6.06038258520178,6.13839763562558,6.21641268604938],[0.512043837237342,0.590058887661137,0.668073938084933,0.74608898850873,0.824104038932526,0.902119089356322,0.980134139780118,1.05814919020391,1.13616424062771,1.21417929105151,1.2921943414753,1.3702093918991,1.44822444232289,1.52623949274669,1.60425454317049,1.68226959359428,1.76028464401808,1.83829969444187,1.91631474486567,1.99432979528947,2.07234484571326,2.15035989613706,2.22837494656085,2.30638999698465,2.38440504740845,2.46242009783224,2.54043514825604,2.61845019867984,2.69646524910363,2.77448029952743,2.85249534995122,2.93051040037502,3.00852545079881,3.08654050122261,3.16455555164641,3.2425706020702,3.320585652494,3.39860070291779,3.47661575334159,3.55463080376539,3.63264585418918,3.71066090461298,3.78867595503678,3.86669100546057,3.94470605588437,4.02272110630816,4.10073615673196,4.17875120715575,4.25676625757955,4.33478130800335,4.41279635842714,4.49081140885094,4.56882645927473,4.64684150969853,4.72485656012233,4.80287161054612,4.88088666096992,4.95890171139372,5.03691676181751,5.11493181224131,5.1929468626651,5.2709619130889,5.34897696351269,5.42699201393649,5.50500706436029,5.58302211478408,5.66103716520788,5.73905221563167,5.81706726605547,5.89508231647927,5.97309736690306,6.05111241732686,6.12912746775066],[0.424758618938622,0.502773669362417,0.580788719786213,0.65880377021001,0.736818820633806,0.814833871057602,0.892848921481398,0.970863971905193,1.04887902232899,1.12689407275279,1.20490912317658,1.28292417360038,1.36093922402417,1.43895427444797,1.51696932487177,1.59498437529556,1.67299942571936,1.75101447614315,1.82902952656695,1.90704457699075,1.98505962741454,2.06307467783834,2.14108972826213,2.21910477868593,2.29711982910973,2.37513487953352,2.45314992995732,2.53116498038112,2.60918003080491,2.68719508122871,2.7652101316525,2.8432251820763,2.92124023250009,2.99925528292389,3.07727033334769,3.15528538377148,3.23330043419528,3.31131548461907,3.38933053504287,3.46734558546667,3.54536063589046,3.62337568631426,3.70139073673806,3.77940578716185,3.85742083758565,3.93543588800944,4.01345093843324,4.09146598885703,4.16948103928083,4.24749608970463,4.32551114012842,4.40352619055222,4.48154124097601,4.55955629139981,4.63757134182361,4.7155863922474,4.7936014426712,4.871616493095,4.94963154351879,5.02764659394259,5.10566164436638,5.18367669479018,5.26169174521397,5.33970679563777,5.41772184606157,5.49573689648536,5.57375194690916,5.65176699733295,5.72978204775675,5.80779709818055,5.88581214860434,5.96382719902814,6.04184224945194],[0.337473400639901,0.415488451063696,0.493503501487492,0.571518551911289,0.649533602335085,0.727548652758881,0.805563703182677,0.883578753606472,0.96159380403027,1.03960885445407,1.11762390487786,1.19563895530166,1.27365400572545,1.35166905614925,1.42968410657305,1.50769915699684,1.58571420742064,1.66372925784443,1.74174430826823,1.81975935869202,1.89777440911582,1.97578945953962,2.05380450996341,2.13181956038721,2.20983461081101,2.2878496612348,2.3658647116586,2.44387976208239,2.52189481250619,2.59990986292999,2.67792491335378,2.75593996377758,2.83395501420137,2.91197006462517,2.98998511504896,3.06800016547276,3.14601521589656,3.22403026632035,3.30204531674415,3.38006036716795,3.45807541759174,3.53609046801554,3.61410551843933,3.69212056886313,3.77013561928693,3.84815066971072,3.92616572013452,4.00418077055831,4.08219582098211,4.1602108714059,4.2382259218297,4.3162409722535,4.39425602267729,4.47227107310109,4.55028612352489,4.62830117394868,4.70631622437248,4.78433127479627,4.86234632522007,4.94036137564387,5.01837642606766,5.09639147649146,5.17440652691525,5.25242157733905,5.33043662776284,5.40845167818664,5.48646672861044,5.56448177903423,5.64249682945803,5.72051187988183,5.79852693030562,5.87654198072942,5.95455703115321],[0.250188182341182,0.328203232764977,0.406218283188773,0.48423333361257,0.562248384036366,0.640263434460162,0.718278484883958,0.796293535307753,0.87430858573155,0.952323636155346,1.03033868657914,1.10835373700294,1.18636878742673,1.26438383785053,1.34239888827433,1.42041393869812,1.49842898912192,1.57644403954571,1.65445908996951,1.73247414039331,1.8104891908171,1.8885042412409,1.96651929166469,2.04453434208849,2.12254939251229,2.20056444293608,2.27857949335988,2.35659454378368,2.43460959420747,2.51262464463127,2.59063969505506,2.66865474547886,2.74666979590265,2.82468484632645,2.90269989675025,2.98071494717404,3.05872999759784,3.13674504802163,3.21476009844543,3.29277514886923,3.37079019929302,3.44880524971682,3.52682030014062,3.60483535056441,3.68285040098821,3.760865451412,3.8388805018358,3.91689555225959,3.99491060268339,4.07292565310719,4.15094070353098,4.22895575395478,4.30697080437857,4.38498585480237,4.46300090522617,4.54101595564996,4.61903100607376,4.69704605649756,4.77506110692135,4.85307615734515,4.93109120776894,5.00910625819274,5.08712130861653,5.16513635904033,5.24315140946413,5.32116645988792,5.39918151031172,5.47719656073551,5.55521161115931,5.63322666158311,5.7112417120069,5.7892567624307,5.8672718128545],[0.162902964042462,0.240918014466257,0.318933064890053,0.39694811531385,0.474963165737646,0.552978216161442,0.630993266585238,0.709008317009033,0.78702336743283,0.865038417856626,0.943053468280421,1.02106851870422,1.09908356912801,1.17709861955181,1.25511366997561,1.3331287203994,1.4111437708232,1.48915882124699,1.56717387167079,1.64518892209459,1.72320397251838,1.80121902294218,1.87923407336597,1.95724912378977,2.03526417421357,2.11327922463736,2.19129427506116,2.26930932548496,2.34732437590875,2.42533942633255,2.50335447675634,2.58136952718014,2.65938457760393,2.73739962802773,2.81541467845153,2.89342972887532,2.97144477929912,3.04945982972291,3.12747488014671,3.20548993057051,3.2835049809943,3.3615200314181,3.4395350818419,3.51755013226569,3.59556518268949,3.67358023311328,3.75159528353708,3.82961033396087,3.90762538438467,3.98564043480847,4.06365548523226,4.14167053565606,4.21968558607985,4.29770063650365,4.37571568692745,4.45373073735124,4.53174578777504,4.60976083819884,4.68777588862263,4.76579093904643,4.84380598947022,4.92182103989402,4.99983609031781,5.07785114074161,5.15586619116541,5.2338812415892,5.311896292013,5.38991134243679,5.46792639286059,5.54594144328439,5.62395649370818,5.70197154413198,5.77998659455578],[0.0756177457437426,0.153632796167538,0.231647846591334,0.309662897015131,0.387677947438926,0.465692997862723,0.543708048286518,0.621723098710314,0.699738149134111,0.777753199557907,0.855768249981702,0.933783300405499,1.0117983508293,1.08981340125309,1.16782845167689,1.24584350210068,1.32385855252448,1.40187360294828,1.47988865337207,1.55790370379587,1.63591875421966,1.71393380464346,1.79194885506725,1.86996390549105,1.94797895591485,2.02599400633864,2.10400905676244,2.18202410718624,2.26003915761003,2.33805420803383,2.41606925845762,2.49408430888142,2.57209935930522,2.65011440972901,2.72812946015281,2.8061445105766,2.8841595610004,2.96217461142419,3.04018966184799,3.11820471227179,3.19621976269558,3.27423481311938,3.35224986354318,3.43026491396697,3.50827996439077,3.58629501481456,3.66431006523836,3.74232511566216,3.82034016608595,3.89835521650975,3.97637026693354,4.05438531735734,4.13240036778113,4.21041541820493,4.28843046862873,4.36644551905252,4.44446056947632,4.52247561990012,4.60049067032391,4.67850572074771,4.7565207711715,4.8345358215953,4.9125508720191,4.99056592244289,5.06858097286669,5.14659602329048,5.22461107371428,5.30262612413807,5.38064117456187,5.45865622498567,5.53667127540946,5.61468632583326,5.69270137625706],[-0.0116674725549784,0.0663475778688172,0.144362628292613,0.22237767871641,0.300392729140206,0.378407779564002,0.456422829987797,0.534437880411593,0.61245293083539,0.690467981259186,0.768483031682981,0.846498082106778,0.924513132530574,1.00252818295437,1.08054323337817,1.15855828380196,1.23657333422576,1.31458838464955,1.39260343507335,1.47061848549715,1.54863353592094,1.62664858634474,1.70466363676853,1.78267868719233,1.86069373761613,1.93870878803992,2.01672383846372,2.09473888888752,2.17275393931131,2.25076898973511,2.3287840401589,2.4067990905827,2.48481414100649,2.56282919143029,2.64084424185409,2.71885929227788,2.79687434270168,2.87488939312547,2.95290444354927,3.03091949397307,3.10893454439686,3.18694959482066,3.26496464524446,3.34297969566825,3.42099474609205,3.49900979651584,3.57702484693964,3.65503989736343,3.73305494778723,3.81106999821103,3.88908504863482,3.96710009905862,4.04511514948241,4.12313019990621,4.20114525033001,4.2791603007538,4.3571753511776,4.4351904016014,4.51320545202519,4.59122050244899,4.66923555287278,4.74725060329658,4.82526565372037,4.90328070414417,4.98129575456797,5.05931080499176,5.13732585541556,5.21534090583935,5.29335595626315,5.37137100668695,5.44938605711074,5.52740110753454,5.60541615795834],[-0.0989526908536984,-0.0209376404299029,0.0570774099938927,0.13509246041769,0.213107510841485,0.291122561265282,0.369137611689077,0.447152662112873,0.52516771253667,0.603182762960466,0.681197813384261,0.759212863808058,0.837227914231854,0.915242964655651,0.993258015079446,1.07127306550324,1.14928811592704,1.22730316635083,1.30531821677463,1.38333326719843,1.46134831762222,1.53936336804602,1.61737841846981,1.69539346889361,1.77340851931741,1.8514235697412,1.929438620165,2.0074536705888,2.08546872101259,2.16348377143639,2.24149882186018,2.31951387228398,2.39752892270777,2.47554397313157,2.55355902355537,2.63157407397916,2.70958912440296,2.78760417482675,2.86561922525055,2.94363427567435,3.02164932609814,3.09966437652194,3.17767942694574,3.25569447736953,3.33370952779333,3.41172457821712,3.48973962864092,3.56775467906471,3.64576972948851,3.72378477991231,3.8017998303361,3.8798148807599,3.95782993118369,4.03584498160749,4.11386003203129,4.19187508245508,4.26989013287888,4.34790518330268,4.42592023372647,4.50393528415027,4.58195033457406,4.65996538499786,4.73798043542165,4.81599548584545,4.89401053626925,4.97202558669304,5.05004063711684,5.12805568754063,5.20607073796443,5.28408578838823,5.36210083881202,5.44011588923582,5.51813093965962],[-0.186237909152418,-0.108222858728622,-0.0302078083048265,0.0478072421189708,0.125822292542766,0.203837342966563,0.281852393390358,0.359867443814154,0.437882494237951,0.515897544661747,0.593912595085542,0.671927645509339,0.749942695933135,0.827957746356931,0.905972796780727,0.983987847204522,1.06200289762832,1.14001794805212,1.21803299847591,1.29604804889971,1.3740630993235,1.4520781497473,1.53009320017109,1.60810825059489,1.68612330101869,1.76413835144248,1.84215340186628,1.92016845229008,1.99818350271387,2.07619855313767,2.15421360356146,2.23222865398526,2.31024370440906,2.38825875483285,2.46627380525665,2.54428885568044,2.62230390610424,2.70031895652803,2.77833400695183,2.85634905737563,2.93436410779942,3.01237915822322,3.09039420864702,3.16840925907081,3.24642430949461,3.3244393599184,3.4024544103422,3.480469460766,3.55848451118979,3.63649956161359,3.71451461203738,3.79252966246118,3.87054471288497,3.94855976330877,4.02657481373257,4.10458986415636,4.18260491458016,4.26061996500396,4.33863501542775,4.41665006585155,4.49466511627534,4.57268016669914,4.65069521712294,4.72871026754673,4.80672531797053,4.88474036839432,4.96275541881812,5.04077046924191,5.11878551966571,5.19680057008951,5.2748156205133,5.3528306709371,5.4308457213609],[-0.273523127451138,-0.195508077027342,-0.117493026603547,-0.0394779761797492,0.0385370742440463,0.116552124667843,0.194567175091638,0.272582225515434,0.350597275939231,0.428612326363027,0.506627376786822,0.584642427210619,0.662657477634415,0.740672528058211,0.818687578482007,0.896702628905802,0.974717679329598,1.0527327297534,1.13074778017719,1.20876283060099,1.28677788102478,1.36479293144858,1.44280798187237,1.52082303229617,1.59883808271997,1.67685313314376,1.75486818356756,1.83288323399136,1.91089828441515,1.98891333483895,2.06692838526274,2.14494343568654,2.22295848611034,2.30097353653413,2.37898858695793,2.45700363738172,2.53501868780552,2.61303373822931,2.69104878865311,2.76906383907691,2.8470788895007,2.9250939399245,3.0031089903483,3.08112404077209,3.15913909119589,3.23715414161968,3.31516919204348,3.39318424246728,3.47119929289107,3.54921434331487,3.62722939373866,3.70524444416246,3.78325949458625,3.86127454501005,3.93928959543385,4.01730464585764,4.09531969628144,4.17333474670524,4.25134979712903,4.32936484755283,4.40737989797662,4.48539494840042,4.56340999882422,4.64142504924801,4.71944009967181,4.7974551500956,4.8754702005194,4.95348525094319,5.03150030136699,5.10951535179079,5.18753040221458,5.26554545263838,5.34356050306218],[-0.360808345749859,-0.282793295326063,-0.204778244902267,-0.12676319447847,-0.0487481440546746,0.0292669063691218,0.107281956792917,0.185297007216713,0.26331205764051,0.341327108064306,0.419342158488101,0.497357208911898,0.575372259335694,0.65338730975949,0.731402360183286,0.809417410607082,0.887432461030877,0.965447511454674,1.04346256187847,1.12147761230227,1.19949266272606,1.27750771314986,1.35552276357365,1.43353781399745,1.51155286442125,1.58956791484504,1.66758296526884,1.74559801569263,1.82361306611643,1.90162811654023,1.97964316696402,2.05765821738782,2.13567326781161,2.21368831823541,2.29170336865921,2.369718419083,2.4477334695068,2.52574851993059,2.60376357035439,2.68177862077819,2.75979367120198,2.83780872162578,2.91582377204957,2.99383882247337,3.07185387289717,3.14986892332096,3.22788397374476,3.30589902416855,3.38391407459235,3.46192912501615,3.53994417543994,3.61795922586374,3.69597427628753,3.77398932671133,3.85200437713513,3.93001942755892,4.00803447798272,4.08604952840652,4.16406457883031,4.24207962925411,4.3200946796779,4.3981097301017,4.47612478052549,4.55413983094929,4.63215488137309,4.71016993179688,4.78818498222068,4.86620003264447,4.94421508306827,5.02223013349207,5.10024518391586,5.17826023433966,5.25627528476346],[-0.448093564048577,-0.370078513624781,-0.292063463200986,-0.214048412777188,-0.136033362353393,-0.0580183119295965,0.019996738494199,0.0980117889179946,0.176026839341792,0.254041889765587,0.332056940189383,0.410071990613179,0.488087041036976,0.566102091460772,0.644117141884568,0.722132192308363,0.800147242732159,0.878162293155956,0.956177343579752,1.03419239400355,1.11220744442734,1.19022249485114,1.26823754527494,1.34625259569873,1.42426764612253,1.50228269654632,1.58029774697012,1.65831279739392,1.73632784781771,1.81434289824151,1.8923579486653,1.9703729990891,2.0483880495129,2.12640309993669,2.20441815036049,2.28243320078428,2.36044825120808,2.43846330163188,2.51647835205567,2.59449340247947,2.67250845290326,2.75052350332706,2.82853855375086,2.90655360417465,2.98456865459845,3.06258370502224,3.14059875544604,3.21861380586984,3.29662885629363,3.37464390671743,3.45265895714122,3.53067400756502,3.60868905798882,3.68670410841261,3.76471915883641,3.8427342092602,3.920749259684,3.9987643101078,4.07677936053159,4.15479441095539,4.23280946137918,4.31082451180298,4.38883956222678,4.46685461265057,4.54486966307437,4.62288471349816,4.70089976392196,4.77891481434576,4.85692986476955,4.93494491519335,5.01295996561714,5.09097501604094,5.16899006646474],[-0.535378782347298,-0.457363731923502,-0.379348681499707,-0.301333631075909,-0.223318580652114,-0.145303530228317,-0.0672884798045219,0.0107265706192736,0.0887416210430709,0.166756671466866,0.244771721890662,0.322786772314458,0.400801822738255,0.478816873162051,0.556831923585847,0.634846974009642,0.712862024433438,0.790877074857235,0.868892125281031,0.946907175704826,1.02492222612862,1.10293727655242,1.18095232697621,1.25896737740001,1.33698242782381,1.4149974782476,1.4930125286714,1.5710275790952,1.64904262951899,1.72705767994279,1.80507273036658,1.88308778079038,1.96110283121418,2.03911788163797,2.11713293206177,2.19514798248556,2.27316303290936,2.35117808333315,2.42919313375695,2.50720818418075,2.58522323460454,2.66323828502834,2.74125333545214,2.81926838587593,2.89728343629973,2.97529848672352,3.05331353714732,3.13132858757112,3.20934363799491,3.28735868841871,3.3653737388425,3.4433887892663,3.52140383969009,3.59941889011389,3.67743394053769,3.75544899096148,3.83346404138528,3.91147909180908,3.98949414223287,4.06750919265667,4.14552424308046,4.22353929350426,4.30155434392806,4.37956939435185,4.45758444477565,4.53559949519944,4.61361454562324,4.69162959604703,4.76964464647083,4.84765969689463,4.92567474731842,5.00368979774222,5.08170484816602],[-0.622664000646018,-0.544648950222222,-0.466633899798427,-0.388618849374629,-0.310603798950834,-0.232588748527037,-0.154573698103242,-0.0765586476794464,0.00145640274435088,0.0794714531681464,0.157486503591942,0.235501554015738,0.313516604439535,0.391531654863331,0.469546705287127,0.547561755710922,0.625576806134718,0.703591856558515,0.781606906982311,0.859621957406106,0.937637007829902,1.0156520582537,1.09366710867749,1.17168215910129,1.24969720952509,1.32771225994888,1.40572731037268,1.48374236079648,1.56175741122027,1.63977246164407,1.71778751206786,1.79580256249166,1.87381761291546,1.95183266333925,2.02984771376305,2.10786276418684,2.18587781461064,2.26389286503443,2.34190791545823,2.41992296588203,2.49793801630582,2.57595306672962,2.65396811715342,2.73198316757721,2.80999821800101,2.8880132684248,2.9660283188486,3.0440433692724,3.12205841969619,3.20007347011999,3.27808852054378,3.35610357096758,3.43411862139137,3.51213367181517,3.59014872223897,3.66816377266276,3.74617882308656,3.82419387351036,3.90220892393415,3.98022397435795,4.05823902478174,4.13625407520554,4.21426912562934,4.29228417605313,4.37029922647693,4.44831427690072,4.52632932732452,4.60434437774831,4.68235942817211,4.76037447859591,4.8383895290197,4.9164045794435,4.9944196298673],[-0.709949218944737,-0.631934168520941,-0.553919118097146,-0.475904067673349,-0.397889017249553,-0.319873966825757,-0.241858916401961,-0.163843865978166,-0.0858288155543683,-0.00781376513057275,0.0702012852932228,0.148216335717019,0.226231386140816,0.304246436564612,0.382261486988408,0.460276537412203,0.538291587835999,0.616306638259796,0.694321688683591,0.772336739107387,0.850351789531183,0.928366839954978,1.00638189037878,1.08439694080257,1.16241199122637,1.24042704165016,1.31844209207396,1.39645714249776,1.47447219292155,1.55248724334535,1.63050229376914,1.70851734419294,1.78653239461674,1.86454744504053,1.94256249546433,2.02057754588812,2.09859259631192,2.17660764673572,2.25462269715951,2.33263774758331,2.4106527980071,2.4886678484309,2.5666828988547,2.64469794927849,2.72271299970229,2.80072805012608,2.87874310054988,2.95675815097368,3.03477320139747,3.11278825182127,3.19080330224506,3.26881835266886,3.34683340309266,3.42484845351645,3.50286350394025,3.58087855436404,3.65889360478784,3.73690865521164,3.81492370563543,3.89293875605923,3.97095380648302,4.04896885690682,4.12698390733062,4.20499895775441,4.28301400817821,4.361029058602,4.4390441090258,4.5170591594496,4.59507420987339,4.67308926029719,4.75110431072098,4.82911936114478,4.90713441156858],[-0.797234437243459,-0.719219386819663,-0.641204336395868,-0.56318928597207,-0.485174235548275,-0.407159185124478,-0.329144134700683,-0.251129084276887,-0.17311403385309,-0.0950989834292946,-0.017083933005499,0.0609311174182974,0.138946167842094,0.21696121826589,0.294976268689686,0.372991319113481,0.451006369537277,0.529021419961074,0.60703647038487,0.685051520808665,0.763066571232461,0.841081621656256,0.919096672080054,0.997111722503849,1.07512677292765,1.15314182335144,1.23115687377524,1.30917192419903,1.38718697462283,1.46520202504663,1.54321707547042,1.62123212589422,1.69924717631801,1.77726222674181,1.85527727716561,1.9332923275894,2.0113073780132,2.08932242843699,2.16733747886079,2.24535252928459,2.32336757970838,2.40138263013218,2.47939768055597,2.55741273097977,2.63542778140357,2.71344283182736,2.79145788225116,2.86947293267495,2.94748798309875,3.02550303352255,3.10351808394634,3.18153313437014,3.25954818479393,3.33756323521773,3.41557828564153,3.49359333606532,3.57160838648912,3.64962343691291,3.72763848733671,3.80565353776051,3.8836685881843,3.9616836386081,4.03969868903189,4.11771373945569,4.19572878987949,4.27374384030328,4.35175889072708,4.42977394115087,4.50778899157467,4.58580404199847,4.66381909242226,4.74183414284606,4.81984919326985],[-0.884519655542176,-0.806504605118381,-0.728489554694585,-0.650474504270788,-0.572459453846992,-0.494444403423196,-0.4164293529994,-0.338414302575605,-0.260399252151807,-0.182384201728012,-0.104369151304216,-0.02635410088042,0.0516609495433764,0.129675999967173,0.207691050390968,0.285706100814764,0.363721151238559,0.441736201662357,0.519751252086152,0.597766302509948,0.675781352933743,0.753796403357539,0.831811453781336,0.909826504205132,0.987841554628929,1.06585660505272,1.14387165547652,1.22188670590032,1.29990175632411,1.37791680674791,1.4559318571717,1.5339469075955,1.6119619580193,1.68997700844309,1.76799205886689,1.84600710929068,1.92402215971448,2.00203721013828,2.08005226056207,2.15806731098587,2.23608236140966,2.31409741183346,2.39211246225726,2.47012751268105,2.54814256310485,2.62615761352864,2.70417266395244,2.78218771437624,2.86020276480003,2.93821781522383,3.01623286564762,3.09424791607142,3.17226296649522,3.25027801691901,3.32829306734281,3.4063081177666,3.4843231681904,3.5623382186142,3.64035326903799,3.71836831946179,3.79638336988558,3.87439842030938,3.95241347073318,4.03042852115697,4.10844357158077,4.18645862200456,4.26447367242836,4.34248872285216,4.42050377327595,4.49851882369975,4.57653387412354,4.65454892454734,4.73256397497114],[-0.971804873840898,-0.893789823417102,-0.815774772993307,-0.73775972256951,-0.659744672145714,-0.581729621721918,-0.503714571298122,-0.425699520874327,-0.347684470450529,-0.269669420026734,-0.191654369602938,-0.113639319179142,-0.0356242687553454,0.042390781668451,0.120405832092247,0.198420882516042,0.276435932939838,0.354450983363635,0.43246603378743,0.510481084211226,0.588496134635021,0.666511185058817,0.744526235482614,0.82254128590641,0.900556336330207,0.978571386754003,1.0565864371778,1.1346014876016,1.21261653802539,1.29063158844919,1.36864663887298,1.44666168929678,1.52467673972057,1.60269179014437,1.68070684056817,1.75872189099196,1.83673694141576,1.91475199183955,1.99276704226335,2.07078209268715,2.14879714311094,2.22681219353474,2.30482724395854,2.38284229438233,2.46085734480613,2.53887239522992,2.61688744565372,2.69490249607751,2.77291754650131,2.85093259692511,2.9289476473489,3.0069626977727,3.08497774819649,3.16299279862029,3.24100784904409,3.31902289946788,3.39703794989168,3.47505300031548,3.55306805073927,3.63108310116307,3.70909815158686,3.78711320201066,3.86512825243446,3.94314330285825,4.02115835328205,4.09917340370584,4.17718845412964,4.25520350455343,4.33321855497723,4.41123360540103,4.48924865582482,4.56726370624862,4.64527875667242]],"text":{},"mode":"markers","marker":{"color":["red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green"]},"size":1,"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"surface","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"Sepal.Length"},"yaxis":{"title":"Sepal.Width"},"zaxis":{"title":"Petal.Length"}},"hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5}},"source":"A","config":{"showSendToCloud":false},"data":[{"x":[5.1,4.9,4.7,4.6,5,5.4,4.6,5,4.4,4.9,5.4,4.8,4.8,4.3,5.8,5.7,5.4,5.1,5.7,5.1,5.4,5.1,4.6,5.1,4.8,5,5,5.2,5.2,4.7,4.8,5.4,5.2,5.5,4.9,5,5.5,4.9,4.4,5.1,5,4.5,4.4,5,5.1,4.8,5.1,4.6,5.3,5,7,6.4,6.9,5.5,6.5,5.7,6.3,4.9,6.6,5.2,5,5.9,6,6.1,5.6,6.7,5.6,5.8,6.2,5.6,5.9,6.1,6.3,6.1,6.4,6.6,6.8,6.7,6,5.7,5.5,5.5,5.8,6,5.4,6,6.7,6.3,5.6,5.5,5.5,6.1,5.8,5,5.6,5.7,5.7,6.2,5.1,5.7,6.3,5.8,7.1,6.3,6.5,7.6,4.9,7.3,6.7,7.2,6.5,6.4,6.8,5.7,5.8,6.4,6.5,7.7,7.7,6,6.9,5.6,7.7,6.3,6.7,7.2,6.2,6.1,6.4,7.2,7.4,7.9,6.4,6.3,6.1,7.7,6.3,6.4,6,6.9,6.7,6.9,5.8,6.8,6.7,6.7,6.3,6.5,6.2,5.9],"y":[3.5,3,3.2,3.1,3.6,3.9,3.4,3.4,2.9,3.1,3.7,3.4,3,3,4,4.4,3.9,3.5,3.8,3.8,3.4,3.7,3.6,3.3,3.4,3,3.4,3.5,3.4,3.2,3.1,3.4,4.1,4.2,3.1,3.2,3.5,3.6,3,3.4,3.5,2.3,3.2,3.5,3.8,3,3.8,3.2,3.7,3.3,3.2,3.2,3.1,2.3,2.8,2.8,3.3,2.4,2.9,2.7,2,3,2.2,2.9,2.9,3.1,3,2.7,2.2,2.5,3.2,2.8,2.5,2.8,2.9,3,2.8,3,2.9,2.6,2.4,2.4,2.7,2.7,3,3.4,3.1,2.3,3,2.5,2.6,3,2.6,2.3,2.7,3,2.9,2.9,2.5,2.8,3.3,2.7,3,2.9,3,3,2.5,2.9,2.5,3.6,3.2,2.7,3,2.5,2.8,3.2,3,3.8,2.6,2.2,3.2,2.8,2.8,2.7,3.3,3.2,2.8,3,2.8,3,2.8,3.8,2.8,2.8,2.6,3,3.4,3.1,3,3.1,3.1,3.1,2.7,3.2,3.3,3,2.5,3,3.4,3],"z":[1.4,1.4,1.3,1.5,1.4,1.7,1.4,1.5,1.4,1.5,1.5,1.6,1.4,1.1,1.2,1.5,1.3,1.4,1.7,1.5,1.7,1.5,1,1.7,1.9,1.6,1.6,1.5,1.4,1.6,1.6,1.5,1.5,1.4,1.5,1.2,1.3,1.4,1.3,1.5,1.3,1.3,1.3,1.6,1.9,1.4,1.6,1.4,1.5,1.4,4.7,4.5,4.9,4,4.6,4.5,4.7,3.3,4.6,3.9,3.5,4.2,4,4.7,3.6,4.4,4.5,4.1,4.5,3.9,4.8,4,4.9,4.7,4.3,4.4,4.8,5,4.5,3.5,3.8,3.7,3.9,5.1,4.5,4.5,4.7,4.4,4.1,4,4.4,4.6,4,3.3,4.2,4.2,4.2,4.3,3,4.1,6,5.1,5.9,5.6,5.8,6.6,4.5,6.3,5.8,6.1,5.1,5.3,5.5,5,5.1,5.3,5.5,6.7,6.9,5,5.7,4.9,6.7,4.9,5.7,6,4.8,4.9,5.6,5.8,6.1,6.4,5.6,5.1,5.6,6.1,5.6,5.5,4.8,5.4,5.6,5.1,5.1,5.9,5.7,5.2,5,5.2,5.4,5.1],"text":["setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica"],"mode":"markers","marker":{"color":["red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green"],"size":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(31,119,180,1)"}},"type":"scatter3d","textfont":{"size":55},"error_y":{"color":"rgba(31,119,180,1)","width":55},"error_x":{"color":"rgba(31,119,180,1)","width":55},"line":{"color":"rgba(31,119,180,1)","width":55},"frame":null},{"colorbar":{"title":"Petal.Length","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(70,19,97,1)"],["0.0833333333333333","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666667","rgba(68,58,128,1)"],["0.208333333333333","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666667","rgba(56,93,140,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666667","rgba(42,123,142,1)"],["0.458333333333333","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666667","rgba(33,154,138,1)"],["0.583333333333333","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666667","rgba(119,207,85,1)"],["0.833333333333333","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333333","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":true,"x":[4.3,4.35,4.4,4.45,4.5,4.55,4.6,4.65,4.7,4.75,4.8,4.85,4.9,4.95,5,5.05,5.1,5.15,5.2,5.25,5.3,5.35,5.4,5.45,5.5,5.55,5.6,5.65,5.7,5.75,5.8,5.85,5.9,5.95,6,6.05,6.1,6.15,6.2,6.25,6.3,6.35,6.4,6.45,6.5,6.55,6.6,6.65,6.7,6.75,6.8,6.85,6.9,6.95,7,7.05,7.1,7.15,7.2,7.25,7.3,7.35,7.4,7.45,7.5,7.55,7.6,7.65,7.7,7.75,7.8,7.85,7.9],"y":[2,2.05,2.1,2.15,2.2,2.25,2.3,2.35,2.4,2.45,2.5,2.55,2.6,2.65,2.7,2.75,2.8,2.85,2.9,2.95,3,3.05,3.1,3.15,3.2,3.25,3.3,3.35,3.4,3.45,3.5,3.55,3.6,3.65,3.7,3.75,3.8,3.85,3.9,3.95,4,4.05,4.1,4.15,4.2,4.25,4.3,4.35,4.4],"z":[[3.21788560449766,3.29590065492145,3.37391570534525,3.45193075576905,3.52994580619284,3.60796085661664,3.68597590704044,3.76399095746423,3.84200600788803,3.92002105831182,3.99803610873562,4.07605115915942,4.15406620958321,4.23208126000701,4.3100963104308,4.3881113608546,4.4661264112784,4.54414146170219,4.62215651212599,4.70017156254978,4.77818661297358,4.85620166339737,4.93421671382117,5.01223176424497,5.09024681466876,5.16826186509256,5.24627691551636,5.32429196594015,5.40230701636395,5.48032206678774,5.55833711721154,5.63635216763534,5.71436721805913,5.79238226848293,5.87039731890672,5.94841236933052,6.02642741975431,6.10444247017811,6.18245752060191,6.2604725710257,6.3384876214495,6.4165026718733,6.49451772229709,6.57253277272089,6.65054782314468,6.72856287356848,6.80657792399228,6.88459297441607,6.96260802483987,7.04062307526366,7.11863812568746,7.19665317611126,7.27466822653505,7.35268327695885,7.43069832738265,7.50871337780644,7.58672842823024,7.66474347865403,7.74275852907783,7.82077357950162,7.89878862992542,7.97680368034922,8.05481873077301,8.13283378119681,8.2108488316206,8.2888638820444,8.3668789324682,8.44489398289199,8.52290903331579,8.60092408373959,8.67893913416338,8.75695418458718,8.83496923501097],[3.13060038619894,3.20861543662274,3.28663048704653,3.36464553747033,3.44266058789412,3.52067563831792,3.59869068874172,3.67670573916551,3.75472078958931,3.8327358400131,3.9107508904369,3.9887659408607,4.06678099128449,4.14479604170829,4.22281109213208,4.30082614255588,4.37884119297968,4.45685624340347,4.53487129382727,4.61288634425106,4.69090139467486,4.76891644509865,4.84693149552245,4.92494654594625,5.00296159637004,5.08097664679384,5.15899169721764,5.23700674764143,5.31502179806523,5.39303684848902,5.47105189891282,5.54906694933662,5.62708199976041,5.70509705018421,5.783112100608,5.8611271510318,5.93914220145559,6.01715725187939,6.09517230230319,6.17318735272698,6.25120240315078,6.32921745357458,6.40723250399837,6.48524755442217,6.56326260484596,6.64127765526976,6.71929270569356,6.79730775611735,6.87532280654115,6.95333785696494,7.03135290738874,7.10936795781254,7.18738300823633,7.26539805866013,7.34341310908392,7.42142815950772,7.49944320993152,7.57745826035531,7.65547331077911,7.7334883612029,7.8115034116267,7.8895184620505,7.96753351247429,8.04554856289809,8.12356361332188,8.20157866374568,8.27959371416948,8.35760876459327,8.43562381501707,8.51363886544086,8.59165391586466,8.66966896628846,8.74768401671225],[3.04331516790022,3.12133021832401,3.19934526874781,3.27736031917161,3.3553753695954,3.4333904200192,3.511405470443,3.58942052086679,3.66743557129059,3.74545062171438,3.82346567213818,3.90148072256198,3.97949577298577,4.05751082340957,4.13552587383336,4.21354092425716,4.29155597468096,4.36957102510475,4.44758607552855,4.52560112595234,4.60361617637614,4.68163122679993,4.75964627722373,4.83766132764753,4.91567637807132,4.99369142849512,5.07170647891892,5.14972152934271,5.22773657976651,5.3057516301903,5.3837666806141,5.4617817310379,5.53979678146169,5.61781183188549,5.69582688230928,5.77384193273308,5.85185698315687,5.92987203358067,6.00788708400447,6.08590213442826,6.16391718485206,6.24193223527586,6.31994728569965,6.39796233612345,6.47597738654724,6.55399243697104,6.63200748739484,6.71002253781863,6.78803758824243,6.86605263866622,6.94406768909002,7.02208273951382,7.10009778993761,7.17811284036141,7.2561278907852,7.334142941209,7.4121579916328,7.49017304205659,7.56818809248039,7.64620314290418,7.72421819332798,7.80223324375178,7.88024829417557,7.95826334459937,8.03627839502316,8.11429344544696,8.19230849587076,8.27032354629455,8.34833859671835,8.42635364714214,8.50436869756594,8.58238374798974,8.66039879841353],[2.9560299496015,3.0340450000253,3.11206005044909,3.19007510087289,3.26809015129668,3.34610520172048,3.42412025214428,3.50213530256807,3.58015035299187,3.65816540341566,3.73618045383946,3.81419550426326,3.89221055468705,3.97022560511085,4.04824065553464,4.12625570595844,4.20427075638224,4.28228580680603,4.36030085722983,4.43831590765362,4.51633095807742,4.59434600850121,4.67236105892501,4.75037610934881,4.8283911597726,4.9064062101964,4.9844212606202,5.06243631104399,5.14045136146779,5.21846641189158,5.29648146231538,5.37449651273918,5.45251156316297,5.53052661358677,5.60854166401056,5.68655671443436,5.76457176485815,5.84258681528195,5.92060186570575,5.99861691612954,6.07663196655334,6.15464701697714,6.23266206740093,6.31067711782473,6.38869216824852,6.46670721867232,6.54472226909612,6.62273731951991,6.70075236994371,6.7787674203675,6.8567824707913,6.9347975212151,7.01281257163889,7.09082762206269,7.16884267248648,7.24685772291028,7.32487277333408,7.40288782375787,7.48090287418167,7.55891792460546,7.63693297502926,7.71494802545306,7.79296307587685,7.87097812630065,7.94899317672444,8.02700822714824,8.10502327757204,8.18303832799583,8.26105337841963,8.33906842884343,8.41708347926722,8.49509852969102,8.57311358011481],[2.86874473130278,2.94675978172657,3.02477483215037,3.10278988257417,3.18080493299796,3.25881998342176,3.33683503384556,3.41485008426935,3.49286513469315,3.57088018511694,3.64889523554074,3.72691028596454,3.80492533638833,3.88294038681213,3.96095543723592,4.03897048765972,4.11698553808352,4.19500058850731,4.27301563893111,4.3510306893549,4.4290457397787,4.50706079020249,4.58507584062629,4.66309089105009,4.74110594147388,4.81912099189768,4.89713604232148,4.97515109274527,5.05316614316907,5.13118119359286,5.20919624401666,5.28721129444046,5.36522634486425,5.44324139528805,5.52125644571184,5.59927149613564,5.67728654655943,5.75530159698323,5.83331664740703,5.91133169783082,5.98934674825462,6.06736179867842,6.14537684910221,6.22339189952601,6.3014069499498,6.3794220003736,6.4574370507974,6.53545210122119,6.61346715164499,6.69148220206878,6.76949725249258,6.84751230291638,6.92552735334017,7.00354240376397,7.08155745418776,7.15957250461156,7.23758755503536,7.31560260545915,7.39361765588295,7.47163270630674,7.54964775673054,7.62766280715434,7.70567785757813,7.78369290800193,7.86170795842572,7.93972300884952,8.01773805927332,8.09575310969711,8.17376816012091,8.2517832105447,8.3297982609685,8.4078133113923,8.48582836181609],[2.78145951300406,2.85947456342786,2.93748961385165,3.01550466427545,3.09351971469924,3.17153476512304,3.24954981554684,3.32756486597063,3.40557991639443,3.48359496681822,3.56161001724202,3.63962506766582,3.71764011808961,3.79565516851341,3.8736702189372,3.951685269361,4.0297003197848,4.10771537020859,4.18573042063239,4.26374547105618,4.34176052147998,4.41977557190377,4.49779062232757,4.57580567275137,4.65382072317516,4.73183577359896,4.80985082402276,4.88786587444655,4.96588092487035,5.04389597529414,5.12191102571794,5.19992607614174,5.27794112656553,5.35595617698933,5.43397122741312,5.51198627783692,5.59000132826071,5.66801637868451,5.74603142910831,5.8240464795321,5.9020615299559,5.9800765803797,6.05809163080349,6.13610668122729,6.21412173165108,6.29213678207488,6.37015183249868,6.44816688292247,6.52618193334627,6.60419698377006,6.68221203419386,6.76022708461766,6.83824213504145,6.91625718546525,6.99427223588904,7.07228728631284,7.15030233673664,7.22831738716043,7.30633243758423,7.38434748800802,7.46236253843182,7.54037758885562,7.61839263927941,7.69640768970321,7.774422740127,7.8524377905508,7.9304528409746,8.00846789139839,8.08648294182219,8.16449799224598,8.24251304266978,8.32052809309357,8.39854314351737],[2.69417429470534,2.77218934512914,2.85020439555293,2.92821944597673,3.00623449640052,3.08424954682432,3.16226459724812,3.24027964767191,3.31829469809571,3.3963097485195,3.4743247989433,3.5523398493671,3.63035489979089,3.70836995021469,3.78638500063848,3.86440005106228,3.94241510148608,4.02043015190987,4.09844520233367,4.17646025275746,4.25447530318126,4.33249035360506,4.41050540402885,4.48852045445265,4.56653550487645,4.64455055530024,4.72256560572404,4.80058065614783,4.87859570657163,4.95661075699542,5.03462580741922,5.11264085784302,5.19065590826681,5.26867095869061,5.3466860091144,5.4247010595382,5.502716109962,5.58073116038579,5.65874621080959,5.73676126123339,5.81477631165718,5.89279136208098,5.97080641250477,6.04882146292857,6.12683651335237,6.20485156377616,6.28286661419996,6.36088166462375,6.43889671504755,6.51691176547134,6.59492681589514,6.67294186631894,6.75095691674273,6.82897196716653,6.90698701759033,6.98500206801412,7.06301711843792,7.14103216886171,7.21904721928551,7.29706226970931,7.3750773201331,7.4530923705569,7.53110742098069,7.60912247140449,7.68713752182828,7.76515257225208,7.84316762267588,7.92118267309967,7.99919772352347,8.07721277394727,8.15522782437106,8.23324287479486,8.31125792521865],[2.60688907640662,2.68490412683042,2.76291917725421,2.84093422767801,2.9189492781018,2.9969643285256,3.0749793789494,3.15299442937319,3.23100947979699,3.30902453022078,3.38703958064458,3.46505463106838,3.54306968149217,3.62108473191597,3.69909978233976,3.77711483276356,3.85512988318736,3.93314493361115,4.01115998403495,4.08917503445874,4.16719008488254,4.24520513530633,4.32322018573013,4.40123523615393,4.47925028657772,4.55726533700152,4.63528038742532,4.71329543784911,4.79131048827291,4.8693255386967,4.9473405891205,5.0253556395443,5.10337068996809,5.18138574039189,5.25940079081568,5.33741584123948,5.41543089166327,5.49344594208707,5.57146099251087,5.64947604293466,5.72749109335846,5.80550614378226,5.88352119420605,5.96153624462985,6.03955129505364,6.11756634547744,6.19558139590124,6.27359644632503,6.35161149674883,6.42962654717262,6.50764159759642,6.58565664802022,6.66367169844401,6.74168674886781,6.8197017992916,6.8977168497154,6.9757319001392,7.05374695056299,7.13176200098679,7.20977705141058,7.28779210183438,7.36580715225818,7.44382220268197,7.52183725310577,7.59985230352956,7.67786735395336,7.75588240437716,7.83389745480095,7.91191250522475,7.98992755564854,8.06794260607234,8.14595765649614,8.22397270691993],[2.5196038581079,2.5976189085317,2.67563395895549,2.75364900937929,2.83166405980308,2.90967911022688,2.98769416065068,3.06570921107447,3.14372426149827,3.22173931192206,3.29975436234586,3.37776941276966,3.45578446319345,3.53379951361725,3.61181456404104,3.68982961446484,3.76784466488864,3.84585971531243,3.92387476573623,4.00188981616002,4.07990486658382,4.15791991700762,4.23593496743141,4.31395001785521,4.39196506827901,4.4699801187028,4.5479951691266,4.62601021955039,4.70402526997419,4.78204032039798,4.86005537082178,4.93807042124558,5.01608547166937,5.09410052209317,5.17211557251696,5.25013062294076,5.32814567336456,5.40616072378835,5.48417577421215,5.56219082463595,5.64020587505974,5.71822092548354,5.79623597590733,5.87425102633113,5.95226607675492,6.03028112717872,6.10829617760252,6.18631122802631,6.26432627845011,6.3423413288739,6.4203563792977,6.4983714297215,6.57638648014529,6.65440153056909,6.73241658099289,6.81043163141668,6.88844668184048,6.96646173226427,7.04447678268807,7.12249183311186,7.20050688353566,7.27852193395946,7.35653698438325,7.43455203480705,7.51256708523084,7.59058213565464,7.66859718607844,7.74661223650223,7.82462728692603,7.90264233734983,7.98065738777362,8.05867243819742,8.13668748862121],[2.43231863980918,2.51033369023297,2.58834874065677,2.66636379108057,2.74437884150436,2.82239389192816,2.90040894235196,2.97842399277575,3.05643904319955,3.13445409362334,3.21246914404714,3.29048419447094,3.36849924489473,3.44651429531853,3.52452934574232,3.60254439616612,3.68055944658991,3.75857449701371,3.83658954743751,3.9146045978613,3.9926196482851,4.07063469870889,4.14864974913269,4.22666479955649,4.30467984998028,4.38269490040408,4.46070995082788,4.53872500125167,4.61674005167547,4.69475510209926,4.77277015252306,4.85078520294686,4.92880025337065,5.00681530379445,5.08483035421824,5.16284540464204,5.24086045506583,5.31887550548963,5.39689055591343,5.47490560633722,5.55292065676102,5.63093570718482,5.70895075760861,5.78696580803241,5.8649808584562,5.94299590888,6.0210109593038,6.09902600972759,6.17704106015139,6.25505611057518,6.33307116099898,6.41108621142278,6.48910126184657,6.56711631227037,6.64513136269416,6.72314641311796,6.80116146354176,6.87917651396555,6.95719156438935,7.03520661481314,7.11322166523694,7.19123671566074,7.26925176608453,7.34726681650833,7.42528186693212,7.50329691735592,7.58131196777972,7.65932701820351,7.73734206862731,7.8153571190511,7.8933721694749,7.9713872198987,8.04940227032249],[2.34503342151046,2.42304847193426,2.50106352235805,2.57907857278185,2.65709362320564,2.73510867362944,2.81312372405324,2.89113877447703,2.96915382490083,3.04716887532462,3.12518392574842,3.20319897617222,3.28121402659601,3.35922907701981,3.4372441274436,3.5152591778674,3.5932742282912,3.67128927871499,3.74930432913879,3.82731937956258,3.90533442998638,3.98334948041018,4.06136453083397,4.13937958125777,4.21739463168157,4.29540968210536,4.37342473252916,4.45143978295295,4.52945483337675,4.60746988380054,4.68548493422434,4.76349998464814,4.84151503507193,4.91953008549573,4.99754513591952,5.07556018634332,5.15357523676712,5.23159028719091,5.30960533761471,5.38762038803851,5.4656354384623,5.5436504888861,5.62166553930989,5.69968058973369,5.77769564015748,5.85571069058128,5.93372574100508,6.01174079142887,6.08975584185267,6.16777089227646,6.24578594270026,6.32380099312406,6.40181604354785,6.47983109397165,6.55784614439545,6.63586119481924,6.71387624524304,6.79189129566683,6.86990634609063,6.94792139651442,7.02593644693822,7.10395149736202,7.18196654778581,7.25998159820961,7.3379966486334,7.4160116990572,7.494026749481,7.57204179990479,7.65005685032859,7.72807190075239,7.80608695117618,7.88410200159998,7.96211705202377],[2.25774820321174,2.33576325363554,2.41377830405933,2.49179335448313,2.56980840490692,2.64782345533072,2.72583850575452,2.80385355617831,2.88186860660211,2.9598836570259,3.0378987074497,3.1159137578735,3.19392880829729,3.27194385872109,3.34995890914488,3.42797395956868,3.50598900999248,3.58400406041627,3.66201911084007,3.74003416126386,3.81804921168766,3.89606426211146,3.97407931253525,4.05209436295905,4.13010941338285,4.20812446380664,4.28613951423044,4.36415456465423,4.44216961507803,4.52018466550182,4.59819971592562,4.67621476634942,4.75422981677321,4.83224486719701,4.9102599176208,4.9882749680446,5.0662900184684,5.14430506889219,5.22232011931599,5.30033516973979,5.37835022016358,5.45636527058738,5.53438032101117,5.61239537143497,5.69041042185876,5.76842547228256,5.84644052270636,5.92445557313015,6.00247062355395,6.08048567397774,6.15850072440154,6.23651577482534,6.31453082524913,6.39254587567293,6.47056092609673,6.54857597652052,6.62659102694432,6.70460607736811,6.78262112779191,6.8606361782157,6.9386512286395,7.0166662790633,7.09468132948709,7.17269637991089,7.25071143033468,7.32872648075848,7.40674153118228,7.48475658160607,7.56277163202987,7.64078668245367,7.71880173287746,7.79681678330126,7.87483183372505],[2.17046298491302,2.24847803533682,2.32649308576061,2.40450813618441,2.4825231866082,2.560538237032,2.6385532874558,2.71656833787959,2.79458338830339,2.87259843872718,2.95061348915098,3.02862853957478,3.10664358999857,3.18465864042237,3.26267369084616,3.34068874126996,3.41870379169376,3.49671884211755,3.57473389254135,3.65274894296514,3.73076399338894,3.80877904381274,3.88679409423653,3.96480914466033,4.04282419508413,4.12083924550792,4.19885429593172,4.27686934635551,4.35488439677931,4.4328994472031,4.5109144976269,4.5889295480507,4.66694459847449,4.74495964889829,4.82297469932208,4.90098974974588,4.97900480016968,5.05701985059347,5.13503490101727,5.21304995144107,5.29106500186486,5.36908005228866,5.44709510271245,5.52511015313625,5.60312520356004,5.68114025398384,5.75915530440764,5.83717035483143,5.91518540525523,5.99320045567902,6.07121550610282,6.14923055652662,6.22724560695041,6.30526065737421,6.38327570779801,6.4612907582218,6.5393058086456,6.61732085906939,6.69533590949319,6.77335095991698,6.85136601034078,6.92938106076458,7.00739611118837,7.08541116161217,7.16342621203596,7.24144126245976,7.31945631288356,7.39747136330735,7.47548641373115,7.55350146415495,7.63151651457874,7.70953156500254,7.78754661542633],[2.0831777666143,2.1611928170381,2.23920786746189,2.31722291788569,2.39523796830948,2.47325301873328,2.55126806915708,2.62928311958087,2.70729817000467,2.78531322042846,2.86332827085226,2.94134332127606,3.01935837169985,3.09737342212365,3.17538847254744,3.25340352297124,3.33141857339504,3.40943362381883,3.48744867424263,3.56546372466642,3.64347877509022,3.72149382551402,3.79950887593781,3.87752392636161,3.95553897678541,4.0335540272092,4.111569077633,4.18958412805679,4.26759917848059,4.34561422890438,4.42362927932818,4.50164432975198,4.57965938017577,4.65767443059957,4.73568948102336,4.81370453144716,4.89171958187096,4.96973463229475,5.04774968271855,5.12576473314235,5.20377978356614,5.28179483398994,5.35980988441373,5.43782493483753,5.51583998526132,5.59385503568512,5.67187008610892,5.74988513653271,5.82790018695651,5.9059152373803,5.9839302878041,6.0619453382279,6.13996038865169,6.21797543907549,6.29599048949929,6.37400553992308,6.45202059034688,6.53003564077067,6.60805069119447,6.68606574161826,6.76408079204206,6.84209584246586,6.92011089288965,6.99812594331345,7.07614099373724,7.15415604416104,7.23217109458484,7.31018614500863,7.38820119543243,7.46621624585623,7.54423129628002,7.62224634670382,7.70026139712761],[1.99589254831558,2.07390759873938,2.15192264916317,2.22993769958697,2.30795275001076,2.38596780043456,2.46398285085836,2.54199790128215,2.62001295170595,2.69802800212974,2.77604305255354,2.85405810297734,2.93207315340113,3.01008820382493,3.08810325424872,3.16611830467252,3.24413335509632,3.32214840552011,3.40016345594391,3.4781785063677,3.5561935567915,3.6342086072153,3.71222365763909,3.79023870806289,3.86825375848669,3.94626880891048,4.02428385933428,4.10229890975807,4.18031396018187,4.25832901060566,4.33634406102946,4.41435911145326,4.49237416187705,4.57038921230085,4.64840426272464,4.72641931314844,4.80443436357224,4.88244941399603,4.96046446441983,5.03847951484363,5.11649456526742,5.19450961569122,5.27252466611501,5.35053971653881,5.4285547669626,5.5065698173864,5.5845848678102,5.66259991823399,5.74061496865779,5.81863001908158,5.89664506950538,5.97466011992918,6.05267517035297,6.13069022077677,6.20870527120057,6.28672032162436,6.36473537204816,6.44275042247195,6.52076547289575,6.59878052331954,6.67679557374334,6.75481062416714,6.83282567459093,6.91084072501473,6.98885577543852,7.06687082586232,7.14488587628612,7.22290092670991,7.30091597713371,7.37893102755751,7.4569460779813,7.5349611284051,7.61297617882889],[1.90860733001686,1.98662238044066,2.06463743086445,2.14265248128825,2.22066753171204,2.29868258213584,2.37669763255964,2.45471268298343,2.53272773340723,2.61074278383103,2.68875783425482,2.76677288467862,2.84478793510241,2.92280298552621,3.00081803595001,3.0788330863738,3.1568481367976,3.23486318722139,3.31287823764519,3.39089328806898,3.46890833849278,3.54692338891658,3.62493843934037,3.70295348976417,3.78096854018797,3.85898359061176,3.93699864103556,4.01501369145935,4.09302874188315,4.17104379230695,4.24905884273074,4.32707389315454,4.40508894357833,4.48310399400213,4.56111904442592,4.63913409484972,4.71714914527352,4.79516419569731,4.87317924612111,4.95119429654491,5.0292093469687,5.1072243973925,5.18523944781629,5.26325449824009,5.34126954866389,5.41928459908768,5.49729964951148,5.57531469993527,5.65332975035907,5.73134480078286,5.80935985120666,5.88737490163046,5.96538995205425,6.04340500247805,6.12142005290185,6.19943510332564,6.27745015374944,6.35546520417323,6.43348025459703,6.51149530502083,6.58951035544462,6.66752540586842,6.74554045629221,6.82355550671601,6.9015705571398,6.9795856075636,7.0576006579874,7.13561570841119,7.21363075883499,7.29164580925879,7.36966085968258,7.44767591010638,7.52569096053017],[1.82132211171814,1.89933716214194,1.97735221256573,2.05536726298953,2.13338231341332,2.21139736383712,2.28941241426092,2.36742746468471,2.44544251510851,2.52345756553231,2.6014726159561,2.6794876663799,2.75750271680369,2.83551776722749,2.91353281765129,2.99154786807508,3.06956291849888,3.14757796892267,3.22559301934647,3.30360806977026,3.38162312019406,3.45963817061786,3.53765322104165,3.61566827146545,3.69368332188925,3.77169837231304,3.84971342273684,3.92772847316063,4.00574352358443,4.08375857400823,4.16177362443202,4.23978867485582,4.31780372527961,4.39581877570341,4.4738338261272,4.551848876551,4.6298639269748,4.70787897739859,4.78589402782239,4.86390907824619,4.94192412866998,5.01993917909378,5.09795422951757,5.17596927994137,5.25398433036517,5.33199938078896,5.41001443121276,5.48802948163655,5.56604453206035,5.64405958248414,5.72207463290794,5.80008968333174,5.87810473375553,5.95611978417933,6.03413483460313,6.11214988502692,6.19016493545072,6.26817998587451,6.34619503629831,6.42421008672211,6.5022251371459,6.5802401875697,6.65825523799349,6.73627028841729,6.81428533884108,6.89230038926488,6.97031543968868,7.04833049011247,7.12634554053627,7.20436059096007,7.28237564138386,7.36039069180766,7.43840574223145],[1.73403689341942,1.81205194384322,1.89006699426701,1.96808204469081,2.0460970951146,2.1241121455384,2.2021271959622,2.28014224638599,2.35815729680979,2.43617234723359,2.51418739765738,2.59220244808118,2.67021749850497,2.74823254892877,2.82624759935257,2.90426264977636,2.98227770020016,3.06029275062395,3.13830780104775,3.21632285147154,3.29433790189534,3.37235295231914,3.45036800274293,3.52838305316673,3.60639810359053,3.68441315401432,3.76242820443812,3.84044325486191,3.91845830528571,3.99647335570951,4.0744884061333,4.1525034565571,4.23051850698089,4.30853355740469,4.38654860782848,4.46456365825228,4.54257870867608,4.62059375909987,4.69860880952367,4.77662385994747,4.85463891037126,4.93265396079506,5.01066901121885,5.08868406164265,5.16669911206645,5.24471416249024,5.32272921291404,5.40074426333783,5.47875931376163,5.55677436418542,5.63478941460922,5.71280446503302,5.79081951545681,5.86883456588061,5.94684961630441,6.0248646667282,6.102879717152,6.18089476757579,6.25890981799959,6.33692486842339,6.41493991884718,6.49295496927098,6.57097001969477,6.64898507011857,6.72700012054236,6.80501517096616,6.88303022138996,6.96104527181375,7.03906032223755,7.11707537266135,7.19509042308514,7.27310547350894,7.35112052393273],[1.6467516751207,1.7247667255445,1.80278177596829,1.88079682639209,1.95881187681588,2.03682692723968,2.11484197766348,2.19285702808727,2.27087207851107,2.34888712893486,2.42690217935866,2.50491722978246,2.58293228020625,2.66094733063005,2.73896238105385,2.81697743147764,2.89499248190144,2.97300753232523,3.05102258274903,3.12903763317282,3.20705268359662,3.28506773402042,3.36308278444421,3.44109783486801,3.51911288529181,3.5971279357156,3.6751429861394,3.75315803656319,3.83117308698699,3.90918813741079,3.98720318783458,4.06521823825838,4.14323328868217,4.22124833910597,4.29926338952976,4.37727843995356,4.45529349037736,4.53330854080115,4.61132359122495,4.68933864164875,4.76735369207254,4.84536874249634,4.92338379292013,5.00139884334393,5.07941389376773,5.15742894419152,5.23544399461532,5.31345904503911,5.39147409546291,5.4694891458867,5.5475041963105,5.6255192467343,5.70353429715809,5.78154934758189,5.85956439800569,5.93757944842948,6.01559449885328,6.09360954927707,6.17162459970087,6.24963965012467,6.32765470054846,6.40566975097226,6.48368480139605,6.56169985181985,6.63971490224364,6.71772995266744,6.79574500309124,6.87376005351503,6.95177510393883,7.02979015436263,7.10780520478642,7.18582025521022,7.26383530563401],[1.55946645682198,1.63748150724578,1.71549655766957,1.79351160809337,1.87152665851716,1.94954170894096,2.02755675936476,2.10557180978855,2.18358686021235,2.26160191063614,2.33961696105994,2.41763201148374,2.49564706190753,2.57366211233133,2.65167716275513,2.72969221317892,2.80770726360272,2.88572231402651,2.96373736445031,3.0417524148741,3.1197674652979,3.1977825157217,3.27579756614549,3.35381261656929,3.43182766699309,3.50984271741688,3.58785776784068,3.66587281826447,3.74388786868827,3.82190291911207,3.89991796953586,3.97793301995966,4.05594807038345,4.13396312080725,4.21197817123104,4.28999322165484,4.36800827207864,4.44602332250243,4.52403837292623,4.60205342335003,4.68006847377382,4.75808352419762,4.83609857462141,4.91411362504521,4.99212867546901,5.0701437258928,5.1481587763166,5.22617382674039,5.30418887716419,5.38220392758798,5.46021897801178,5.53823402843558,5.61624907885937,5.69426412928317,5.77227917970697,5.85029423013076,5.92830928055456,6.00632433097835,6.08433938140215,6.16235443182595,6.24036948224974,6.31838453267354,6.39639958309733,6.47441463352113,6.55242968394492,6.63044473436872,6.70845978479252,6.78647483521631,6.86448988564011,6.94250493606391,7.0205199864877,7.0985350369115,7.17655008733529],[1.47218123852326,1.55019628894706,1.62821133937085,1.70622638979465,1.78424144021844,1.86225649064224,1.94027154106604,2.01828659148983,2.09630164191363,2.17431669233742,2.25233174276122,2.33034679318502,2.40836184360881,2.48637689403261,2.56439194445641,2.6424069948802,2.720422045304,2.79843709572779,2.87645214615159,2.95446719657538,3.03248224699918,3.11049729742298,3.18851234784677,3.26652739827057,3.34454244869437,3.42255749911816,3.50057254954196,3.57858759996575,3.65660265038955,3.73461770081335,3.81263275123714,3.89064780166094,3.96866285208473,4.04667790250853,4.12469295293232,4.20270800335612,4.28072305377992,4.35873810420371,4.43675315462751,4.51476820505131,4.5927832554751,4.6707983058989,4.74881335632269,4.82682840674649,4.90484345717029,4.98285850759408,5.06087355801788,5.13888860844167,5.21690365886547,5.29491870928926,5.37293375971306,5.45094881013686,5.52896386056065,5.60697891098445,5.68499396140825,5.76300901183204,5.84102406225584,5.91903911267963,5.99705416310343,6.07506921352723,6.15308426395102,6.23109931437482,6.30911436479861,6.38712941522241,6.4651444656462,6.54315951607,6.6211745664938,6.69918961691759,6.77720466734139,6.85521971776519,6.93323476818898,7.01124981861278,7.08926486903657],[1.38489602022454,1.46291107064834,1.54092612107213,1.61894117149593,1.69695622191973,1.77497127234352,1.85298632276732,1.93100137319111,2.00901642361491,2.08703147403871,2.1650465244625,2.2430615748863,2.32107662531009,2.39909167573389,2.47710672615769,2.55512177658148,2.63313682700528,2.71115187742907,2.78916692785287,2.86718197827667,2.94519702870046,3.02321207912426,3.10122712954805,3.17924217997185,3.25725723039565,3.33527228081944,3.41328733124324,3.49130238166703,3.56931743209083,3.64733248251463,3.72534753293842,3.80336258336222,3.88137763378601,3.95939268420981,4.03740773463361,4.1154227850574,4.1934378354812,4.27145288590499,4.34946793632879,4.42748298675259,4.50549803717638,4.58351308760018,4.66152813802398,4.73954318844777,4.81755823887157,4.89557328929536,4.97358833971916,5.05160339014295,5.12961844056675,5.20763349099055,5.28564854141434,5.36366359183814,5.44167864226193,5.51969369268573,5.59770874310953,5.67572379353332,5.75373884395712,5.83175389438092,5.90976894480471,5.98778399522851,6.0657990456523,6.1438140960761,6.22182914649989,6.29984419692369,6.37785924734749,6.45587429777128,6.53388934819508,6.61190439861887,6.68991944904267,6.76793449946647,6.84594954989026,6.92396460031406,7.00197965073786],[1.29761080192582,1.37562585234962,1.45364090277341,1.53165595319721,1.609671003621,1.6876860540448,1.7657011044686,1.84371615489239,1.92173120531619,1.99974625573998,2.07776130616378,2.15577635658758,2.23379140701137,2.31180645743517,2.38982150785897,2.46783655828276,2.54585160870656,2.62386665913035,2.70188170955415,2.77989675997794,2.85791181040174,2.93592686082554,3.01394191124933,3.09195696167313,3.16997201209693,3.24798706252072,3.32600211294452,3.40401716336831,3.48203221379211,3.56004726421591,3.6380623146397,3.7160773650635,3.79409241548729,3.87210746591109,3.95012251633488,4.02813756675868,4.10615261718248,4.18416766760627,4.26218271803007,4.34019776845387,4.41821281887766,4.49622786930146,4.57424291972525,4.65225797014905,4.73027302057285,4.80828807099664,4.88630312142044,4.96431817184423,5.04233322226803,5.12034827269182,5.19836332311562,5.27637837353942,5.35439342396321,5.43240847438701,5.51042352481081,5.5884385752346,5.6664536256584,5.74446867608219,5.82248372650599,5.90049877692979,5.97851382735358,6.05652887777738,6.13454392820117,6.21255897862497,6.29057402904876,6.36858907947256,6.44660412989636,6.52461918032015,6.60263423074395,6.68064928116775,6.75866433159154,6.83667938201534,6.91469443243913],[1.2103255836271,1.2883406340509,1.36635568447469,1.44437073489849,1.52238578532228,1.60040083574608,1.67841588616988,1.75643093659367,1.83444598701747,1.91246103744126,1.99047608786506,2.06849113828886,2.14650618871265,2.22452123913645,2.30253628956025,2.38055133998404,2.45856639040784,2.53658144083163,2.61459649125543,2.69261154167922,2.77062659210302,2.84864164252682,2.92665669295061,3.00467174337441,3.08268679379821,3.160701844222,3.2387168946458,3.31673194506959,3.39474699549339,3.47276204591719,3.55077709634098,3.62879214676478,3.70680719718857,3.78482224761237,3.86283729803616,3.94085234845996,4.01886739888376,4.09688244930755,4.17489749973135,4.25291255015515,4.33092760057894,4.40894265100274,4.48695770142653,4.56497275185033,4.64298780227413,4.72100285269792,4.79901790312172,4.87703295354551,4.95504800396931,5.0330630543931,5.1110781048169,5.1890931552407,5.26710820566449,5.34512325608829,5.42313830651209,5.50115335693588,5.57916840735968,5.65718345778347,5.73519850820727,5.81321355863107,5.89122860905486,5.96924365947866,6.04725870990245,6.12527376032625,6.20328881075004,6.28130386117384,6.35931891159764,6.43733396202143,6.51534901244523,6.59336406286903,6.67137911329282,6.74939416371662,6.82740921414041],[1.12304036532838,1.20105541575218,1.27907046617597,1.35708551659977,1.43510056702356,1.51311561744736,1.59113066787116,1.66914571829495,1.74716076871875,1.82517581914254,1.90319086956634,1.98120591999014,2.05922097041393,2.13723602083773,2.21525107126152,2.29326612168532,2.37128117210912,2.44929622253291,2.52731127295671,2.6053263233805,2.6833413738043,2.7613564242281,2.83937147465189,2.91738652507569,2.99540157549949,3.07341662592328,3.15143167634708,3.22944672677087,3.30746177719467,3.38547682761847,3.46349187804226,3.54150692846606,3.61952197888985,3.69753702931365,3.77555207973744,3.85356713016124,3.93158218058504,4.00959723100883,4.08761228143263,4.16562733185643,4.24364238228022,4.32165743270402,4.39967248312781,4.47768753355161,4.55570258397541,4.6337176343992,4.711732684823,4.78974773524679,4.86776278567059,4.94577783609438,5.02379288651818,5.10180793694198,5.17982298736577,5.25783803778957,5.33585308821337,5.41386813863716,5.49188318906096,5.56989823948475,5.64791328990855,5.72592834033235,5.80394339075614,5.88195844117994,5.95997349160373,6.03798854202753,6.11600359245132,6.19401864287512,6.27203369329892,6.35004874372271,6.42806379414651,6.50607884457031,6.5840938949941,6.6621089454179,6.74012399584169],[1.03575514702966,1.11377019745346,1.19178524787725,1.26980029830105,1.34781534872485,1.42583039914864,1.50384544957244,1.58186049999623,1.65987555042003,1.73789060084383,1.81590565126762,1.89392070169142,1.97193575211521,2.04995080253901,2.12796585296281,2.2059809033866,2.2839959538104,2.36201100423419,2.44002605465799,2.51804110508179,2.59605615550558,2.67407120592938,2.75208625635317,2.83010130677697,2.90811635720077,2.98613140762456,3.06414645804836,3.14216150847215,3.22017655889595,3.29819160931975,3.37620665974354,3.45422171016734,3.53223676059113,3.61025181101493,3.68826686143873,3.76628191186252,3.84429696228632,3.92231201271011,4.00032706313391,4.07834211355771,4.1563571639815,4.2343722144053,4.31238726482909,4.39040231525289,4.46841736567669,4.54643241610048,4.62444746652428,4.70246251694807,4.78047756737187,4.85849261779567,4.93650766821946,5.01452271864326,5.09253776906705,5.17055281949085,5.24856786991465,5.32658292033844,5.40459797076224,5.48261302118603,5.56062807160983,5.63864312203363,5.71665817245742,5.79467322288122,5.87268827330501,5.95070332372881,6.02871837415261,6.1067334245764,6.1847484750002,6.26276352542399,6.34077857584779,6.41879362627159,6.49680867669538,6.57482372711918,6.65283877754297],[0.948469928730941,1.02648497915474,1.10450002957853,1.18251508000233,1.26053013042613,1.33854518084992,1.41656023127372,1.49457528169751,1.57259033212131,1.65060538254511,1.7286204329689,1.8066354833927,1.88465053381649,1.96266558424029,2.04068063466409,2.11869568508788,2.19671073551168,2.27472578593547,2.35274083635927,2.43075588678307,2.50877093720686,2.58678598763066,2.66480103805445,2.74281608847825,2.82083113890205,2.89884618932584,2.97686123974964,3.05487629017343,3.13289134059723,3.21090639102103,3.28892144144482,3.36693649186862,3.44495154229241,3.52296659271621,3.60098164314001,3.6789966935638,3.7570117439876,3.83502679441139,3.91304184483519,3.99105689525899,4.06907194568278,4.14708699610658,4.22510204653037,4.30311709695417,4.38113214737797,4.45914719780176,4.53716224822556,4.61517729864935,4.69319234907315,4.77120739949695,4.84922244992074,4.92723750034454,5.00525255076833,5.08326760119213,5.16128265161593,5.23929770203972,5.31731275246352,5.39532780288731,5.47334285331111,5.55135790373491,5.6293729541587,5.7073880045825,5.78540305500629,5.86341810543009,5.94143315585389,6.01944820627768,6.09746325670148,6.17547830712527,6.25349335754907,6.33150840797287,6.40952345839666,6.48753850882046,6.56555355924425],[0.861184710432221,0.939199760856017,1.01721481127981,1.09522986170361,1.17324491212741,1.2512599625512,1.329275012975,1.40729006339879,1.48530511382259,1.56332016424639,1.64133521467018,1.71935026509398,1.79736531551777,1.87538036594157,1.95339541636537,2.03141046678916,2.10942551721296,2.18744056763675,2.26545561806055,2.34347066848435,2.42148571890814,2.49950076933194,2.57751581975573,2.65553087017953,2.73354592060333,2.81156097102712,2.88957602145092,2.96759107187471,3.04560612229851,3.12362117272231,3.2016362231461,3.2796512735699,3.35766632399369,3.43568137441749,3.51369642484129,3.59171147526508,3.66972652568888,3.74774157611267,3.82575662653647,3.90377167696027,3.98178672738406,4.05980177780786,4.13781682823165,4.21583187865545,4.29384692907925,4.37186197950304,4.44987702992684,4.52789208035063,4.60590713077443,4.68392218119823,4.76193723162202,4.83995228204582,4.91796733246961,4.99598238289341,5.07399743331721,5.152012483741,5.2300275341648,5.30804258458859,5.38605763501239,5.46407268543619,5.54208773585998,5.62010278628378,5.69811783670757,5.77613288713137,5.85414793755517,5.93216298797896,6.01017803840276,6.08819308882655,6.16620813925035,6.24422318967415,6.32223824009794,6.40025329052174,6.47826834094553],[0.773899492133501,0.851914542557297,0.929929592981092,1.00794464340489,1.08595969382869,1.16397474425248,1.24198979467628,1.32000484510007,1.39801989552387,1.47603494594767,1.55404999637146,1.63206504679526,1.71008009721905,1.78809514764285,1.86611019806665,1.94412524849044,2.02214029891424,2.10015534933803,2.17817039976183,2.25618545018563,2.33420050060942,2.41221555103322,2.49023060145701,2.56824565188081,2.64626070230461,2.7242757527284,2.8022908031522,2.88030585357599,2.95832090399979,3.03633595442359,3.11435100484738,3.19236605527118,3.27038110569497,3.34839615611877,3.42641120654257,3.50442625696636,3.58244130739016,3.66045635781395,3.73847140823775,3.81648645866155,3.89450150908534,3.97251655950914,4.05053160993293,4.12854666035673,4.20656171078053,4.28457676120432,4.36259181162812,4.44060686205191,4.51862191247571,4.59663696289951,4.6746520133233,4.7526670637471,4.83068211417089,4.90869716459469,4.98671221501849,5.06472726544228,5.14274231586608,5.22075736628987,5.29877241671367,5.37678746713747,5.45480251756126,5.53281756798506,5.61083261840885,5.68884766883265,5.76686271925645,5.84487776968024,5.92289282010404,6.00090787052783,6.07892292095163,6.15693797137543,6.23495302179922,6.31296807222302,6.39098312264681],[0.686614273834781,0.764629324258577,0.842644374682372,0.920659425106169,0.998674475529965,1.07668952595376,1.15470457637756,1.23271962680135,1.31073467722515,1.38874972764895,1.46676477807274,1.54477982849654,1.62279487892033,1.70080992934413,1.77882497976793,1.85684003019172,1.93485508061552,2.01287013103931,2.09088518146311,2.16890023188691,2.2469152823107,2.3249303327345,2.40294538315829,2.48096043358209,2.55897548400589,2.63699053442968,2.71500558485348,2.79302063527727,2.87103568570107,2.94905073612487,3.02706578654866,3.10508083697246,3.18309588739625,3.26111093782005,3.33912598824385,3.41714103866764,3.49515608909144,3.57317113951523,3.65118618993903,3.72920124036283,3.80721629078662,3.88523134121042,3.96324639163421,4.04126144205801,4.11927649248181,4.1972915429056,4.2753065933294,4.35332164375319,4.43133669417699,4.50935174460079,4.58736679502458,4.66538184544838,4.74339689587217,4.82141194629597,4.89942699671977,4.97744204714356,5.05545709756736,5.13347214799115,5.21148719841495,5.28950224883875,5.36751729926254,5.44553234968634,5.52354740011013,5.60156245053393,5.67957750095773,5.75759255138152,5.83560760180532,5.91362265222911,5.99163770265291,6.06965275307671,6.1476678035005,6.2256828539243,6.30369790434809],[0.599329055536062,0.677344105959858,0.755359156383653,0.83337420680745,0.911389257231246,0.989404307655042,1.06741935807884,1.14543440850263,1.22344945892643,1.30146450935023,1.37947955977402,1.45749461019782,1.53550966062161,1.61352471104541,1.69153976146921,1.769554811893,1.8475698623168,1.92558491274059,2.00359996316439,2.08161501358819,2.15963006401198,2.23764511443578,2.31566016485957,2.39367521528337,2.47169026570717,2.54970531613096,2.62772036655476,2.70573541697856,2.78375046740235,2.86176551782615,2.93978056824994,3.01779561867374,3.09581066909753,3.17382571952133,3.25184076994513,3.32985582036892,3.40787087079272,3.48588592121651,3.56390097164031,3.64191602206411,3.7199310724879,3.7979461229117,3.8759611733355,3.95397622375929,4.03199127418309,4.11000632460688,4.18802137503068,4.26603642545447,4.34405147587827,4.42206652630207,4.50008157672586,4.57809662714966,4.65611167757345,4.73412672799725,4.81214177842105,4.89015682884484,4.96817187926864,5.04618692969244,5.12420198011623,5.20221703054003,5.28023208096382,5.35824713138762,5.43626218181141,5.51427723223521,5.59229228265901,5.6703073330828,5.7483223835066,5.82633743393039,5.90435248435419,5.98236753477799,6.06038258520178,6.13839763562558,6.21641268604938],[0.512043837237342,0.590058887661137,0.668073938084933,0.74608898850873,0.824104038932526,0.902119089356322,0.980134139780118,1.05814919020391,1.13616424062771,1.21417929105151,1.2921943414753,1.3702093918991,1.44822444232289,1.52623949274669,1.60425454317049,1.68226959359428,1.76028464401808,1.83829969444187,1.91631474486567,1.99432979528947,2.07234484571326,2.15035989613706,2.22837494656085,2.30638999698465,2.38440504740845,2.46242009783224,2.54043514825604,2.61845019867984,2.69646524910363,2.77448029952743,2.85249534995122,2.93051040037502,3.00852545079881,3.08654050122261,3.16455555164641,3.2425706020702,3.320585652494,3.39860070291779,3.47661575334159,3.55463080376539,3.63264585418918,3.71066090461298,3.78867595503678,3.86669100546057,3.94470605588437,4.02272110630816,4.10073615673196,4.17875120715575,4.25676625757955,4.33478130800335,4.41279635842714,4.49081140885094,4.56882645927473,4.64684150969853,4.72485656012233,4.80287161054612,4.88088666096992,4.95890171139372,5.03691676181751,5.11493181224131,5.1929468626651,5.2709619130889,5.34897696351269,5.42699201393649,5.50500706436029,5.58302211478408,5.66103716520788,5.73905221563167,5.81706726605547,5.89508231647927,5.97309736690306,6.05111241732686,6.12912746775066],[0.424758618938622,0.502773669362417,0.580788719786213,0.65880377021001,0.736818820633806,0.814833871057602,0.892848921481398,0.970863971905193,1.04887902232899,1.12689407275279,1.20490912317658,1.28292417360038,1.36093922402417,1.43895427444797,1.51696932487177,1.59498437529556,1.67299942571936,1.75101447614315,1.82902952656695,1.90704457699075,1.98505962741454,2.06307467783834,2.14108972826213,2.21910477868593,2.29711982910973,2.37513487953352,2.45314992995732,2.53116498038112,2.60918003080491,2.68719508122871,2.7652101316525,2.8432251820763,2.92124023250009,2.99925528292389,3.07727033334769,3.15528538377148,3.23330043419528,3.31131548461907,3.38933053504287,3.46734558546667,3.54536063589046,3.62337568631426,3.70139073673806,3.77940578716185,3.85742083758565,3.93543588800944,4.01345093843324,4.09146598885703,4.16948103928083,4.24749608970463,4.32551114012842,4.40352619055222,4.48154124097601,4.55955629139981,4.63757134182361,4.7155863922474,4.7936014426712,4.871616493095,4.94963154351879,5.02764659394259,5.10566164436638,5.18367669479018,5.26169174521397,5.33970679563777,5.41772184606157,5.49573689648536,5.57375194690916,5.65176699733295,5.72978204775675,5.80779709818055,5.88581214860434,5.96382719902814,6.04184224945194],[0.337473400639901,0.415488451063696,0.493503501487492,0.571518551911289,0.649533602335085,0.727548652758881,0.805563703182677,0.883578753606472,0.96159380403027,1.03960885445407,1.11762390487786,1.19563895530166,1.27365400572545,1.35166905614925,1.42968410657305,1.50769915699684,1.58571420742064,1.66372925784443,1.74174430826823,1.81975935869202,1.89777440911582,1.97578945953962,2.05380450996341,2.13181956038721,2.20983461081101,2.2878496612348,2.3658647116586,2.44387976208239,2.52189481250619,2.59990986292999,2.67792491335378,2.75593996377758,2.83395501420137,2.91197006462517,2.98998511504896,3.06800016547276,3.14601521589656,3.22403026632035,3.30204531674415,3.38006036716795,3.45807541759174,3.53609046801554,3.61410551843933,3.69212056886313,3.77013561928693,3.84815066971072,3.92616572013452,4.00418077055831,4.08219582098211,4.1602108714059,4.2382259218297,4.3162409722535,4.39425602267729,4.47227107310109,4.55028612352489,4.62830117394868,4.70631622437248,4.78433127479627,4.86234632522007,4.94036137564387,5.01837642606766,5.09639147649146,5.17440652691525,5.25242157733905,5.33043662776284,5.40845167818664,5.48646672861044,5.56448177903423,5.64249682945803,5.72051187988183,5.79852693030562,5.87654198072942,5.95455703115321],[0.250188182341182,0.328203232764977,0.406218283188773,0.48423333361257,0.562248384036366,0.640263434460162,0.718278484883958,0.796293535307753,0.87430858573155,0.952323636155346,1.03033868657914,1.10835373700294,1.18636878742673,1.26438383785053,1.34239888827433,1.42041393869812,1.49842898912192,1.57644403954571,1.65445908996951,1.73247414039331,1.8104891908171,1.8885042412409,1.96651929166469,2.04453434208849,2.12254939251229,2.20056444293608,2.27857949335988,2.35659454378368,2.43460959420747,2.51262464463127,2.59063969505506,2.66865474547886,2.74666979590265,2.82468484632645,2.90269989675025,2.98071494717404,3.05872999759784,3.13674504802163,3.21476009844543,3.29277514886923,3.37079019929302,3.44880524971682,3.52682030014062,3.60483535056441,3.68285040098821,3.760865451412,3.8388805018358,3.91689555225959,3.99491060268339,4.07292565310719,4.15094070353098,4.22895575395478,4.30697080437857,4.38498585480237,4.46300090522617,4.54101595564996,4.61903100607376,4.69704605649756,4.77506110692135,4.85307615734515,4.93109120776894,5.00910625819274,5.08712130861653,5.16513635904033,5.24315140946413,5.32116645988792,5.39918151031172,5.47719656073551,5.55521161115931,5.63322666158311,5.7112417120069,5.7892567624307,5.8672718128545],[0.162902964042462,0.240918014466257,0.318933064890053,0.39694811531385,0.474963165737646,0.552978216161442,0.630993266585238,0.709008317009033,0.78702336743283,0.865038417856626,0.943053468280421,1.02106851870422,1.09908356912801,1.17709861955181,1.25511366997561,1.3331287203994,1.4111437708232,1.48915882124699,1.56717387167079,1.64518892209459,1.72320397251838,1.80121902294218,1.87923407336597,1.95724912378977,2.03526417421357,2.11327922463736,2.19129427506116,2.26930932548496,2.34732437590875,2.42533942633255,2.50335447675634,2.58136952718014,2.65938457760393,2.73739962802773,2.81541467845153,2.89342972887532,2.97144477929912,3.04945982972291,3.12747488014671,3.20548993057051,3.2835049809943,3.3615200314181,3.4395350818419,3.51755013226569,3.59556518268949,3.67358023311328,3.75159528353708,3.82961033396087,3.90762538438467,3.98564043480847,4.06365548523226,4.14167053565606,4.21968558607985,4.29770063650365,4.37571568692745,4.45373073735124,4.53174578777504,4.60976083819884,4.68777588862263,4.76579093904643,4.84380598947022,4.92182103989402,4.99983609031781,5.07785114074161,5.15586619116541,5.2338812415892,5.311896292013,5.38991134243679,5.46792639286059,5.54594144328439,5.62395649370818,5.70197154413198,5.77998659455578],[0.0756177457437426,0.153632796167538,0.231647846591334,0.309662897015131,0.387677947438926,0.465692997862723,0.543708048286518,0.621723098710314,0.699738149134111,0.777753199557907,0.855768249981702,0.933783300405499,1.0117983508293,1.08981340125309,1.16782845167689,1.24584350210068,1.32385855252448,1.40187360294828,1.47988865337207,1.55790370379587,1.63591875421966,1.71393380464346,1.79194885506725,1.86996390549105,1.94797895591485,2.02599400633864,2.10400905676244,2.18202410718624,2.26003915761003,2.33805420803383,2.41606925845762,2.49408430888142,2.57209935930522,2.65011440972901,2.72812946015281,2.8061445105766,2.8841595610004,2.96217461142419,3.04018966184799,3.11820471227179,3.19621976269558,3.27423481311938,3.35224986354318,3.43026491396697,3.50827996439077,3.58629501481456,3.66431006523836,3.74232511566216,3.82034016608595,3.89835521650975,3.97637026693354,4.05438531735734,4.13240036778113,4.21041541820493,4.28843046862873,4.36644551905252,4.44446056947632,4.52247561990012,4.60049067032391,4.67850572074771,4.7565207711715,4.8345358215953,4.9125508720191,4.99056592244289,5.06858097286669,5.14659602329048,5.22461107371428,5.30262612413807,5.38064117456187,5.45865622498567,5.53667127540946,5.61468632583326,5.69270137625706],[-0.0116674725549784,0.0663475778688172,0.144362628292613,0.22237767871641,0.300392729140206,0.378407779564002,0.456422829987797,0.534437880411593,0.61245293083539,0.690467981259186,0.768483031682981,0.846498082106778,0.924513132530574,1.00252818295437,1.08054323337817,1.15855828380196,1.23657333422576,1.31458838464955,1.39260343507335,1.47061848549715,1.54863353592094,1.62664858634474,1.70466363676853,1.78267868719233,1.86069373761613,1.93870878803992,2.01672383846372,2.09473888888752,2.17275393931131,2.25076898973511,2.3287840401589,2.4067990905827,2.48481414100649,2.56282919143029,2.64084424185409,2.71885929227788,2.79687434270168,2.87488939312547,2.95290444354927,3.03091949397307,3.10893454439686,3.18694959482066,3.26496464524446,3.34297969566825,3.42099474609205,3.49900979651584,3.57702484693964,3.65503989736343,3.73305494778723,3.81106999821103,3.88908504863482,3.96710009905862,4.04511514948241,4.12313019990621,4.20114525033001,4.2791603007538,4.3571753511776,4.4351904016014,4.51320545202519,4.59122050244899,4.66923555287278,4.74725060329658,4.82526565372037,4.90328070414417,4.98129575456797,5.05931080499176,5.13732585541556,5.21534090583935,5.29335595626315,5.37137100668695,5.44938605711074,5.52740110753454,5.60541615795834],[-0.0989526908536984,-0.0209376404299029,0.0570774099938927,0.13509246041769,0.213107510841485,0.291122561265282,0.369137611689077,0.447152662112873,0.52516771253667,0.603182762960466,0.681197813384261,0.759212863808058,0.837227914231854,0.915242964655651,0.993258015079446,1.07127306550324,1.14928811592704,1.22730316635083,1.30531821677463,1.38333326719843,1.46134831762222,1.53936336804602,1.61737841846981,1.69539346889361,1.77340851931741,1.8514235697412,1.929438620165,2.0074536705888,2.08546872101259,2.16348377143639,2.24149882186018,2.31951387228398,2.39752892270777,2.47554397313157,2.55355902355537,2.63157407397916,2.70958912440296,2.78760417482675,2.86561922525055,2.94363427567435,3.02164932609814,3.09966437652194,3.17767942694574,3.25569447736953,3.33370952779333,3.41172457821712,3.48973962864092,3.56775467906471,3.64576972948851,3.72378477991231,3.8017998303361,3.8798148807599,3.95782993118369,4.03584498160749,4.11386003203129,4.19187508245508,4.26989013287888,4.34790518330268,4.42592023372647,4.50393528415027,4.58195033457406,4.65996538499786,4.73798043542165,4.81599548584545,4.89401053626925,4.97202558669304,5.05004063711684,5.12805568754063,5.20607073796443,5.28408578838823,5.36210083881202,5.44011588923582,5.51813093965962],[-0.186237909152418,-0.108222858728622,-0.0302078083048265,0.0478072421189708,0.125822292542766,0.203837342966563,0.281852393390358,0.359867443814154,0.437882494237951,0.515897544661747,0.593912595085542,0.671927645509339,0.749942695933135,0.827957746356931,0.905972796780727,0.983987847204522,1.06200289762832,1.14001794805212,1.21803299847591,1.29604804889971,1.3740630993235,1.4520781497473,1.53009320017109,1.60810825059489,1.68612330101869,1.76413835144248,1.84215340186628,1.92016845229008,1.99818350271387,2.07619855313767,2.15421360356146,2.23222865398526,2.31024370440906,2.38825875483285,2.46627380525665,2.54428885568044,2.62230390610424,2.70031895652803,2.77833400695183,2.85634905737563,2.93436410779942,3.01237915822322,3.09039420864702,3.16840925907081,3.24642430949461,3.3244393599184,3.4024544103422,3.480469460766,3.55848451118979,3.63649956161359,3.71451461203738,3.79252966246118,3.87054471288497,3.94855976330877,4.02657481373257,4.10458986415636,4.18260491458016,4.26061996500396,4.33863501542775,4.41665006585155,4.49466511627534,4.57268016669914,4.65069521712294,4.72871026754673,4.80672531797053,4.88474036839432,4.96275541881812,5.04077046924191,5.11878551966571,5.19680057008951,5.2748156205133,5.3528306709371,5.4308457213609],[-0.273523127451138,-0.195508077027342,-0.117493026603547,-0.0394779761797492,0.0385370742440463,0.116552124667843,0.194567175091638,0.272582225515434,0.350597275939231,0.428612326363027,0.506627376786822,0.584642427210619,0.662657477634415,0.740672528058211,0.818687578482007,0.896702628905802,0.974717679329598,1.0527327297534,1.13074778017719,1.20876283060099,1.28677788102478,1.36479293144858,1.44280798187237,1.52082303229617,1.59883808271997,1.67685313314376,1.75486818356756,1.83288323399136,1.91089828441515,1.98891333483895,2.06692838526274,2.14494343568654,2.22295848611034,2.30097353653413,2.37898858695793,2.45700363738172,2.53501868780552,2.61303373822931,2.69104878865311,2.76906383907691,2.8470788895007,2.9250939399245,3.0031089903483,3.08112404077209,3.15913909119589,3.23715414161968,3.31516919204348,3.39318424246728,3.47119929289107,3.54921434331487,3.62722939373866,3.70524444416246,3.78325949458625,3.86127454501005,3.93928959543385,4.01730464585764,4.09531969628144,4.17333474670524,4.25134979712903,4.32936484755283,4.40737989797662,4.48539494840042,4.56340999882422,4.64142504924801,4.71944009967181,4.7974551500956,4.8754702005194,4.95348525094319,5.03150030136699,5.10951535179079,5.18753040221458,5.26554545263838,5.34356050306218],[-0.360808345749859,-0.282793295326063,-0.204778244902267,-0.12676319447847,-0.0487481440546746,0.0292669063691218,0.107281956792917,0.185297007216713,0.26331205764051,0.341327108064306,0.419342158488101,0.497357208911898,0.575372259335694,0.65338730975949,0.731402360183286,0.809417410607082,0.887432461030877,0.965447511454674,1.04346256187847,1.12147761230227,1.19949266272606,1.27750771314986,1.35552276357365,1.43353781399745,1.51155286442125,1.58956791484504,1.66758296526884,1.74559801569263,1.82361306611643,1.90162811654023,1.97964316696402,2.05765821738782,2.13567326781161,2.21368831823541,2.29170336865921,2.369718419083,2.4477334695068,2.52574851993059,2.60376357035439,2.68177862077819,2.75979367120198,2.83780872162578,2.91582377204957,2.99383882247337,3.07185387289717,3.14986892332096,3.22788397374476,3.30589902416855,3.38391407459235,3.46192912501615,3.53994417543994,3.61795922586374,3.69597427628753,3.77398932671133,3.85200437713513,3.93001942755892,4.00803447798272,4.08604952840652,4.16406457883031,4.24207962925411,4.3200946796779,4.3981097301017,4.47612478052549,4.55413983094929,4.63215488137309,4.71016993179688,4.78818498222068,4.86620003264447,4.94421508306827,5.02223013349207,5.10024518391586,5.17826023433966,5.25627528476346],[-0.448093564048577,-0.370078513624781,-0.292063463200986,-0.214048412777188,-0.136033362353393,-0.0580183119295965,0.019996738494199,0.0980117889179946,0.176026839341792,0.254041889765587,0.332056940189383,0.410071990613179,0.488087041036976,0.566102091460772,0.644117141884568,0.722132192308363,0.800147242732159,0.878162293155956,0.956177343579752,1.03419239400355,1.11220744442734,1.19022249485114,1.26823754527494,1.34625259569873,1.42426764612253,1.50228269654632,1.58029774697012,1.65831279739392,1.73632784781771,1.81434289824151,1.8923579486653,1.9703729990891,2.0483880495129,2.12640309993669,2.20441815036049,2.28243320078428,2.36044825120808,2.43846330163188,2.51647835205567,2.59449340247947,2.67250845290326,2.75052350332706,2.82853855375086,2.90655360417465,2.98456865459845,3.06258370502224,3.14059875544604,3.21861380586984,3.29662885629363,3.37464390671743,3.45265895714122,3.53067400756502,3.60868905798882,3.68670410841261,3.76471915883641,3.8427342092602,3.920749259684,3.9987643101078,4.07677936053159,4.15479441095539,4.23280946137918,4.31082451180298,4.38883956222678,4.46685461265057,4.54486966307437,4.62288471349816,4.70089976392196,4.77891481434576,4.85692986476955,4.93494491519335,5.01295996561714,5.09097501604094,5.16899006646474],[-0.535378782347298,-0.457363731923502,-0.379348681499707,-0.301333631075909,-0.223318580652114,-0.145303530228317,-0.0672884798045219,0.0107265706192736,0.0887416210430709,0.166756671466866,0.244771721890662,0.322786772314458,0.400801822738255,0.478816873162051,0.556831923585847,0.634846974009642,0.712862024433438,0.790877074857235,0.868892125281031,0.946907175704826,1.02492222612862,1.10293727655242,1.18095232697621,1.25896737740001,1.33698242782381,1.4149974782476,1.4930125286714,1.5710275790952,1.64904262951899,1.72705767994279,1.80507273036658,1.88308778079038,1.96110283121418,2.03911788163797,2.11713293206177,2.19514798248556,2.27316303290936,2.35117808333315,2.42919313375695,2.50720818418075,2.58522323460454,2.66323828502834,2.74125333545214,2.81926838587593,2.89728343629973,2.97529848672352,3.05331353714732,3.13132858757112,3.20934363799491,3.28735868841871,3.3653737388425,3.4433887892663,3.52140383969009,3.59941889011389,3.67743394053769,3.75544899096148,3.83346404138528,3.91147909180908,3.98949414223287,4.06750919265667,4.14552424308046,4.22353929350426,4.30155434392806,4.37956939435185,4.45758444477565,4.53559949519944,4.61361454562324,4.69162959604703,4.76964464647083,4.84765969689463,4.92567474731842,5.00368979774222,5.08170484816602],[-0.622664000646018,-0.544648950222222,-0.466633899798427,-0.388618849374629,-0.310603798950834,-0.232588748527037,-0.154573698103242,-0.0765586476794464,0.00145640274435088,0.0794714531681464,0.157486503591942,0.235501554015738,0.313516604439535,0.391531654863331,0.469546705287127,0.547561755710922,0.625576806134718,0.703591856558515,0.781606906982311,0.859621957406106,0.937637007829902,1.0156520582537,1.09366710867749,1.17168215910129,1.24969720952509,1.32771225994888,1.40572731037268,1.48374236079648,1.56175741122027,1.63977246164407,1.71778751206786,1.79580256249166,1.87381761291546,1.95183266333925,2.02984771376305,2.10786276418684,2.18587781461064,2.26389286503443,2.34190791545823,2.41992296588203,2.49793801630582,2.57595306672962,2.65396811715342,2.73198316757721,2.80999821800101,2.8880132684248,2.9660283188486,3.0440433692724,3.12205841969619,3.20007347011999,3.27808852054378,3.35610357096758,3.43411862139137,3.51213367181517,3.59014872223897,3.66816377266276,3.74617882308656,3.82419387351036,3.90220892393415,3.98022397435795,4.05823902478174,4.13625407520554,4.21426912562934,4.29228417605313,4.37029922647693,4.44831427690072,4.52632932732452,4.60434437774831,4.68235942817211,4.76037447859591,4.8383895290197,4.9164045794435,4.9944196298673],[-0.709949218944737,-0.631934168520941,-0.553919118097146,-0.475904067673349,-0.397889017249553,-0.319873966825757,-0.241858916401961,-0.163843865978166,-0.0858288155543683,-0.00781376513057275,0.0702012852932228,0.148216335717019,0.226231386140816,0.304246436564612,0.382261486988408,0.460276537412203,0.538291587835999,0.616306638259796,0.694321688683591,0.772336739107387,0.850351789531183,0.928366839954978,1.00638189037878,1.08439694080257,1.16241199122637,1.24042704165016,1.31844209207396,1.39645714249776,1.47447219292155,1.55248724334535,1.63050229376914,1.70851734419294,1.78653239461674,1.86454744504053,1.94256249546433,2.02057754588812,2.09859259631192,2.17660764673572,2.25462269715951,2.33263774758331,2.4106527980071,2.4886678484309,2.5666828988547,2.64469794927849,2.72271299970229,2.80072805012608,2.87874310054988,2.95675815097368,3.03477320139747,3.11278825182127,3.19080330224506,3.26881835266886,3.34683340309266,3.42484845351645,3.50286350394025,3.58087855436404,3.65889360478784,3.73690865521164,3.81492370563543,3.89293875605923,3.97095380648302,4.04896885690682,4.12698390733062,4.20499895775441,4.28301400817821,4.361029058602,4.4390441090258,4.5170591594496,4.59507420987339,4.67308926029719,4.75110431072098,4.82911936114478,4.90713441156858],[-0.797234437243459,-0.719219386819663,-0.641204336395868,-0.56318928597207,-0.485174235548275,-0.407159185124478,-0.329144134700683,-0.251129084276887,-0.17311403385309,-0.0950989834292946,-0.017083933005499,0.0609311174182974,0.138946167842094,0.21696121826589,0.294976268689686,0.372991319113481,0.451006369537277,0.529021419961074,0.60703647038487,0.685051520808665,0.763066571232461,0.841081621656256,0.919096672080054,0.997111722503849,1.07512677292765,1.15314182335144,1.23115687377524,1.30917192419903,1.38718697462283,1.46520202504663,1.54321707547042,1.62123212589422,1.69924717631801,1.77726222674181,1.85527727716561,1.9332923275894,2.0113073780132,2.08932242843699,2.16733747886079,2.24535252928459,2.32336757970838,2.40138263013218,2.47939768055597,2.55741273097977,2.63542778140357,2.71344283182736,2.79145788225116,2.86947293267495,2.94748798309875,3.02550303352255,3.10351808394634,3.18153313437014,3.25954818479393,3.33756323521773,3.41557828564153,3.49359333606532,3.57160838648912,3.64962343691291,3.72763848733671,3.80565353776051,3.8836685881843,3.9616836386081,4.03969868903189,4.11771373945569,4.19572878987949,4.27374384030328,4.35175889072708,4.42977394115087,4.50778899157467,4.58580404199847,4.66381909242226,4.74183414284606,4.81984919326985],[-0.884519655542176,-0.806504605118381,-0.728489554694585,-0.650474504270788,-0.572459453846992,-0.494444403423196,-0.4164293529994,-0.338414302575605,-0.260399252151807,-0.182384201728012,-0.104369151304216,-0.02635410088042,0.0516609495433764,0.129675999967173,0.207691050390968,0.285706100814764,0.363721151238559,0.441736201662357,0.519751252086152,0.597766302509948,0.675781352933743,0.753796403357539,0.831811453781336,0.909826504205132,0.987841554628929,1.06585660505272,1.14387165547652,1.22188670590032,1.29990175632411,1.37791680674791,1.4559318571717,1.5339469075955,1.6119619580193,1.68997700844309,1.76799205886689,1.84600710929068,1.92402215971448,2.00203721013828,2.08005226056207,2.15806731098587,2.23608236140966,2.31409741183346,2.39211246225726,2.47012751268105,2.54814256310485,2.62615761352864,2.70417266395244,2.78218771437624,2.86020276480003,2.93821781522383,3.01623286564762,3.09424791607142,3.17226296649522,3.25027801691901,3.32829306734281,3.4063081177666,3.4843231681904,3.5623382186142,3.64035326903799,3.71836831946179,3.79638336988558,3.87439842030938,3.95241347073318,4.03042852115697,4.10844357158077,4.18645862200456,4.26447367242836,4.34248872285216,4.42050377327595,4.49851882369975,4.57653387412354,4.65454892454734,4.73256397497114],[-0.971804873840898,-0.893789823417102,-0.815774772993307,-0.73775972256951,-0.659744672145714,-0.581729621721918,-0.503714571298122,-0.425699520874327,-0.347684470450529,-0.269669420026734,-0.191654369602938,-0.113639319179142,-0.0356242687553454,0.042390781668451,0.120405832092247,0.198420882516042,0.276435932939838,0.354450983363635,0.43246603378743,0.510481084211226,0.588496134635021,0.666511185058817,0.744526235482614,0.82254128590641,0.900556336330207,0.978571386754003,1.0565864371778,1.1346014876016,1.21261653802539,1.29063158844919,1.36864663887298,1.44666168929678,1.52467673972057,1.60269179014437,1.68070684056817,1.75872189099196,1.83673694141576,1.91475199183955,1.99276704226335,2.07078209268715,2.14879714311094,2.22681219353474,2.30482724395854,2.38284229438233,2.46085734480613,2.53887239522992,2.61688744565372,2.69490249607751,2.77291754650131,2.85093259692511,2.9289476473489,3.0069626977727,3.08497774819649,3.16299279862029,3.24100784904409,3.31902289946788,3.39703794989168,3.47505300031548,3.55306805073927,3.63108310116307,3.70909815158686,3.78711320201066,3.86512825243446,3.94314330285825,4.02115835328205,4.09917340370584,4.17718845412964,4.25520350455343,4.33321855497723,4.41123360540103,4.48924865582482,4.56726370624862,4.64527875667242]],"text":["setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica"],"mode":"markers","marker":{"color":["red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green"]},"type":"surface","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<div id="ajuste-de-modelo" class="section level3" number="6.3.1">
<h3><span class="header-section-number">6.3.1</span> Ajuste de modelo</h3>
<div id="estimación-de-parámetros-regresión-lineal-simple" class="section level4" number="6.3.1.1">
<h4><span class="header-section-number">6.3.1.1</span> Estimación de parámetros: Regresión lineal simple</h4>
<p>En la gran mayoría de casos, los valores <span class="math inline">\(\beta_0\)</span> y <span class="math inline">\(\beta_1\)</span> poblacionales son desconocidos, por lo que, a partir de una muestra, se obtienen sus estimaciones <span class="math inline">\(\hat{\beta_0}\)</span> y <span class="math inline">\(\hat{\beta_1}\)</span>. Estas estimaciones se conocen como coeficientes de regresión o <em>least square coefficient estimates</em>, ya que toman aquellos valores que minimizan la suma de cuadrados residuales, dando lugar a la recta que pasa más cerca de todos los puntos.</p>
<p><span class="math display">\[\hat{y} = \hat{\beta}_0 + \hat{\beta}_1x\]</span></p>
<p><span class="math display">\[\hat{\beta}_1 = \frac{\sum^n_{i=1}(x_i - \overline{x})(y_i - \overline{y})}{\sum^n_{i=1}(x_i - \overline{x})^2} =\frac{S_{xy}}{S^2_x}\]</span></p>
<p><span class="math display">\[\hat{\beta}_0 = \overline{y} - \hat{\beta}_1\overline{x}\]</span></p>
<p><strong>Donde:</strong>
- <span class="math inline">\(S_{xy}\)</span> es la covarianza entre <span class="math inline">\(x\)</span> y <span class="math inline">\(y\)</span>.
- <span class="math inline">\(S_{x}^{2}\)</span> es la varianza de <span class="math inline">\(x\)</span>.
- <span class="math inline">\(\hat{\beta}_0\)</span> es el valor esperado la variable <span class="math inline">\(Y\)</span> cuando <span class="math inline">\(X = 0\)</span>, es decir, la intersección de la recta con el eje y.</p>
</div>
<div id="estimación-de-parámetros-regresión-lineal-múltiple" class="section level4" number="6.3.1.2">
<h4><span class="header-section-number">6.3.1.2</span> Estimación de parámetros: Regresión lineal múltiple</h4>
<p><span class="math display">\[Y = X\beta + \epsilon\]</span></p>
<p>siendo</p>
<p><span class="math display">\[Y = \begin{pmatrix}y_1\\y_2\\.\\.\\.\\y_n\end{pmatrix} \quad \beta = \begin{pmatrix}\beta_0\\\beta_1\\.\\.\\.\\\beta_m\end{pmatrix} \quad \epsilon = \begin{pmatrix}\epsilon_1\\\epsilon_2\\.\\.\\.\\\epsilon_n\end{pmatrix} \quad \quad X = \begin{pmatrix}1 &amp; x_{11} &amp; x_{12} &amp; ... &amp; x_{1m}\\1 &amp; x_{21} &amp; x_{22} &amp; ... &amp; x_{2m}\\\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots\\ 1 &amp; x_{n1} &amp; x_{n2} &amp; ... &amp; x_{nm}\end{pmatrix}\\\]</span></p>
<p>El estimador por mínimos cuadrados está dado por:</p>
<p><span class="math display">\[\hat{\beta} = (X^TX)^{-1}X^TY\]</span></p>
</div>
</div>
<div id="residuos-del-modelo" class="section level3" number="6.3.2">
<h3><span class="header-section-number">6.3.2</span> Residuos del modelo</h3>
<p>El residuo de una estimación se define como la diferencia entre el valor observado y el valor esperado acorde al modelo. A la hora de contemplar el conjunto de residuos hay dos posibilidades:</p>
<ul>
<li><p>La suma del valor absoluto de cada residuo.</p></li>
<li><p>La suma del cuadrado de cada residuo (RSS). Esta es la aproximación más empleada (mínimos cuadrados) ya que magnifica las desviaciones más extremas.</p></li>
</ul>
<p>Los residuos son muy importantes puesto que en ellos se basan las diferentes métricas de desempeño del modelo.</p>
<div id="condiciones-para-el-ajuste-de-una-regresión-lineal" class="section level4" number="6.3.2.1">
<h4><span class="header-section-number">6.3.2.1</span> Condiciones para el ajuste de una regresión lineal:</h4>
<p>Existen ciertas condiciones o supuestos que deben ser validados para el correcto ajuste de un modelo de regresión lineal, los cuales se enlistan a continuación:</p>
<ul>
<li><p><strong>Linealidad</strong>: La relación entre ambas variables debe ser lineal.</p></li>
<li><p><strong>Distribución Normal de los residuos</strong>: Los residuos se tiene que distribuir de forma normal, con media igual a 0.</p></li>
<li><p><strong>Varianza de residuos constante (homocedasticidad)</strong>: La varianza de los residuos tiene que ser aproximadamente constante.</p></li>
<li><p><strong>Independencia, Autocorrelación</strong>: Las observaciones deben ser independientes unas de otras.</p></li>
</ul>
<p>Dado que las condiciones se verifican a partir de los residuos, primero se suele generar el modelo y después se valida.</p>
</div>
</div>
<div id="métricas-de-desempeño" class="section level3" number="6.3.3">
<h3><span class="header-section-number">6.3.3</span> Métricas de desempeño</h3>
<p>Dado que nuestra variable a predecir es numérica, podemos medir qué tan cerca o lejos estuvimos del número esperado dada una predicción.</p>
<p>Las métricas de desempeño asociadas a los problemas de regresión ocupan esa distancia cómo cuantificación del desempeño o de los errores cometidos por el modelo.</p>
<p>Las métricas más utilizadas son:</p>
<ul>
<li><strong>MAE</strong>: <em>Mean Absolute Error</em></li>
</ul>
<p><span class="math display">\[MAE = \frac{1}{N}\sum_{i=1}^{N}{|y_{i}-\hat{y}_{i}|}\]</span>
<strong>Donde:</strong></p>
<ul>
<li><span class="math inline">\(N:\)</span> Número de observaciones predichas.</li>
<li><span class="math inline">\(y_{i}:\)</span> Valor real.</li>
<li><span class="math inline">\(\hat{y}_{i}:\)</span> Valor de la predicción.</li>
</ul>
<p><br></p>
<p>Esta métrica suma los errores absolutos de cada predicción y los divide entre el número de observaciones, para obtener el promedio absoluto del error del modelo.</p>
<p>Una de las desventajas es que todos los errores pesan lo mismo sin importar qué tan pequeños o qué tan grandes sean, es muy sensible a valores atípicos, y dado que obtiene el promedio puede ser que un solo error en la predicción que sea muy grande afecte al valor de todo el modelo, aún y cuando el modelo no tuvo errores tan malos para el resto de las observaciones.</p>
<p>Se recomienda utilizar esta métrica cuando los errores importan lo mismo, es decir, importa lo mismo si se equivocó muy poco o se equivocó mucho.</p>
<ul>
<li><strong>MAPE</strong>: <em>Mean Absolute Percentage Error</em></li>
</ul>
<p><span class="math display">\[MAPE = \frac{1}{N}\sum_{i=1}^{N}\frac{{|y_{i}-\hat{y}_{i}|}}{|y_{i}|}\]</span>
<strong>Donde:</strong></p>
<p><span class="math inline">\(N:\)</span> Número de observaciones predichas.</p>
<p><span class="math inline">\(y_{i}:\)</span> Valor real.</p>
<p><span class="math inline">\(\hat{y}_{i}:\)</span> Valor de la predicción.</p>
<p><br></p>
<p>Esta métrica es la métrica MAE expresada en porcentaje, por lo que mide el error del modelo en términos de porcentaje, al igual que con MAE, no hay errores negativos por el valor absoluto, y mientras más pequeño el error es mejor.</p>
<p>Una de las grandes desventajas de esta métrica, es que cuando existe un valor real de 0 esta métrica no se puede calcular, por otro lado, una de las ventajas sobre MAE es que no es sensible a valores atípicos.</p>
<p>Se recomienda utilizar esta métrica cuando en tu problema no haya valores a predecir que puedan ser 0, por ejemplo, en ventas puedes llegar a tener 0 ventas, en este caso no podemos ocupar esta métrica.</p>
<p>Cuando los valores a predecir no tienen un rango muy grande, ya que pueden provocar errores con porcentajes sumamente altos! por ejemplo, porcentajes de un millón por ciento.</p>
<p>En general a las personas de negocio les gusta esta métrica pues es fácil de comprender.</p>
<ul>
<li><strong>RMSE</strong>: <em>Root Mean Squared Error</em></li>
</ul>
<p><span class="math display">\[RMSE = \sqrt{\frac{1}{N}\sum_{i=1}^{N}{(y_{i}-\hat{y}_{i})^2}}\]</span>
<strong>Donde:</strong></p>
<ul>
<li><span class="math inline">\(N:\)</span> Número de observaciones predichas.</li>
<li><span class="math inline">\(y_{i}:\)</span> Valor real.</li>
<li><span class="math inline">\(\hat{y}_{i}:\)</span> Valor de la predicción.</li>
</ul>
<p><br></p>
<p>Esta métrica es muy parecida a MAE, solo que en lugar de sacar el valor absoluto de la diferencia entre el valor real y el valor predicho, para evitar valores negativos eleva esta diferencia al cuadrado, y saca el promedio de esa diferencia, al final, para dejar el valor en la escala inicial saca la raíz cuadrada.</p>
<p>Esta es la métrica más utilizada en problemas de regresión, debido a que es más fácil de optimizar que el MAE.</p>
<p>Una de las desventajas es que todos los errores pesan lo mismo sin importar qué tan pequeños o qué tan grandes sean, es más sensible a valores atípicos que MAE pues eleva al cuadrado diferencias, y dado que obtiene el promedio puede ser que un solo error en la predicción que sea muy grande afecte al valor de todo el modelo, aún y cuando el modelo no tuvo errores tan malos para el resto de las observaciones.</p>
<p>Se recomienda utilizar esta métrica cuando en el problema que queremos resolver es muy costoso tener equivocaciones grandes, podemos tener varios errores pequeños, pero no grandes.</p>
<ul>
<li><strong><span class="math inline">\(R^2\)</span></strong>: <em>R cuadrada</em></li>
</ul>
<p><span class="math display">\[R^{2} = \frac{\sum_{i=1}^{N}{(\hat{y}_{i}-\bar{y}_{i})^2}}{\sum_{i=1}^{N}{(y_{i}-\bar{y}_{i})^2}}\]</span>
<strong>Donde:</strong></p>
<ul>
<li><span class="math inline">\(N:\)</span> Número de observaciones predichas.</li>
<li><span class="math inline">\(y_{i}:\)</span> Valor real.</li>
<li><span class="math inline">\(\hat{y}_{i}:\)</span> Valor de la predicción.</li>
<li><span class="math inline">\(\bar{y}_{i}:\)</span> Valor promedio de la variable <em>y</em>.</li>
</ul>
<p><br></p>
<p>El coeficiente de determinación es la proporción de la varianza total de la variable explicada por la regresión. El coeficiente de determinación, también llamado R cuadrado, refleja la bondad del ajuste de un modelo a la variable que pretender explicar.</p>
<p>Es importante saber que el resultado del coeficiente de determinación oscila entre 0 y 1. Cuanto más cerca de 1 se sitúe su valor, mayor será el ajuste del modelo a la variable que estamos intentando explicar. De forma inversa, cuanto más cerca de cero, menos ajustado estará el modelo y, por tanto, menos fiable será.</p>
<p>El problema del coeficiente de determinación, y razón por el cual surge el coeficiente de determinación ajustado, radica en que no penaliza la inclusión de variables explicativas no significativas.</p>
<ul>
<li><strong><span class="math inline">\(\bar{R}^2\)</span></strong>: <em><span class="math inline">\(R^2\)</span> ajustada</em></li>
</ul>
<p><span class="math display">\[\bar{R}^2=1-\frac{N-1}{N-k-1}[1-R^2]\]</span>
<strong>Donde:</strong></p>
<ul>
<li><span class="math inline">\(\bar{R}²:\)</span> Es el valor de R² ajustado</li>
<li><span class="math inline">\(R²:\)</span> Es el valor de R² original</li>
<li><span class="math inline">\(N:\)</span> Es el total de observaciones en el ajuste</li>
<li><span class="math inline">\(k:\)</span> Es el número de variables usadas en el modelo</li>
</ul>
<p><br></p>
<p>El coeficiente de determinación ajustado (R cuadrado ajustado) es la medida que define el porcentaje explicado por la varianza de la regresión en relación con la varianza de la variable explicada. Es decir, lo mismo que el R cuadrado, pero con una diferencia: El coeficiente de determinación ajustado penaliza la inclusión de variables.</p>
<p>En la fórmula, N es el tamaño de la muestra y k el número de variables explicativas.</p>
<ul>
<li><strong>RMSLE</strong>: <em>Root Mean Squared Logarithmic Loss Error</em></li>
</ul>
<p><span class="math display">\[e = \sqrt{\frac{1}{n}\sum_{i=1}^{n} (log(1+p(i))-log(1+o(i)))^2}\]</span>
Donde: <span class="math inline">\(p(i)\)</span> son las predicciones y <span class="math inline">\(o(i)\)</span> son las observaciones, esto implica que nos interesa más evaluar error relativo que absoluto, pues:</p>
<p><span class="math display">\[log(1+p)-log(1+o)=log(\frac{1+p}{1+o})\approx log(\frac{p}{o})=log(1+\frac{p-o}{o})\approx\frac{p-o}{p}\]</span></p>
<p>cuando el error relativo <span class="math inline">\(\frac{|p-o|}{|o|}\)</span> es chico, menor a .2 por ejemplo, y <span class="math inline">\(o\)</span> y <span class="math inline">\(p\)</span> son grandes.</p>
</div>
<div id="implementación-en-r" class="section level3" number="6.3.4">
<h3><span class="header-section-number">6.3.4</span> Implementación en R</h3>
<p>Ajustaremos un modelo de regresión usando la receta antes vista.</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="machine-learning-aprendizaje-supervisado.html#cb143-1" aria-hidden="true" tabindex="-1"></a>modelo1 <span class="ot">&lt;-</span>  <span class="fu">linear_reg</span>() <span class="sc">%&gt;%</span></span>
<span id="cb143-2"><a href="machine-learning-aprendizaje-supervisado.html#cb143-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">&quot;regression&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb143-3"><a href="machine-learning-aprendizaje-supervisado.html#cb143-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">&quot;lm&quot;</span>)</span>
<span id="cb143-4"><a href="machine-learning-aprendizaje-supervisado.html#cb143-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-5"><a href="machine-learning-aprendizaje-supervisado.html#cb143-5" aria-hidden="true" tabindex="-1"></a>lm_fit1 <span class="ot">&lt;-</span> <span class="fu">fit</span>(modelo1, Log_SalePrice <span class="sc">~</span> ., casa_juiced)</span>
<span id="cb143-6"><a href="machine-learning-aprendizaje-supervisado.html#cb143-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-7"><a href="machine-learning-aprendizaje-supervisado.html#cb143-7" aria-hidden="true" tabindex="-1"></a>p_test <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm_fit1,casa_test_bake) <span class="sc">%&gt;%</span></span>
<span id="cb143-8"><a href="machine-learning-aprendizaje-supervisado.html#cb143-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(ames_test)  <span class="sc">%&gt;%</span> </span>
<span id="cb143-9"><a href="machine-learning-aprendizaje-supervisado.html#cb143-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">.pred=</span><span class="fu">exp</span>(.pred), <span class="at">SalePrice =</span> <span class="fu">exp</span>(Log_SalePrice))</span></code></pre></div>
</div>
<div id="coeficientes-del-modelo" class="section level3" number="6.3.5">
<h3><span class="header-section-number">6.3.5</span> Coeficientes del modelo</h3>
<p>Podemos recuperar los coeficientes de nuestro modelo con la función <em>tidy()</em> y observar cuales variables explicativas son las más significativas de acuerdo con el <em>p-value</em>.</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="machine-learning-aprendizaje-supervisado.html#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lm_fit1) <span class="sc">%&gt;%</span> </span>
<span id="cb144-2"><a href="machine-learning-aprendizaje-supervisado.html#cb144-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(p.value)</span></code></pre></div>
<pre><code>## # A tibble: 370 × 5
##    term                                   estimate std.error statistic  p.value
##    &lt;chr&gt;                                     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
##  1 (Intercept)                                6.54     0.457     14.3  4.94e-44
##  2 Roof_Matl_WdShngl                          2.99     0.214     13.9  5.52e-42
##  3 Roof_Matl_CompShg                          2.83     0.211     13.4  5.62e-39
##  4 Roof_Matl_Tar.Grv                          2.88     0.219     13.1  1.40e-37
##  5 Roof_Matl_WdShake                          2.80     0.217     12.9  2.80e-36
##  6 Roof_Matl_Metal                            2.98     0.249     12.0  7.33e-32
##  7 Neighborhood_Edwards_x_Condition_1_Pos    -1.57     0.164     -9.61 2.37e-21
##  8 Misc_Feature_Gar2                          2.17     0.244      8.88 1.65e-18
##  9 Misc_Feature_Othr                          2.21     0.261      8.48 4.59e-17
## 10 Misc_Feature_Shed                          2.17     0.268      8.11 9.16e-16
## # … with 360 more rows</code></pre>
</div>
<div id="métricas-de-desempeño-1" class="section level3" number="6.3.6">
<h3><span class="header-section-number">6.3.6</span> Métricas de desempeño</h3>
<p>Ahora para calcular las métricas de desempeño usaremos la paqueteria <em>MLmetrics</em></p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="machine-learning-aprendizaje-supervisado.html#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MLmetrics)</span></code></pre></div>
<p><strong>MAE</strong></p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="machine-learning-aprendizaje-supervisado.html#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(p_test,MLmetrics<span class="sc">::</span><span class="fu">MAE</span>(.pred, SalePrice))</span></code></pre></div>
<pre><code>## [1] 15963.89</code></pre>
<p><strong>MAPE</strong></p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="machine-learning-aprendizaje-supervisado.html#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(p_test,MLmetrics<span class="sc">::</span><span class="fu">MAPE</span>(.pred, SalePrice))</span></code></pre></div>
<pre><code>## [1] 0.09136462</code></pre>
<p><strong>RMSE</strong></p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="machine-learning-aprendizaje-supervisado.html#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(p_test,MLmetrics<span class="sc">::</span><span class="fu">RMSE</span>(.pred, SalePrice))</span></code></pre></div>
<pre><code>## [1] 25234.92</code></pre>
<p><strong><span class="math inline">\(R^2\)</span></strong></p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="machine-learning-aprendizaje-supervisado.html#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(p_test,MLmetrics<span class="sc">::</span><span class="fu">R2_Score</span>(.pred, SalePrice))</span></code></pre></div>
<pre><code>## [1] 0.9012817</code></pre>
<p><strong>RMSLE</strong></p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="machine-learning-aprendizaje-supervisado.html#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(p_test,MLmetrics<span class="sc">::</span><span class="fu">RMSLE</span>(.pred, SalePrice))</span></code></pre></div>
<pre><code>## [1] 0.1933594</code></pre>
</div>
</div>
<div id="métodos-se-selección-de-variables" class="section level2" number="6.4">
<h2><span class="header-section-number">6.4</span> Métodos se selección de variables</h2>
<div id="forward-selection-selección-hacia-adelante" class="section level3" number="6.4.1">
<h3><span class="header-section-number">6.4.1</span> Forward selection (selección hacia adelante)</h3>
<p>Comienza sin predictores en el modelo, agrega iterativamente los predictores más contribuyentes y se detiene cuando la mejora del modelo ya no es estadísticamente significativa.</p>
<p><img src="img/ml/3-6-1-1-forward-selection.png" width="350pt" height="400pt" style="display: block; margin: auto;" /></p>
<p>La función <code>train()</code> del paquete <em>caret</em> proporciona un flujo de trabajo sencillo
para realizar la selección de variables utilizando los paquetes <em>leaps</em> y <em>MASS</em>.</p>
<p>Tiene una opción denominada método, que puede tomar los siguientes valores:</p>
<ul>
<li>“LeapBackward” para ajustar la regresión lineal con la selección hacia atrás</li>
<li>“leapForward” para ajustar la regresión lineal con la selección hacia adelante</li>
<li>“leapSeq” para ajustar la regresión lineal con la selección por pasos</li>
</ul>
<p>También es necesario especificar el parámetro de ajuste <code>nvmax</code>,
que corresponde al número máximo de predictores que se incorporarán al modelo.</p>
<p>Por ejemplo, <code>nvmax</code> puede variar de 1 a 5. En este caso, la función comienza
buscando diferentes mejores modelos de diferente tamaño, hasta el mejor modelo
de 5 variables. Es decir, busca el mejor modelo de 1 variable,
el mejor modelo de 2 variables, … , el mejor modelo de 5 variables.</p>
<p>Usaremos una validación cruzada de 10 veces para estimar el error de predicción
promedio (<em>RMSE</em>) de cada uno de los 5 modelos.</p>
<p>La métrica estadística <em>RMSE</em> se utiliza para comparar los 5 modelos y elegir
automáticamente el mejor, donde mejor se define como el modelo que minimiza el <em>RMSE</em></p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="machine-learning-aprendizaje-supervisado.html#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span></code></pre></div>
<pre><code>## Loading required package: lattice</code></pre>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="machine-learning-aprendizaje-supervisado.html#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb159-2"><a href="machine-learning-aprendizaje-supervisado.html#cb159-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-3"><a href="machine-learning-aprendizaje-supervisado.html#cb159-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(doParallel)</span></code></pre></div>
<pre><code>## Loading required package: foreach</code></pre>
<pre><code>## 
## Attaching package: &#39;foreach&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:purrr&#39;:
## 
##     accumulate, when</code></pre>
<pre><code>## Loading required package: iterators</code></pre>
<pre><code>## Loading required package: parallel</code></pre>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="machine-learning-aprendizaje-supervisado.html#cb165-1" aria-hidden="true" tabindex="-1"></a>UseCores <span class="ot">&lt;-</span> <span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb165-2"><a href="machine-learning-aprendizaje-supervisado.html#cb165-2" aria-hidden="true" tabindex="-1"></a>cluster <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(UseCores)</span>
<span id="cb165-3"><a href="machine-learning-aprendizaje-supervisado.html#cb165-3" aria-hidden="true" tabindex="-1"></a><span class="fu">registerDoParallel</span>(cluster)</span>
<span id="cb165-4"><a href="machine-learning-aprendizaje-supervisado.html#cb165-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-5"><a href="machine-learning-aprendizaje-supervisado.html#cb165-5" aria-hidden="true" tabindex="-1"></a>forward_model <span class="ot">&lt;-</span> <span class="fu">train</span>(</span>
<span id="cb165-6"><a href="machine-learning-aprendizaje-supervisado.html#cb165-6" aria-hidden="true" tabindex="-1"></a>  Sale_Price <span class="sc">~</span> Year_Built <span class="sc">+</span> Bldg_Type,</span>
<span id="cb165-7"><a href="machine-learning-aprendizaje-supervisado.html#cb165-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> ames, <span class="at">method =</span> <span class="st">&quot;leapForward&quot;</span>, <span class="at">tuneGrid =</span> <span class="fu">data.frame</span>(<span class="at">nvmax =</span><span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>), </span>
<span id="cb165-8"><a href="machine-learning-aprendizaje-supervisado.html#cb165-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">trContro =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;cv&quot;</span>, <span class="at">number =</span> <span class="dv">10</span>))</span>
<span id="cb165-9"><a href="machine-learning-aprendizaje-supervisado.html#cb165-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-10"><a href="machine-learning-aprendizaje-supervisado.html#cb165-10" aria-hidden="true" tabindex="-1"></a>forward_model<span class="sc">$</span>results</span></code></pre></div>
<pre><code>##   nvmax     RMSE  Rsquared      MAE   RMSESD RsquaredSD    MAESD
## 1     1 65975.79 0.3137983 47033.10 2634.081 0.01897098 961.7005
## 2     2 64827.47 0.3375825 46080.90 2607.547 0.01925397 911.8713
## 3     3 64371.61 0.3468708 45875.79 2579.243 0.01892329 879.2333
## 4     4 63814.52 0.3583406 45385.38 2575.524 0.01841327 868.1283
## 5     5 63827.10 0.3580840 45399.20 2574.486 0.01835704 872.5526</code></pre>
<p>El resultado anterior muestra diferentes métricas y su desviación estándar para
comparar la precisión de los 5 mejores modelos. Las columnas son:</p>
<ul>
<li><p><code>nvmax</code>: el número de variables en el modelo. Por ejemplo <code>nvmax = 2</code>, especifica el mejor modelo de 2 variables.</p></li>
<li><p><em>RMSE</em> y <em>MAE</em> son dos métricas diferentes que miden el error de predicción de cada modelo. Cuanto menor sea el <em>RMSE</em> y <em>MAE</em>, mejor será el modelo.</p></li>
<li><p><em>Rsquared</em> (<span class="math inline">\(R^2\)</span>) indica la correlación entre los valores de resultado observados y los valores predichos por el modelo. Cuanto mayor sea la <span class="math inline">\(R^2\)</span>, mejor será el modelo.</p></li>
</ul>
<p>En nuestro ejemplo, se puede ver que el modelo con 4 variables es el que tiene el
<em>RMSE</em> más bajo. Se puede obtener el mejor valor de ajuste (<code>nvmax</code>), seleccionados automáticamente por la función <code>train()</code>, de la siguiente manera:</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="machine-learning-aprendizaje-supervisado.html#cb167-1" aria-hidden="true" tabindex="-1"></a>forward_model<span class="sc">$</span>bestTune</span></code></pre></div>
<pre><code>##   nvmax
## 4     4</code></pre>
<p>La función <code>summary()</code> reporta el mejor conjunto de variables para cada tamaño
de modelo, hasta el mejor modelo de 4 variables.</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="machine-learning-aprendizaje-supervisado.html#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(forward_model)</span></code></pre></div>
<pre><code>## Subset selection object
## 5 Variables  (and intercept)
##                   Forced in Forced out
## Year_Built            FALSE      FALSE
## Bldg_TypeTwoFmCon     FALSE      FALSE
## Bldg_TypeDuplex       FALSE      FALSE
## Bldg_TypeTwnhs        FALSE      FALSE
## Bldg_TypeTwnhsE       FALSE      FALSE
## 1 subsets of each size up to 4
## Selection Algorithm: forward
##          Year_Built Bldg_TypeTwoFmCon Bldg_TypeDuplex Bldg_TypeTwnhs
## 1  ( 1 ) &quot;*&quot;        &quot; &quot;               &quot; &quot;             &quot; &quot;           
## 2  ( 1 ) &quot;*&quot;        &quot; &quot;               &quot; &quot;             &quot;*&quot;           
## 3  ( 1 ) &quot;*&quot;        &quot; &quot;               &quot; &quot;             &quot;*&quot;           
## 4  ( 1 ) &quot;*&quot;        &quot; &quot;               &quot;*&quot;             &quot;*&quot;           
##          Bldg_TypeTwnhsE
## 1  ( 1 ) &quot; &quot;            
## 2  ( 1 ) &quot; &quot;            
## 3  ( 1 ) &quot;*&quot;            
## 4  ( 1 ) &quot;*&quot;</code></pre>
<p>Un asterisco especifica que la variable se incluye en el modelo correspondiente.</p>
<div id="backward-selection-selección-hacia-atrás" class="section level4" number="6.4.1.1">
<h4><span class="header-section-number">6.4.1.1</span> Backward selection (selección hacia atrás)</h4>
<p>Comienza con todos los predictores en el modelo (modelo completo), y elimina iterativamente los
predictores menos contribuyentes y se detiene cuando tiene un modelo en el que
todos los predictores son estadísticamente significativos.</p>
<p><img src="img/ml/3-6-1-2-backward-selection.png" width="350pt" height="400pt" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="machine-learning-aprendizaje-supervisado.html#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb171-2"><a href="machine-learning-aprendizaje-supervisado.html#cb171-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-3"><a href="machine-learning-aprendizaje-supervisado.html#cb171-3" aria-hidden="true" tabindex="-1"></a>backward_model <span class="ot">&lt;-</span> <span class="fu">train</span>(</span>
<span id="cb171-4"><a href="machine-learning-aprendizaje-supervisado.html#cb171-4" aria-hidden="true" tabindex="-1"></a>  Sale_Price <span class="sc">~</span> Year_Built <span class="sc">+</span> Bldg_Type,</span>
<span id="cb171-5"><a href="machine-learning-aprendizaje-supervisado.html#cb171-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> ames, <span class="at">method =</span> <span class="st">&quot;leapBackward&quot;</span>, <span class="at">tuneGrid =</span> <span class="fu">data.frame</span>(<span class="at">nvmax =</span><span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>), </span>
<span id="cb171-6"><a href="machine-learning-aprendizaje-supervisado.html#cb171-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;cv&quot;</span>, <span class="at">number =</span> <span class="dv">10</span>))</span>
<span id="cb171-7"><a href="machine-learning-aprendizaje-supervisado.html#cb171-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-8"><a href="machine-learning-aprendizaje-supervisado.html#cb171-8" aria-hidden="true" tabindex="-1"></a>backward_model<span class="sc">$</span>results</span></code></pre></div>
<pre><code>##   nvmax     RMSE  Rsquared      MAE   RMSESD RsquaredSD    MAESD
## 1     1 66061.59 0.3171505 46898.51 5663.063 0.04126243 2640.400
## 2     2 64957.33 0.3398822 45981.78 5640.144 0.04117377 2570.204
## 3     3 64422.01 0.3507725 45773.94 5516.025 0.03942256 2620.756
## 4     4 63967.84 0.3597521 45326.43 5365.403 0.03701859 2449.530
## 5     5 63974.95 0.3596118 45334.15 5365.339 0.03703523 2452.353</code></pre>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="machine-learning-aprendizaje-supervisado.html#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(backward_model)</span></code></pre></div>
<pre><code>## Subset selection object
## 5 Variables  (and intercept)
##                   Forced in Forced out
## Year_Built            FALSE      FALSE
## Bldg_TypeTwoFmCon     FALSE      FALSE
## Bldg_TypeDuplex       FALSE      FALSE
## Bldg_TypeTwnhs        FALSE      FALSE
## Bldg_TypeTwnhsE       FALSE      FALSE
## 1 subsets of each size up to 4
## Selection Algorithm: backward
##          Year_Built Bldg_TypeTwoFmCon Bldg_TypeDuplex Bldg_TypeTwnhs
## 1  ( 1 ) &quot;*&quot;        &quot; &quot;               &quot; &quot;             &quot; &quot;           
## 2  ( 1 ) &quot;*&quot;        &quot; &quot;               &quot; &quot;             &quot;*&quot;           
## 3  ( 1 ) &quot;*&quot;        &quot; &quot;               &quot; &quot;             &quot;*&quot;           
## 4  ( 1 ) &quot;*&quot;        &quot; &quot;               &quot;*&quot;             &quot;*&quot;           
##          Bldg_TypeTwnhsE
## 1  ( 1 ) &quot; &quot;            
## 2  ( 1 ) &quot; &quot;            
## 3  ( 1 ) &quot;*&quot;            
## 4  ( 1 ) &quot;*&quot;</code></pre>
</div>
<div id="stepwise-selection-selección-paso-a-paso" class="section level4" number="6.4.1.2">
<h4><span class="header-section-number">6.4.1.2</span> Stepwise selection (selección paso a paso)</h4>
<p>Combinación de selecciones hacia adelante y hacia atrás.
Comienza sin predictores, luego agrega secuencialmente los predictores más contribuyentes (como la selección hacia adelante). Después de agregar cada nueva variable, elimina cualquier variable que ya no proporcione una mejora en el ajuste del modelo (como la selección hacia atrás).</p>
<p><img src="img/ml/3-6-1-3-stepwise-selection.png" width="700pt" height="600pt" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="machine-learning-aprendizaje-supervisado.html#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb175-2"><a href="machine-learning-aprendizaje-supervisado.html#cb175-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-3"><a href="machine-learning-aprendizaje-supervisado.html#cb175-3" aria-hidden="true" tabindex="-1"></a>stepwise_model <span class="ot">&lt;-</span> <span class="fu">train</span>(</span>
<span id="cb175-4"><a href="machine-learning-aprendizaje-supervisado.html#cb175-4" aria-hidden="true" tabindex="-1"></a>  Sale_Price <span class="sc">~</span> Year_Built <span class="sc">+</span> Bldg_Type,</span>
<span id="cb175-5"><a href="machine-learning-aprendizaje-supervisado.html#cb175-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> ames, <span class="at">method =</span> <span class="st">&quot;leapSeq&quot;</span>, <span class="at">tuneGrid =</span> <span class="fu">data.frame</span>(<span class="at">nvmax =</span><span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>), </span>
<span id="cb175-6"><a href="machine-learning-aprendizaje-supervisado.html#cb175-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;cv&quot;</span>, <span class="at">number =</span> <span class="dv">10</span>))</span>
<span id="cb175-7"><a href="machine-learning-aprendizaje-supervisado.html#cb175-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-8"><a href="machine-learning-aprendizaje-supervisado.html#cb175-8" aria-hidden="true" tabindex="-1"></a><span class="fu">stopCluster</span>(cluster)</span>
<span id="cb175-9"><a href="machine-learning-aprendizaje-supervisado.html#cb175-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-10"><a href="machine-learning-aprendizaje-supervisado.html#cb175-10" aria-hidden="true" tabindex="-1"></a>stepwise_model<span class="sc">$</span>results</span></code></pre></div>
<pre><code>##   nvmax     RMSE  Rsquared      MAE   RMSESD RsquaredSD    MAESD
## 1     1 66061.59 0.3171505 46898.51 5663.063 0.04126243 2640.400
## 2     2 64957.33 0.3398822 45981.78 5640.144 0.04117377 2570.204
## 3     3 64422.01 0.3507725 45773.94 5516.025 0.03942256 2620.756
## 4     4 63967.84 0.3597521 45326.43 5365.403 0.03701859 2449.530
## 5     5 63974.95 0.3596118 45334.15 5365.339 0.03703523 2452.353</code></pre>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="machine-learning-aprendizaje-supervisado.html#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(stepwise_model)</span></code></pre></div>
<pre><code>## Subset selection object
## 5 Variables  (and intercept)
##                   Forced in Forced out
## Year_Built            FALSE      FALSE
## Bldg_TypeTwoFmCon     FALSE      FALSE
## Bldg_TypeDuplex       FALSE      FALSE
## Bldg_TypeTwnhs        FALSE      FALSE
## Bldg_TypeTwnhsE       FALSE      FALSE
## 1 subsets of each size up to 4
## Selection Algorithm: &#39;sequential replacement&#39;
##          Year_Built Bldg_TypeTwoFmCon Bldg_TypeDuplex Bldg_TypeTwnhs
## 1  ( 1 ) &quot;*&quot;        &quot; &quot;               &quot; &quot;             &quot; &quot;           
## 2  ( 1 ) &quot;*&quot;        &quot; &quot;               &quot; &quot;             &quot;*&quot;           
## 3  ( 1 ) &quot;*&quot;        &quot; &quot;               &quot; &quot;             &quot;*&quot;           
## 4  ( 1 ) &quot;*&quot;        &quot; &quot;               &quot;*&quot;             &quot;*&quot;           
##          Bldg_TypeTwnhsE
## 1  ( 1 ) &quot; &quot;            
## 2  ( 1 ) &quot; &quot;            
## 3  ( 1 ) &quot;*&quot;            
## 4  ( 1 ) &quot;*&quot;</code></pre>
</div>
</div>
<div id="desventajas-de-la-selección-forward-backward-y-stepwise" class="section level3" number="6.4.2">
<h3><span class="header-section-number">6.4.2</span> Desventajas de la selección forward, backward y stepwise</h3>
<p><strong>Inflación de resultados falsos positivos:</strong> la selección hacia adelante, hacia atrás
y paso a paso utiliza muchas pruebas de hipótesis repetidas para tomar decisiones
sobre la inclusión o exclusión de predictores individuales.</p>
<p>Los valores <span class="math inline">\(p\)</span> correspondientes no están ajustados, lo que lleva a una selección
excesiva de características (es decir, resultados falsos positivos).
Además, este problema se agrava cuando están presentes predictores altamente correlacionados.</p>
<p><strong>Sobreajuste del modelo:</strong> Las estadísticas del modelo resultante, incluidas
las estimaciones de los parámetros y la incertidumbre asociada, son muy optimistas
ya que no tienen en cuenta el proceso de selección.</p>
</div>
</div>
<div id="regresión-logística" class="section level2" number="6.5">
<h2><span class="header-section-number">6.5</span> Regresión logística</h2>
<p>En esta sección aprenderemos sobre regresión logística, como se ajusta un modelo de regresión logística en R con <em>tidymodels</em>, las métricas de desempeño para problemas de clasificación y como podemos comparar modelos con estas métricas.</p>
<p>Al igual que en regresión lineal, existen dos tipos de modelos de regresión logística: regresión simple y regresión múltiple. La regresión logística simple es cuando se utiliza <strong>una</strong> variable independiente para <strong>estimar la probabilidad de pertenecer a un grupo de una variable cualitativa binaria</strong>. Cuando se utiliza <strong>más de una</strong> variable independiente, el proceso se denomina regresión logística múltiple.</p>
<div id="función-sigmoide" class="section level3" number="6.5.1">
<h3><span class="header-section-number">6.5.1</span> Función sigmoide</h3>
<p>Si una variable cualitativa con dos categorías se codifica como 1 y 0, matemáticamente es posible ajustar un modelo de regresión lineal por mínimos cuadrados. El problema de esta aproximación es que, al tratarse de una recta, para valores extremos del predictor, se obtienen valores de <span class="math inline">\(Y\)</span> menores que 0 o mayores que 1, lo que entra en contradicción con el hecho de que las probabilidades siempre están dentro del rango [0,1].</p>
<p>Para evitar estos problemas, la regresión logística transforma el valor devuelto por la regresión lineal empleando una función cuyo resultado está siempre comprendido entre 0 y 1. Existen varias funciones que cumplen esta descripción, una de las más utilizadas es la función logística (también conocida como función <strong>sigmoide</strong>):</p>
<p><span class="math display">\[\sigma(x)=\frac{1}{1+e^{-x}}\]</span>
Función sigmoide:</p>
<p><img src="img/ml/3-8-1-sigmoide.png" width="300pt" height="300pt" style="display: block; margin: auto;" />
Para valores de <span class="math inline">\(x\)</span> muy grandes, el valor de <span class="math inline">\(e^{-x}\)</span> es aproximadamente 0 por lo que el valor de la función sigmoide es 1. Para valores de <span class="math inline">\(x\)</span> muy negativos, el valor <span class="math inline">\(e^{-x}\)</span> tiende a infinito por lo que el valor de la función sigmoide es 0.</p>
<p>Sustituyendo la <span class="math inline">\(x\)</span> de la función sigmoide por la función lineal <span class="math inline">\(\beta_0+\beta_1X\)</span> se obtiene que:</p>
<p><span class="math display">\[P(Y=k|X=x)=\frac{e^{\beta_0+\beta_1X}}{1+e^{\beta_0+\beta_1X}}\]</span></p>
<p>donde <span class="math inline">\(P(Y=k|X=x)\)</span> puede interpretarse como: la probabilidad de que la variable cualitativa <span class="math inline">\(Y\)</span> adquiera el valor <span class="math inline">\(k\)</span>, dado que el predictor <span class="math inline">\(X\)</span> tiene el valor <span class="math inline">\(x\)</span>.</p>
<p>Esta función, puede ajustarse de forma sencilla con métodos de regresión lineal si se emplea su versión logarítmica:</p>
<p><span class="math display">\[ln(\frac{p(Y=k|X=x)}{1−p(Y=k|X=x)})=\beta_0+\beta_1X\]</span></p>
</div>
<div id="ajuste-del-modelo" class="section level3" number="6.5.2">
<h3><span class="header-section-number">6.5.2</span> Ajuste del modelo</h3>
<p>La combinación óptima de coeficientes <span class="math inline">\(\beta_0\)</span> y <span class="math inline">\(\beta_1\)</span> será aquella que tenga la máxima verosimilitud (maximum likelihood), es decir el valor de los parámetros <span class="math inline">\(\beta_0\)</span> y <span class="math inline">\(\beta_1\)</span> con los que se maximiza la probabilidad de obtener los datos observados.</p>
<p>El método de maximum likelihood está ampliamente extendido en la estadística aunque su implementación no siempre es trivial.</p>
<p>Otra forma para ajustar un modelo de regresión logística es empleando descenso de gradiente. Si bien este no es el método de optimización más adecuado para resolver la regresión logística, está muy extendido en el ámbito de machine learning para ajustar otros modelos.</p>
<p><strong>Regresión logística múltiple</strong></p>
<p>La regresión logística múltiple es una extensión de la regresión logística simple. Se basa en los mismos principios que la regresión logística simple (explicados anteriormente) pero ampliando el número de predictores. Los predictores pueden ser tanto continuos como categóricos.</p>
<p><span class="math display">\[ln(\frac{p}{1-p})=\beta_0+\beta_1x_1+\beta_2x_2+...+\beta_ix_i\]</span></p>
<p><span class="math display">\[logit(Y)=\beta_0+\beta_1x_1+\beta_2x_2+...+\beta_ix_i\]</span></p>
<p>El valor de la probabilidad de Y se puede obtener con la inversa del logaritmo natural:</p>
<p><span class="math display">\[p(Y)=\frac{e^{\beta_0+\beta_1x_1+\beta_2x_2+...+\beta_ix_i}}{1+e^{\beta_0+\beta_1x_1+\beta_2x_2+...+\beta_ix_i}}\]</span></p>
</div>
<div id="convertir-probabilidad-en-clasificación" class="section level3" number="6.5.3">
<h3><span class="header-section-number">6.5.3</span> Convertir probabilidad en clasificación</h3>
<p>Una de las principales aplicaciones de un modelo de regresión logística es clasificar la variable cualitativa en función de valor que tome el predictor. Para conseguir esta clasificación, es necesario establecer un <strong>threshold</strong> de probabilidad a partir de la cual se considera que la variable pertenece a uno de los niveles. Por ejemplo, se puede asignar una observación al grupo 1 si <span class="math inline">\(p̂ (Y=1|X)&gt;0.3\)</span> y al grupo 0 si ocurre lo contrario.</p>
<p>Es importante mencionar que el punto de corte no tiene que ser 0.5, este puede ser seleccionado a convenecía de la métrica a optimizar.</p>
</div>
<div id="métricas-de-desempeño-2" class="section level3" number="6.5.4">
<h3><span class="header-section-number">6.5.4</span> Métricas de desempeño</h3>
<p>Existen distintas métricas de desempeño para problemas de clasificación, debido a que contamos con la respuesta correcta podemos contar cuántos aciertos tuvimos y cuántos fallos tuvimos.</p>
<p>Primero, por simplicidad ocuparemos un ejemplo de clasificación binaria, Fraude (1) o No fraude (0).</p>
<p>En este tipo de algoritmos definimos cuál de las categorías será nuestra etiqueta positiva y cuál será la negativa. La positiva será la categoría que queremos predecir -en nuestro ejemplo, fraude- y la negativa lo opuesto -en el caso binario- en nuestro ejemplo, no fraude.</p>
<p>Dadas estas definiciones tenemos 4 posibilidades:</p>
<ul>
<li><p><strong>True positives</strong>: Nuestra predicción dijo que la transacción es fraude y la etiqueta real dice que es fradue.</p></li>
<li><p><strong>False positives</strong>: Nuestra predicción dijo que la transacción es fraude y la etiqueta real dice que no es fraude.</p></li>
<li><p><strong>True negatives</strong>: Nuestra predicción dijo que la transacción es no fraude y la etiqueta real dice que no es fraude.</p></li>
<li><p><strong>False negatives</strong>: Nuestra predicción dijo que la transacción es no fraude y la etiqueta real dice que es fraude.</p></li>
<li><p><strong>Matriz de confusión</strong></p></li>
</ul>
<p><img src="img/ml/3-8-4-confusion.png" width="700pt" height="250pt" style="display: block; margin: auto;" /></p>
<p>Esta métrica corresponde a una matriz en donde se plasma el conteo de los aciertos y los errores que haya hecho el modelo.</p>
<p>En esta métrica utilizamos todos los aciertos y todos los errores que haya tenido el modelo en las predicciones, esto es: los verdaderos positivos (TP), los verdaderos negativos (TN), los falsos positivos (FP) y los falsos negativos (FN).</p>
<p>Normalmente los renglones representan las etiquetas reales, ya sean positivas o negativas, y las columnas, las etiquetas predichas.</p>
<ul>
<li><strong>Accuracy</strong></li>
</ul>
<p>Número de aciertos totales entre todas las predicciones.</p>
<p><span class="math display">\[accuracy = \frac{TP + TN}{ TP+FP+TN+FN}\]</span></p>
<p>La métrica más utilizada, en datasets imbalanceados esta métrica no nos sirve, al contrario, nos engaña.</p>
<ul>
<li><strong>Precision</strong>: Eficiencia</li>
</ul>
<p>De los que identificamos como clase positiva, cuántos identificamos correctamente. ¿Qué tan eficientes somos en la predicción?</p>
<p><span class="math display">\[precision = \frac{TP}{TP + FP}\]</span></p>
<p>¿Cuándo utilizar precision?</p>
<p>Esta es la métrica que ocuparás más, pues en un contexto de negocio, donde los recursos son finitos y tiene un costo asociado, ya sea monetario o de tiempo o de recursos, necesitarás que las predicciones de tu etiqueta positiva sean muy eficientes.</p>
<p>Al utilizar esta métrica estaremos optimizando el modelo para minimizar el número de falsos positivos.</p>
<ul>
<li><strong>Recall o Sensibilidad</strong>: Cobertura</li>
</ul>
<p>Del universo posible de nuestra clase positiva, cuántos identificamos correctamente.</p>
<p><span class="math display">\[recall = \frac{TP}{TP + FN }\]</span></p>
<p>Esta métrica la ocuparás cuando en el contexto de negocio de tu problema sea más conveniente minimizar los falsos negativos por el impacto que estos pueden tener en las personas en quienes se implementará la predicción.</p>
<p>Al utilizar esta métrica estaremos optimizando el modelo para minimizar el número de falsos negativos.</p>
<ul>
<li><strong>Especificidad</strong></li>
</ul>
<p>Es el número de observaciones correctamente identificados como negativos fuera del total de negativos.</p>
<p><span class="math display">\[Specificity = \frac{TN}{TN+FP}\]</span></p>
<ul>
<li><strong>F1-score</strong></li>
</ul>
<p>Combina precision y recall para optimizar ambos.</p>
<p><span class="math display">\[F = 2 *\frac{precision * recall}{precision + recall} \]</span></p>
<p>Se recomienda utilizar esta métrica de desempeño cuando quieres balancear tanto los falsos positivos como los falsos negativos. Aunque es una buena solución para tomar en cuenta ambos errores, pocas veces hay problemas reales que permiten ocuparla, esto es porque en más del 90% de los casos tenemos una restricción en recursos.</p>
<p>Ahora con esto en mente podemos definir las siguientes métricas:</p>
<ul>
<li><strong>AUC y ROC</strong>: <em>Area Under the Curve y Receiver operator characteristic</em></li>
</ul>
<p><img src="img/ml/3-8-4-roc.png" width="700pt" height="400pt" style="display: block; margin: auto;" /></p>
<p>Una curva <strong>ROC</strong> es un gráfico que muestra el desempeño de un modelo de clasificación en todos los puntos de corte.</p>
<p><strong>AUC</strong> significa “Área bajo la curva ROC.” Es decir, <strong>AUC</strong> mide el área debajo de la curva ROC.</p>
</div>
<div id="implementación-en-r-1" class="section level3" number="6.5.5">
<h3><span class="header-section-number">6.5.5</span> Implementación en R</h3>
<p>Ajustaremos un modelo de regresión logística usando la receta antes vista.</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="machine-learning-aprendizaje-supervisado.html#cb179-1" aria-hidden="true" tabindex="-1"></a>logistic_model <span class="ot">&lt;-</span>  <span class="fu">logistic_reg</span>() <span class="sc">%&gt;%</span></span>
<span id="cb179-2"><a href="machine-learning-aprendizaje-supervisado.html#cb179-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">&quot;glm&quot;</span>)</span>
<span id="cb179-3"><a href="machine-learning-aprendizaje-supervisado.html#cb179-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-4"><a href="machine-learning-aprendizaje-supervisado.html#cb179-4" aria-hidden="true" tabindex="-1"></a>logistic_fit1 <span class="ot">&lt;-</span> <span class="fu">fit</span>(logistic_model, Churn <span class="sc">~</span> ., telco_juiced)</span>
<span id="cb179-5"><a href="machine-learning-aprendizaje-supervisado.html#cb179-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-6"><a href="machine-learning-aprendizaje-supervisado.html#cb179-6" aria-hidden="true" tabindex="-1"></a>logistic_p_test <span class="ot">&lt;-</span> <span class="fu">predict</span>(logistic_fit1, telco_test_bake) <span class="sc">%&gt;%</span></span>
<span id="cb179-7"><a href="machine-learning-aprendizaje-supervisado.html#cb179-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(telco_test_bake)</span>
<span id="cb179-8"><a href="machine-learning-aprendizaje-supervisado.html#cb179-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-9"><a href="machine-learning-aprendizaje-supervisado.html#cb179-9" aria-hidden="true" tabindex="-1"></a>logistic_p_test</span></code></pre></div>
<pre><code>## # A tibble: 2,113 × 29
##    .pred_class SeniorCitizen MonthlyCharges TotalCharges Churn gender_Male
##    &lt;fct&gt;               &lt;dbl&gt;          &lt;dbl&gt;        &lt;dbl&gt; &lt;fct&gt;       &lt;dbl&gt;
##  1 No                 -0.442         -0.271       -0.175 No              1
##  2 Yes                -0.442          1.15        -0.647 Yes             0
##  3 No                 -0.442         -1.18        -0.876 No              0
##  4 No                 -0.442         -1.53        -0.865 No              1
##  5 No                 -0.442          1.38         2.25  No              1
##  6 Yes                -0.442          0.830       -0.187 No              0
##  7 No                 -0.442         -1.51        -0.920 No              1
##  8 No                 -0.442         -0.183        0.302 No              1
##  9 No                 -0.442         -1.16        -0.996 Yes             1
## 10 No                 -0.442          0.837        1.80  No              1
## # … with 2,103 more rows, and 23 more variables: Partner_Yes &lt;dbl&gt;,
## #   Dependents_Yes &lt;dbl&gt;, tenure_X1.2.years &lt;dbl&gt;, tenure_X2.3.years &lt;dbl&gt;,
## #   tenure_X3.4.years &lt;dbl&gt;, tenure_X4.5.years &lt;dbl&gt;, tenure_X5.6.years &lt;dbl&gt;,
## #   PhoneService_Yes &lt;dbl&gt;, MultipleLines_Yes &lt;dbl&gt;,
## #   InternetService_Fiber.optic &lt;dbl&gt;, InternetService_No &lt;dbl&gt;,
## #   OnlineSecurity_Yes &lt;dbl&gt;, OnlineBackup_Yes &lt;dbl&gt;,
## #   DeviceProtection_Yes &lt;dbl&gt;, TechSupport_Yes &lt;dbl&gt;, StreamingTV_Yes &lt;dbl&gt;, …</code></pre>
</div>
<div id="métricas-de-desempeño-3" class="section level3" number="6.5.6">
<h3><span class="header-section-number">6.5.6</span> Métricas de desempeño</h3>
<p><strong>Matriz de Confusión</strong></p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="machine-learning-aprendizaje-supervisado.html#cb181-1" aria-hidden="true" tabindex="-1"></a>yardstick<span class="sc">::</span><span class="fu">conf_mat</span>(logistic_p_test,Churn,.pred_class)</span></code></pre></div>
<pre><code>##           Truth
## Prediction   No  Yes
##        No  1418  287
##        Yes  129  279</code></pre>
<p><strong>Accuracy</strong></p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="machine-learning-aprendizaje-supervisado.html#cb183-1" aria-hidden="true" tabindex="-1"></a>(<span class="dv">1398</span><span class="sc">+</span><span class="dv">296</span>)<span class="sc">/</span>(<span class="dv">1398</span><span class="sc">+</span><span class="dv">160</span><span class="sc">+</span><span class="dv">256</span><span class="sc">+</span><span class="dv">296</span>)</span></code></pre></div>
<pre><code>## [1] 0.8028436</code></pre>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="machine-learning-aprendizaje-supervisado.html#cb185-1" aria-hidden="true" tabindex="-1"></a>yardstick<span class="sc">::</span><span class="fu">accuracy</span>(logistic_p_test,Churn,.pred_class, <span class="at">event_level =</span> <span class="st">&quot;second&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 3
##   .metric  .estimator .estimate
##   &lt;chr&gt;    &lt;chr&gt;          &lt;dbl&gt;
## 1 accuracy binary         0.803</code></pre>
<p><strong>Precision</strong></p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="machine-learning-aprendizaje-supervisado.html#cb187-1" aria-hidden="true" tabindex="-1"></a>yardstick<span class="sc">::</span><span class="fu">precision</span>(logistic_p_test,Churn,.pred_class,<span class="at">event_level =</span> <span class="st">&quot;second&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 3
##   .metric   .estimator .estimate
##   &lt;chr&gt;     &lt;chr&gt;          &lt;dbl&gt;
## 1 precision binary         0.684</code></pre>
<p><strong>Recall</strong></p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="machine-learning-aprendizaje-supervisado.html#cb189-1" aria-hidden="true" tabindex="-1"></a>yardstick<span class="sc">::</span><span class="fu">recall</span>(logistic_p_test,Churn,.pred_class,<span class="at">event_level =</span> <span class="st">&quot;second&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 3
##   .metric .estimator .estimate
##   &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;
## 1 recall  binary         0.493</code></pre>
<p><strong>F1 Score</strong></p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="machine-learning-aprendizaje-supervisado.html#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(logistic_p_test,MLmetrics<span class="sc">::</span><span class="fu">F1_Score</span>(.pred_class,Churn),<span class="at">event_level =</span> <span class="st">&quot;second&quot;</span> )</span></code></pre></div>
<pre><code>## [1] 0.8720787</code></pre>
<p><strong>¿Y si se quiere un corte diferente? ¿el negocio qué necesita?</strong></p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="machine-learning-aprendizaje-supervisado.html#cb193-1" aria-hidden="true" tabindex="-1"></a>logistic_p_test_prob <span class="ot">&lt;-</span> <span class="fu">predict</span>(logistic_fit1, telco_test_bake, <span class="at">type=</span><span class="st">&quot;prob&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb193-2"><a href="machine-learning-aprendizaje-supervisado.html#cb193-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(telco_test_bake)</span>
<span id="cb193-3"><a href="machine-learning-aprendizaje-supervisado.html#cb193-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-4"><a href="machine-learning-aprendizaje-supervisado.html#cb193-4" aria-hidden="true" tabindex="-1"></a>logistic_p_test_prob</span></code></pre></div>
<pre><code>## # A tibble: 2,113 × 30
##    .pred_No .pred_Yes SeniorCitizen MonthlyCharges TotalCharges Churn
##       &lt;dbl&gt;     &lt;dbl&gt;         &lt;dbl&gt;          &lt;dbl&gt;        &lt;dbl&gt; &lt;fct&gt;
##  1    0.963    0.0367        -0.442         -0.271       -0.175 No   
##  2    0.163    0.837         -0.442          1.15        -0.647 Yes  
##  3    0.665    0.335         -0.442         -1.18        -0.876 No   
##  4    0.987    0.0130        -0.442         -1.53        -0.865 No   
##  5    0.965    0.0348        -0.442          1.38         2.25  No   
##  6    0.491    0.509         -0.442          0.830       -0.187 No   
##  7    0.925    0.0753        -0.442         -1.51        -0.920 No   
##  8    0.955    0.0449        -0.442         -0.183        0.302 No   
##  9    0.576    0.424         -0.442         -1.16        -0.996 Yes  
## 10    0.981    0.0187        -0.442          0.837        1.80  No   
## # … with 2,103 more rows, and 24 more variables: gender_Male &lt;dbl&gt;,
## #   Partner_Yes &lt;dbl&gt;, Dependents_Yes &lt;dbl&gt;, tenure_X1.2.years &lt;dbl&gt;,
## #   tenure_X2.3.years &lt;dbl&gt;, tenure_X3.4.years &lt;dbl&gt;, tenure_X4.5.years &lt;dbl&gt;,
## #   tenure_X5.6.years &lt;dbl&gt;, PhoneService_Yes &lt;dbl&gt;, MultipleLines_Yes &lt;dbl&gt;,
## #   InternetService_Fiber.optic &lt;dbl&gt;, InternetService_No &lt;dbl&gt;,
## #   OnlineSecurity_Yes &lt;dbl&gt;, OnlineBackup_Yes &lt;dbl&gt;,
## #   DeviceProtection_Yes &lt;dbl&gt;, TechSupport_Yes &lt;dbl&gt;, StreamingTV_Yes &lt;dbl&gt;, …</code></pre>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="machine-learning-aprendizaje-supervisado.html#cb195-1" aria-hidden="true" tabindex="-1"></a>logistic_p_test_prob <span class="ot">&lt;-</span> logistic_p_test_prob <span class="sc">%&gt;%</span> </span>
<span id="cb195-2"><a href="machine-learning-aprendizaje-supervisado.html#cb195-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.pred_class  =</span> <span class="fu">as_factor</span>(<span class="fu">if_else</span> ( .pred_Yes <span class="sc">&gt;=</span> <span class="fl">0.30</span>, <span class="st">&#39;Yes&#39;</span>, <span class="st">&#39;No&#39;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb195-3"><a href="machine-learning-aprendizaje-supervisado.html#cb195-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(.pred_class , <span class="at">.before =</span> .pred_No)</span>
<span id="cb195-4"><a href="machine-learning-aprendizaje-supervisado.html#cb195-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-5"><a href="machine-learning-aprendizaje-supervisado.html#cb195-5" aria-hidden="true" tabindex="-1"></a>logistic_p_test_prob</span></code></pre></div>
<pre><code>## # A tibble: 2,113 × 31
##    .pred_class .pred_No .pred_Yes SeniorCitizen MonthlyCharges TotalCharges
##    &lt;fct&gt;          &lt;dbl&gt;     &lt;dbl&gt;         &lt;dbl&gt;          &lt;dbl&gt;        &lt;dbl&gt;
##  1 No             0.963    0.0367        -0.442         -0.271       -0.175
##  2 Yes            0.163    0.837         -0.442          1.15        -0.647
##  3 Yes            0.665    0.335         -0.442         -1.18        -0.876
##  4 No             0.987    0.0130        -0.442         -1.53        -0.865
##  5 No             0.965    0.0348        -0.442          1.38         2.25 
##  6 Yes            0.491    0.509         -0.442          0.830       -0.187
##  7 No             0.925    0.0753        -0.442         -1.51        -0.920
##  8 No             0.955    0.0449        -0.442         -0.183        0.302
##  9 Yes            0.576    0.424         -0.442         -1.16        -0.996
## 10 No             0.981    0.0187        -0.442          0.837        1.80 
## # … with 2,103 more rows, and 25 more variables: Churn &lt;fct&gt;,
## #   gender_Male &lt;dbl&gt;, Partner_Yes &lt;dbl&gt;, Dependents_Yes &lt;dbl&gt;,
## #   tenure_X1.2.years &lt;dbl&gt;, tenure_X2.3.years &lt;dbl&gt;, tenure_X3.4.years &lt;dbl&gt;,
## #   tenure_X4.5.years &lt;dbl&gt;, tenure_X5.6.years &lt;dbl&gt;, PhoneService_Yes &lt;dbl&gt;,
## #   MultipleLines_Yes &lt;dbl&gt;, InternetService_Fiber.optic &lt;dbl&gt;,
## #   InternetService_No &lt;dbl&gt;, OnlineSecurity_Yes &lt;dbl&gt;, OnlineBackup_Yes &lt;dbl&gt;,
## #   DeviceProtection_Yes &lt;dbl&gt;, TechSupport_Yes &lt;dbl&gt;, StreamingTV_Yes &lt;dbl&gt;, …</code></pre>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="machine-learning-aprendizaje-supervisado.html#cb197-1" aria-hidden="true" tabindex="-1"></a>cm_5<span class="ot">&lt;-</span> yardstick<span class="sc">::</span><span class="fu">conf_mat</span>(logistic_p_test,Churn,.pred_class)</span>
<span id="cb197-2"><a href="machine-learning-aprendizaje-supervisado.html#cb197-2" aria-hidden="true" tabindex="-1"></a>cm_3<span class="ot">&lt;-</span> yardstick<span class="sc">::</span><span class="fu">conf_mat</span>(logistic_p_test_prob,Churn,.pred_class)</span>
<span id="cb197-3"><a href="machine-learning-aprendizaje-supervisado.html#cb197-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-4"><a href="machine-learning-aprendizaje-supervisado.html#cb197-4" aria-hidden="true" tabindex="-1"></a>cm_5</span></code></pre></div>
<pre><code>##           Truth
## Prediction   No  Yes
##        No  1418  287
##        Yes  129  279</code></pre>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="machine-learning-aprendizaje-supervisado.html#cb199-1" aria-hidden="true" tabindex="-1"></a>cm_3</span></code></pre></div>
<pre><code>##           Truth
## Prediction   No  Yes
##        No  1182  123
##        Yes  365  443</code></pre>
<p><strong>Precision</strong></p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="machine-learning-aprendizaje-supervisado.html#cb201-1" aria-hidden="true" tabindex="-1"></a>yardstick<span class="sc">::</span><span class="fu">precision</span>(logistic_p_test_prob,Churn,.pred_class,<span class="at">event_level =</span> <span class="st">&quot;second&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 3
##   .metric   .estimator .estimate
##   &lt;chr&gt;     &lt;chr&gt;          &lt;dbl&gt;
## 1 precision binary         0.548</code></pre>
<p><strong>Recall</strong></p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="machine-learning-aprendizaje-supervisado.html#cb203-1" aria-hidden="true" tabindex="-1"></a>yardstick<span class="sc">::</span><span class="fu">recall</span>(logistic_p_test_prob,Churn,.pred_class, <span class="at">event_level =</span> <span class="st">&quot;second&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 3
##   .metric .estimator .estimate
##   &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;
## 1 recall  binary         0.783</code></pre>
<p>Para poder determinar cual es el mejor punto de corte, es indispensable conocer el comportamiento y efecto de los diferentes puntos de corte.</p>
<p>Veamos un ejemplo visual en nuestra aplicación de Shiny: <a href="https://acturio.shinyapps.io/confusion_matrix/">ConfusionMatrixShiny</a></p>
</div>
</div>
<div id="regresión-regularizada-ridge-lasso-elasticnet" class="section level2" number="6.6">
<h2><span class="header-section-number">6.6</span> Regresión regularizada: Ridge, Lasso &amp; ElasticNet</h2>
<p><img src="img/ml/3-7-regularizaciones.png" width="150pt" height="150pt" style="display: block; margin: auto auto auto 0;" /></p>
<p>En muchas técnicas de aprendizaje automático, el aprendizaje consiste en encontrar
los coeficientes que minimizan una función de costo.</p>
<p>Un modelo estándar de mínimos cuadrados tiende a tener alguna variación, es decir,
este modelo no se generalizará bien para un conjunto de datos diferente a sus
datos de entrenamiento.</p>
<p>La regularización consiste en añadir una penalización a la función de costo.
Esta penalización produce modelos más simples que generalizan mejor y evita
el riesgo de sobreajuste.</p>
<p>El procedimiento de ajuste implica una función de pérdida, conocida como suma de
cuadrados residual o <em>RSS</em>. Los coeficientes <span class="math inline">\(\beta\)</span> se eligen de manera que minimicen
esta función de pérdida.</p>
<p><span class="math display">\[RSS = \sum_{i=1}^n\left(y_i - \beta_0- \sum_{i=1}^p \beta_jx_{ij}\right)^2\]</span></p>
<p>Esto ajustará los coeficientes en función de sus datos de entrenamiento.
Si hay ruido en los datos de entrenamiento, los coeficientes estimados no se
generalizarán bien a los datos futuros. Aquí es donde entra la regularización y
reduce o regulariza estas estimaciones aprendidas hacia cero.</p>
<p>En esta sección se verán las regularizaciones más usadas en machine learning:</p>
<ul>
<li>Ridge (conocida también como L2)</li>
<li>Lasso (también conocida como L1)</li>
<li>ElasticNet que combina tanto Lasso como Ridge.</li>
</ul>
<p>Para cada una de estas regularizaciones ajustaremos un modelo
de regresión lineal al conjunto de datos de viviendas de <em>Ames</em> con ayuda del
paquete de <em>tidymodels</em> llamado <em>parsnip</em>.</p>
<div id="regularización-ridge" class="section level3" number="6.6.1">
<h3><span class="header-section-number">6.6.1</span> Regularización Ridge</h3>
<p><span class="math display">\[\sum_{i=1}^n\left(y_i - \beta_0- \sum_{i=1}^p \beta_jx_{ij}\right)^2 + \lambda \sum_{j=1}^p \beta_j^2 = RSS + \lambda \sum_{j=1}^p \beta_j^2\]</span>
En este tipo de regularización <em>RSS</em> se modifica agregando una cantidad de contracción y
los coeficientes se estiman minimizando esta función. <span class="math inline">\(\lambda\)</span> es el parámetro
de ajuste que decide cuánto queremos penalizar la flexibilidad de el modelo.</p>
<p>El aumento de la flexibilidad de un modelo está representado por el aumento de
sus coeficientes, si se desea minimizar la función anterior, los coeficientes
deben ser pequeños.</p>
<p>Así es como la técnica de regresión de <em>Ridge</em> evita que los coeficientes aumenten
demasiado. Además, reduce la asociación estimada de cada variable con la respuesta
excepto la intersección <span class="math inline">\(\beta_0\)</span>. Esta intersección es una medida del valor medio
de la respuesta cuando <span class="math inline">\(x_{i1} = x_{i2} =\dots= x_{ip} = 0\)</span>.</p>
<p>Cuando <span class="math inline">\(\lambda = 0\)</span>, el término de penalización no tiene efecto y las estimaciones
serán iguales a mínimos cuadrados.</p>
<p>Sin embargo, a medida que <span class="math inline">\(\lambda \rightarrow \infty\)</span>, el impacto de la penalización
por contracción aumenta, y las estimaciones se acercarán a cero.</p>
<p>La selección de un buen valor de <span class="math inline">\(\lambda\)</span> es fundamental. Las estimaciones de
coeficientes producidas por este método también se conocen como la <strong>norma L2</strong>.</p>
<p><strong>Nota:</strong> Es necesario estandarizar los predictores o llevarlos a la misma escala
antes de aplicar esta regularización. La fórmula utilizada para hacer esto se da
a continuación.</p>
<p><span class="math display">\[\widetilde{x}_{ij} = \frac{x_{ij}}{\sqrt{\frac{1}{n}\sum_{i=1}^n(x_{ij} - \bar{x_j})^2}}\]</span></p>
</div>
<div id="regularización-lasso" class="section level3" number="6.6.2">
<h3><span class="header-section-number">6.6.2</span> Regularización Lasso</h3>
<p><span class="math display">\[\sum_{i=1}^n\left(y_i - \beta_0- \sum_{i=1}^p \beta_jx_{ij}\right)^2 + \lambda \sum_{j=1}^p |\beta_j| = RSS + \lambda \sum_{j=1}^p |\beta_j|\]</span>
Lasso es otra variación, en la que se minimiza la función anterior.
Esta variación se diferencia de la regresión de <em>Ridge</em> solo en penalizar los
coeficientes altos. Utiliza <span class="math inline">\(|\beta_j|\)</span> (módulo) en lugar de los cuadrados de <span class="math inline">\(\beta\)</span> como penalización.</p>
<p>Las estimaciones de coeficientes producidas por este método también se conocen como la <strong>norma L1</strong>.</p>
<p>La regresión <em>Ridge</em> se puede considerar como la solución de una ecuación,
donde la suma de los cuadrados de los coeficientes es menor o igual que <span class="math inline">\(s\)</span>,
donde <span class="math inline">\(s\)</span> es una constante que existe para cada valor del factor de contracción <span class="math inline">\(\lambda\)</span></p>
<p><span class="math display">\[\beta_1^2 + \beta_2^2 \leq s\]</span></p>
<p>Esto implica que los coeficientes de la regresión <em>Ridge</em>
tienen el RSS (función de pérdida) más pequeño para todos los puntos que se
encuentran dentro del círculo dado por la función de restricción
<span class="math inline">\(\beta_1^2 + \beta_2^2 \leq s\)</span>.</p>
<p>Y en la regresión <em>Lasso</em> se puede considerar como una ecuación en la que la
suma del módulo de coeficientes es menor o igual que <span class="math inline">\(s\)</span>.</p>
<p><span class="math display">\[|\beta_1| + |\beta_2| \leq s\]</span></p>
<p>Esto implica que los coeficientes de lazo tienen la RSS (función de pérdida)
más pequeña para todos los puntos que se encuentran dentro del diamante dado por
la función de restricción <span class="math inline">\(|\beta_1| + |\beta_2| \leq s\)</span></p>
<p><img src="img/ml/3-7-2-ridge-lasso.png" width="600pt" height="300pt" style="display: block; margin: auto;" /></p>
<p>La imagen de arriba muestra las funciones de restricción (áreas verdes)
para <em>Lasso</em> (izquierda) y <em>Ridge</em> (derecha), junto con contornos para RSS (elipse roja).</p>
<p>Para un valor muy grande de <span class="math inline">\(s\)</span>, las regiones verdes contendrán el centro de la elipse,
lo que hará que las estimaciones de los coeficientes de ambas técnicas de regresión sean iguales a las estimaciones de mínimos cuadrados. Pero este no es el caso en la imagen de arriba.</p>
<p>En este caso, las estimaciones del coeficiente de regresión de <em>Lasso</em> y <em>Ridge</em>
vienen dadas por el primer punto en el que una elipse contacta con la región de restricción.
Dado que la regresión <em>Ridge</em> tiene una restricción circular sin puntos agudos,
esta intersección generalmente no ocurrirá en un eje, por lo que las estimaciones
del coeficiente de regresión de <em>Ridge</em> serán exclusivamente distintas de cero.</p>
<p>Sin embargo, la restricción de <em>Lasso</em> tiene esquinas en cada uno de los ejes,
por lo que la elipse a menudo intersectará la región de restricción en un eje.
Cuando esto ocurre, uno de los coeficientes será igual a cero.
En dimensiones más altas, muchas de las estimaciones de coeficientes pueden ser
iguales a cero simultáneamente.</p>
<p><strong>Desventajas</strong></p>
<ul>
<li><p>Regresión <em>Ridge</em>: Reducirá los coeficientes de los predictores menos importantes, muy cerca de cero. Pero nunca los hará exactamente cero. En otras palabras, el modelo final incluirá todos los predictores.</p></li>
<li><p>Regresión <em>Lasso</em>: La penalización <em>L1</em> tiene el efecto de forzar algunas de las estimaciones de coeficientes a ser exactamente iguales a cero cuando el parámetro de ajuste <span class="math inline">\(\lambda\)</span>
es suficientemente grande. Por lo tanto, este método realiza una selección
de variables y se dice que produce modelos dispersos.</p></li>
</ul>
</div>
<div id="elasticnet" class="section level3" number="6.6.3">
<h3><span class="header-section-number">6.6.3</span> ElasticNet</h3>
<p><em>ElasticNet</em> surgió por primera vez como resultado de la crítica a <em>Lasso</em>,
cuya selección de variables puede ser demasiado dependiente de los datos y,
por lo tanto, inestable. La solución es combinar las penalizaciones de la regresión
de <em>Ridge</em> y <em>Lasso</em> para obtener lo mejor de ambas regularizaciones.</p>
<p><em>ElasticNet</em> tiene como objetivo minimizar la siguiente función de pérdida:</p>
<p><span class="math display">\[\frac{\sum_{i=1}^n\left(y_i - \beta_0- \sum_{i=1}^p \beta_jx_{ij}\right)^2}{2n} + 
\lambda\left( ({1-\alpha}) \sum_{j=1}^p|\beta_j| + \alpha \sum_{j=1}^p \beta_j ^2\right)\]</span></p>
<p><span class="math display">\[ = \frac{RSS}{2n}+ \lambda\left( ({1-\alpha}) \sum_{j=1}^p|\beta_j| + \alpha \sum_{j=1}^p \beta_j ^2\right)\]</span>
donde <span class="math inline">\(\alpha \in [0,1]\)</span> es el parámetro de mezcla entre la regularización <em>Ridge</em> <span class="math inline">\((\alpha = 0)\)</span> y
la regularización <em>Lasso</em> <span class="math inline">\((\alpha = 1)\)</span>.</p>
<p>La combinación de ambas penalizaciones suele dar lugar a buenos resultados.
Una estrategia frecuentemente utilizada es asignarle casi todo el peso a la
penalización <em>L1</em> ( <span class="math inline">\(\alpha \approx 1\)</span>) para conseguir seleccionar predictores
y menos peso a la regularización <span class="math inline">\(L2\)</span> para dar cierta estabilidad en el caso de
que algunos predictores estén correlacionados.</p>
<p><img src="img/ml/3-7-3-elastic-net.png" width="650pt" height="500pt" style="display: block; margin: auto;" /></p>
</div>
<div id="elasticnet-para-regresión-lineal" class="section level3" number="6.6.4">
<h3><span class="header-section-number">6.6.4</span> ElasticNet para regresión lineal</h3>
<p>Utilizando el modelo <code>linear_reg()</code> del paquete <em>parsnip</em>. Hay varios mecanismos que
pueden realizar la regularización/penalización, los paquetes <em>glmnet</em>, <em>sparklyr</em>, <em>keras</em> o <em>stan</em>.</p>
<p>Usemos el primero aquí. El paquete <em>glmnet</em> solo implementa un método que no es de fórmula,
pero <em>parsnip</em> permitirá que se use cualquiera de ellos.</p>
<p>Cuando se utiliza la regularización, los predictores deben de centrarse y escalarse
primero antes de pasar al modelo. El método de la fórmula no lo hará automáticamente,
por lo que tendremos que hacerlo nosotros mismos como se hizo en la sección
<strong>3.5 Preparación de conjunto de datos</strong> con la receta <code>receta_casas</code>.</p>
<p>El parámetro <code>penalty</code> es un número no negativo que representa la cantidad total
de regularización (solo <em>glmnet</em>, <em>keras</em> y <em>spark</em>).
Para los modelos de <em>Keras</em>, esto corresponde a la regularización <em>L2</em>.</p>
<p>Mientras que el parámetro <code>mixture</code> es un número entre cero y uno (inclusivo)
que es la proporción de regularización <em>L1</em> en el modelo.</p>
<p>Cuando <code>mixture = 1</code>, es un modelo de <em>Lasso</em> puro, mientras que <code>mixture = 0</code>
indica que se está utilizando un modelo <em>Ridge</em>.</p>
<p>Primero declaramos la regresión logística con el mecanismo <em>glm</em></p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="machine-learning-aprendizaje-supervisado.html#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2453</span>)</span>
<span id="cb205-2"><a href="machine-learning-aprendizaje-supervisado.html#cb205-2" aria-hidden="true" tabindex="-1"></a>ames_folds<span class="ot">&lt;-</span> <span class="fu">vfold_cv</span>(ames_train)</span>
<span id="cb205-3"><a href="machine-learning-aprendizaje-supervisado.html#cb205-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-4"><a href="machine-learning-aprendizaje-supervisado.html#cb205-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Declaración del modelo </span></span>
<span id="cb205-5"><a href="machine-learning-aprendizaje-supervisado.html#cb205-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-6"><a href="machine-learning-aprendizaje-supervisado.html#cb205-6" aria-hidden="true" tabindex="-1"></a>lasso_ridge_regression_model <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>(</span>
<span id="cb205-7"><a href="machine-learning-aprendizaje-supervisado.html#cb205-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">mixture =</span> <span class="fu">tune</span>(), </span>
<span id="cb205-8"><a href="machine-learning-aprendizaje-supervisado.html#cb205-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">penalty =</span> <span class="fu">tune</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb205-9"><a href="machine-learning-aprendizaje-supervisado.html#cb205-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">&quot;regression&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb205-10"><a href="machine-learning-aprendizaje-supervisado.html#cb205-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">&quot;glmnet&quot;</span>)</span>
<span id="cb205-11"><a href="machine-learning-aprendizaje-supervisado.html#cb205-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-12"><a href="machine-learning-aprendizaje-supervisado.html#cb205-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-13"><a href="machine-learning-aprendizaje-supervisado.html#cb205-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Declaración del flujo de trabajo </span></span>
<span id="cb205-14"><a href="machine-learning-aprendizaje-supervisado.html#cb205-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-15"><a href="machine-learning-aprendizaje-supervisado.html#cb205-15" aria-hidden="true" tabindex="-1"></a>lasso_ridge_regression_workflow <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb205-16"><a href="machine-learning-aprendizaje-supervisado.html#cb205-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(lasso_ridge_regression_model) <span class="sc">%&gt;%</span> </span>
<span id="cb205-17"><a href="machine-learning-aprendizaje-supervisado.html#cb205-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(receta_casas)</span>
<span id="cb205-18"><a href="machine-learning-aprendizaje-supervisado.html#cb205-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-19"><a href="machine-learning-aprendizaje-supervisado.html#cb205-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Parámetros a probar</span></span>
<span id="cb205-20"><a href="machine-learning-aprendizaje-supervisado.html#cb205-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-21"><a href="machine-learning-aprendizaje-supervisado.html#cb205-21" aria-hidden="true" tabindex="-1"></a>lasso_ridge_regression_parameters_set <span class="ot">&lt;-</span> dials<span class="sc">::</span><span class="fu">parameters</span>(</span>
<span id="cb205-22"><a href="machine-learning-aprendizaje-supervisado.html#cb205-22" aria-hidden="true" tabindex="-1"></a>  dials<span class="sc">::</span><span class="fu">penalty</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="sc">-</span><span class="dv">1</span>), </span>
<span id="cb205-23"><a href="machine-learning-aprendizaje-supervisado.html#cb205-23" aria-hidden="true" tabindex="-1"></a>                 <span class="at">trans =</span> <span class="fu">log10_trans</span>()),</span>
<span id="cb205-24"><a href="machine-learning-aprendizaje-supervisado.html#cb205-24" aria-hidden="true" tabindex="-1"></a>  dials<span class="sc">::</span><span class="fu">mixture</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb205-25"><a href="machine-learning-aprendizaje-supervisado.html#cb205-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb205-26"><a href="machine-learning-aprendizaje-supervisado.html#cb205-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-27"><a href="machine-learning-aprendizaje-supervisado.html#cb205-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Grid</span></span>
<span id="cb205-28"><a href="machine-learning-aprendizaje-supervisado.html#cb205-28" aria-hidden="true" tabindex="-1"></a>lasso_ridge_regression_parameters_grid <span class="ot">&lt;-</span> <span class="fu">grid_regular</span>(</span>
<span id="cb205-29"><a href="machine-learning-aprendizaje-supervisado.html#cb205-29" aria-hidden="true" tabindex="-1"></a>  lasso_ridge_regression_parameters_set, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">10</span>)</span>
<span id="cb205-30"><a href="machine-learning-aprendizaje-supervisado.html#cb205-30" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb205-31"><a href="machine-learning-aprendizaje-supervisado.html#cb205-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-32"><a href="machine-learning-aprendizaje-supervisado.html#cb205-32" aria-hidden="true" tabindex="-1"></a>ctrl_grid <span class="ot">&lt;-</span> <span class="fu">control_grid</span>(<span class="at">save_pred =</span> T, <span class="at">verbose =</span> T)</span></code></pre></div>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="machine-learning-aprendizaje-supervisado.html#cb206-1" aria-hidden="true" tabindex="-1"></a>UseCores <span class="ot">&lt;-</span> <span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb206-2"><a href="machine-learning-aprendizaje-supervisado.html#cb206-2" aria-hidden="true" tabindex="-1"></a>cluster <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(UseCores)</span>
<span id="cb206-3"><a href="machine-learning-aprendizaje-supervisado.html#cb206-3" aria-hidden="true" tabindex="-1"></a><span class="fu">registerDoParallel</span>(cluster)</span>
<span id="cb206-4"><a href="machine-learning-aprendizaje-supervisado.html#cb206-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-5"><a href="machine-learning-aprendizaje-supervisado.html#cb206-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-6"><a href="machine-learning-aprendizaje-supervisado.html#cb206-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-7"><a href="machine-learning-aprendizaje-supervisado.html#cb206-7" aria-hidden="true" tabindex="-1"></a>lasso_ridge_regression_tunning <span class="ot">&lt;-</span> <span class="fu">tune_grid</span>(</span>
<span id="cb206-8"><a href="machine-learning-aprendizaje-supervisado.html#cb206-8" aria-hidden="true" tabindex="-1"></a>  lasso_ridge_regression_workflow,</span>
<span id="cb206-9"><a href="machine-learning-aprendizaje-supervisado.html#cb206-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">resamples =</span> ames_folds,</span>
<span id="cb206-10"><a href="machine-learning-aprendizaje-supervisado.html#cb206-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">grid =</span> lasso_ridge_regression_parameters_grid,</span>
<span id="cb206-11"><a href="machine-learning-aprendizaje-supervisado.html#cb206-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">metrics =</span> <span class="fu">metric_set</span>(rmse, rsq, mae),</span>
<span id="cb206-12"><a href="machine-learning-aprendizaje-supervisado.html#cb206-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> ctrl_grid</span>
<span id="cb206-13"><a href="machine-learning-aprendizaje-supervisado.html#cb206-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb206-14"><a href="machine-learning-aprendizaje-supervisado.html#cb206-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-15"><a href="machine-learning-aprendizaje-supervisado.html#cb206-15" aria-hidden="true" tabindex="-1"></a><span class="fu">stopCluster</span>(cluster)</span>
<span id="cb206-16"><a href="machine-learning-aprendizaje-supervisado.html#cb206-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-17"><a href="machine-learning-aprendizaje-supervisado.html#cb206-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Se guarda tune_grid en RDS </span></span>
<span id="cb206-18"><a href="machine-learning-aprendizaje-supervisado.html#cb206-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-19"><a href="machine-learning-aprendizaje-supervisado.html#cb206-19" aria-hidden="true" tabindex="-1"></a>lasso_ridge_regression_tunning <span class="sc">%&gt;%</span> </span>
<span id="cb206-20"><a href="machine-learning-aprendizaje-supervisado.html#cb206-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">saveRDS</span>(<span class="st">&quot;models/ml/lasso_ridge_regression_tunning.rds&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="machine-learning-aprendizaje-supervisado.html#cb207-1" aria-hidden="true" tabindex="-1"></a>lasso_ridge_regression_tunning <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;models/ml/lasso_ridge_regression_tunning.rds&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="machine-learning-aprendizaje-supervisado.html#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Métrica R cuadrada</span></span>
<span id="cb208-2"><a href="machine-learning-aprendizaje-supervisado.html#cb208-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-3"><a href="machine-learning-aprendizaje-supervisado.html#cb208-3" aria-hidden="true" tabindex="-1"></a>lasso_ridge_regression_tunning <span class="sc">%&gt;%</span> </span>
<span id="cb208-4"><a href="machine-learning-aprendizaje-supervisado.html#cb208-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(.metrics) <span class="sc">%&gt;%</span> </span>
<span id="cb208-5"><a href="machine-learning-aprendizaje-supervisado.html#cb208-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(.metric <span class="sc">==</span> <span class="st">&quot;rsq&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb208-6"><a href="machine-learning-aprendizaje-supervisado.html#cb208-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(.estimate)) <span class="sc">%&gt;%</span> </span>
<span id="cb208-7"><a href="machine-learning-aprendizaje-supervisado.html#cb208-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>)</span></code></pre></div>
<pre><code>## # A tibble: 10 × 10
##    splits   id     penalty mixture .metric .estimator .estimate .config  .notes 
##    &lt;list&gt;   &lt;chr&gt;    &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;    &lt;list&gt; 
##  1 &lt;split … Fold04  0.0569       0 rsq     standard       0.775 Preproc… &lt;tibbl…
##  2 &lt;split … Fold04  0.0625       0 rsq     standard       0.775 Preproc… &lt;tibbl…
##  3 &lt;split … Fold04  0.0518       0 rsq     standard       0.775 Preproc… &lt;tibbl…
##  4 &lt;split … Fold04  0.0687       0 rsq     standard       0.775 Preproc… &lt;tibbl…
##  5 &lt;split … Fold04  0.0471       0 rsq     standard       0.775 Preproc… &lt;tibbl…
##  6 &lt;split … Fold04  0.0754       0 rsq     standard       0.775 Preproc… &lt;tibbl…
##  7 &lt;split … Fold04  0.0429       0 rsq     standard       0.775 Preproc… &lt;tibbl…
##  8 &lt;split … Fold04  0.0829       0 rsq     standard       0.775 Preproc… &lt;tibbl…
##  9 &lt;split … Fold04  0.0391       0 rsq     standard       0.775 Preproc… &lt;tibbl…
## 10 &lt;split … Fold04  0.0356       0 rsq     standard       0.775 Preproc… &lt;tibbl…
## # … with 1 more variable: .predictions &lt;list&gt;</code></pre>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="machine-learning-aprendizaje-supervisado.html#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Analizando las métricas de manera visual </span></span>
<span id="cb210-2"><a href="machine-learning-aprendizaje-supervisado.html#cb210-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-3"><a href="machine-learning-aprendizaje-supervisado.html#cb210-3" aria-hidden="true" tabindex="-1"></a>graf_rsq <span class="ot">&lt;-</span> lasso_ridge_regression_tunning <span class="sc">%&gt;%</span> <span class="fu">unnest</span>(.metrics) <span class="sc">%&gt;%</span> </span>
<span id="cb210-4"><a href="machine-learning-aprendizaje-supervisado.html#cb210-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(.metric <span class="sc">==</span> <span class="st">&quot;rsq&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb210-5"><a href="machine-learning-aprendizaje-supervisado.html#cb210-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> penalty, <span class="at">y =</span> .estimate)) <span class="sc">+</span></span>
<span id="cb210-6"><a href="machine-learning-aprendizaje-supervisado.html#cb210-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb210-7"><a href="machine-learning-aprendizaje-supervisado.html#cb210-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> id))<span class="sc">+</span></span>
<span id="cb210-8"><a href="machine-learning-aprendizaje-supervisado.html#cb210-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb210-9"><a href="machine-learning-aprendizaje-supervisado.html#cb210-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;R cuadrada vs Penalización&#39;</span>)</span>
<span id="cb210-10"><a href="machine-learning-aprendizaje-supervisado.html#cb210-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-11"><a href="machine-learning-aprendizaje-supervisado.html#cb210-11" aria-hidden="true" tabindex="-1"></a>graf_rsq</span></code></pre></div>
<p><img src="Introducci%C3%B3n-a-Ciencia-de-Datos-y-Machine-Learning_files/figure-html/unnamed-chunk-225-1.png" width="672" /></p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="machine-learning-aprendizaje-supervisado.html#cb211-1" aria-hidden="true" tabindex="-1"></a>graf_rmse <span class="ot">&lt;-</span> lasso_ridge_regression_tunning <span class="sc">%&gt;%</span> <span class="fu">unnest</span>(.metrics) <span class="sc">%&gt;%</span> </span>
<span id="cb211-2"><a href="machine-learning-aprendizaje-supervisado.html#cb211-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(.metric <span class="sc">==</span> <span class="st">&quot;rmse&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb211-3"><a href="machine-learning-aprendizaje-supervisado.html#cb211-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> penalty, <span class="at">y =</span> .estimate)) <span class="sc">+</span></span>
<span id="cb211-4"><a href="machine-learning-aprendizaje-supervisado.html#cb211-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb211-5"><a href="machine-learning-aprendizaje-supervisado.html#cb211-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> id))<span class="sc">+</span></span>
<span id="cb211-6"><a href="machine-learning-aprendizaje-supervisado.html#cb211-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb211-7"><a href="machine-learning-aprendizaje-supervisado.html#cb211-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;RMSE vs Penalización&#39;</span>)</span>
<span id="cb211-8"><a href="machine-learning-aprendizaje-supervisado.html#cb211-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-9"><a href="machine-learning-aprendizaje-supervisado.html#cb211-9" aria-hidden="true" tabindex="-1"></a>graf_rmse</span></code></pre></div>
<p><img src="Introducci%C3%B3n-a-Ciencia-de-Datos-y-Machine-Learning_files/figure-html/unnamed-chunk-225-2.png" width="672" /></p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="machine-learning-aprendizaje-supervisado.html#cb212-1" aria-hidden="true" tabindex="-1"></a>graf_mae <span class="ot">&lt;-</span> lasso_ridge_regression_tunning <span class="sc">%&gt;%</span> </span>
<span id="cb212-2"><a href="machine-learning-aprendizaje-supervisado.html#cb212-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(.metrics) <span class="sc">%&gt;%</span> </span>
<span id="cb212-3"><a href="machine-learning-aprendizaje-supervisado.html#cb212-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(.metric <span class="sc">==</span> <span class="st">&quot;mae&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb212-4"><a href="machine-learning-aprendizaje-supervisado.html#cb212-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> penalty, <span class="at">y =</span> .estimate)) <span class="sc">+</span></span>
<span id="cb212-5"><a href="machine-learning-aprendizaje-supervisado.html#cb212-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb212-6"><a href="machine-learning-aprendizaje-supervisado.html#cb212-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> id))<span class="sc">+</span></span>
<span id="cb212-7"><a href="machine-learning-aprendizaje-supervisado.html#cb212-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb212-8"><a href="machine-learning-aprendizaje-supervisado.html#cb212-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;MAE vs Penalización&#39;</span>)</span>
<span id="cb212-9"><a href="machine-learning-aprendizaje-supervisado.html#cb212-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-10"><a href="machine-learning-aprendizaje-supervisado.html#cb212-10" aria-hidden="true" tabindex="-1"></a>graf_mae</span></code></pre></div>
<p><img src="Introducci%C3%B3n-a-Ciencia-de-Datos-y-Machine-Learning_files/figure-html/unnamed-chunk-225-3.png" width="672" /></p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="machine-learning-aprendizaje-supervisado.html#cb213-1" aria-hidden="true" tabindex="-1"></a>lasso_ridge_regression_tunning <span class="sc">%&gt;%</span></span>
<span id="cb213-2"><a href="machine-learning-aprendizaje-supervisado.html#cb213-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collect_metrics</span>() <span class="sc">%&gt;%</span></span>
<span id="cb213-3"><a href="machine-learning-aprendizaje-supervisado.html#cb213-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(mixture <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb213-4"><a href="machine-learning-aprendizaje-supervisado.html#cb213-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(penalty, mean, <span class="at">color =</span> .metric)) <span class="sc">+</span></span>
<span id="cb213-5"><a href="machine-learning-aprendizaje-supervisado.html#cb213-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(</span>
<span id="cb213-6"><a href="machine-learning-aprendizaje-supervisado.html#cb213-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymin =</span> mean <span class="sc">-</span> std_err,</span>
<span id="cb213-7"><a href="machine-learning-aprendizaje-supervisado.html#cb213-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymax =</span> mean <span class="sc">+</span> std_err</span>
<span id="cb213-8"><a href="machine-learning-aprendizaje-supervisado.html#cb213-8" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb213-9"><a href="machine-learning-aprendizaje-supervisado.html#cb213-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb213-10"><a href="machine-learning-aprendizaje-supervisado.html#cb213-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb213-11"><a href="machine-learning-aprendizaje-supervisado.html#cb213-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb213-12"><a href="machine-learning-aprendizaje-supervisado.html#cb213-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>.metric, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>, <span class="at">nrow =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb213-13"><a href="machine-learning-aprendizaje-supervisado.html#cb213-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb213-14"><a href="machine-learning-aprendizaje-supervisado.html#cb213-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="Introducci%C3%B3n-a-Ciencia-de-Datos-y-Machine-Learning_files/figure-html/unnamed-chunk-226-1.png" width="672" /></p>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="machine-learning-aprendizaje-supervisado.html#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Selección de los mejores 10 modelos según la métrica R cuadrada</span></span>
<span id="cb214-2"><a href="machine-learning-aprendizaje-supervisado.html#cb214-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb214-3"><a href="machine-learning-aprendizaje-supervisado.html#cb214-3" aria-hidden="true" tabindex="-1"></a>lasso_ridge_regression_tunning <span class="sc">%&gt;%</span> </span>
<span id="cb214-4"><a href="machine-learning-aprendizaje-supervisado.html#cb214-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">show_best</span>(<span class="at">n =</span> <span class="dv">10</span>, <span class="at">metric =</span> <span class="st">&quot;rsq&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 10 × 8
##    penalty mixture .metric .estimator  mean     n std_err .config               
##      &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;                 
##  1 0.0356        0 rsq     standard   0.724    10  0.0179 Preprocessor1_Model039
##  2 0.0324        0 rsq     standard   0.724    10  0.0179 Preprocessor1_Model038
##  3 0.0391        0 rsq     standard   0.724    10  0.0179 Preprocessor1_Model040
##  4 0.0295        0 rsq     standard   0.724    10  0.0180 Preprocessor1_Model037
##  5 0.001         0 rsq     standard   0.724    10  0.0180 Preprocessor1_Model001
##  6 0.00110       0 rsq     standard   0.724    10  0.0180 Preprocessor1_Model002
##  7 0.00121       0 rsq     standard   0.724    10  0.0180 Preprocessor1_Model003
##  8 0.00133       0 rsq     standard   0.724    10  0.0180 Preprocessor1_Model004
##  9 0.00146       0 rsq     standard   0.724    10  0.0180 Preprocessor1_Model005
## 10 0.00160       0 rsq     standard   0.724    10  0.0180 Preprocessor1_Model006</code></pre>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="machine-learning-aprendizaje-supervisado.html#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Selección del mejor modelo según la métrica R cuadrada</span></span>
<span id="cb216-2"><a href="machine-learning-aprendizaje-supervisado.html#cb216-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb216-3"><a href="machine-learning-aprendizaje-supervisado.html#cb216-3" aria-hidden="true" tabindex="-1"></a>lasso_ridge_regression_best_model <span class="ot">&lt;-</span> <span class="fu">select_best</span>(</span>
<span id="cb216-4"><a href="machine-learning-aprendizaje-supervisado.html#cb216-4" aria-hidden="true" tabindex="-1"></a>  lasso_ridge_regression_tunning, <span class="at">metric =</span> <span class="st">&quot;rsq&quot;</span>)</span>
<span id="cb216-5"><a href="machine-learning-aprendizaje-supervisado.html#cb216-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb216-6"><a href="machine-learning-aprendizaje-supervisado.html#cb216-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Selección del mejor modelo por un error estándar</span></span>
<span id="cb216-7"><a href="machine-learning-aprendizaje-supervisado.html#cb216-7" aria-hidden="true" tabindex="-1"></a>lasso_ridge_regression_best_1se_model <span class="ot">&lt;-</span> <span class="fu">select_by_one_std_err</span>(</span>
<span id="cb216-8"><a href="machine-learning-aprendizaje-supervisado.html#cb216-8" aria-hidden="true" tabindex="-1"></a>  lasso_ridge_regression_tunning, <span class="at">metric =</span> <span class="st">&quot;rsq&quot;</span>, <span class="st">&quot;rsq&quot;</span>)</span>
<span id="cb216-9"><a href="machine-learning-aprendizaje-supervisado.html#cb216-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb216-10"><a href="machine-learning-aprendizaje-supervisado.html#cb216-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Selección del mejor modelo por porcentaje de pérdida</span></span>
<span id="cb216-11"><a href="machine-learning-aprendizaje-supervisado.html#cb216-11" aria-hidden="true" tabindex="-1"></a>lasso_ridge_regression_best_pct_loss_model <span class="ot">&lt;-</span> <span class="fu">select_by_pct_loss</span>(</span>
<span id="cb216-12"><a href="machine-learning-aprendizaje-supervisado.html#cb216-12" aria-hidden="true" tabindex="-1"></a>  lasso_ridge_regression_tunning, <span class="at">metric =</span> <span class="st">&quot;rsq&quot;</span>, <span class="st">&quot;rsq&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="machine-learning-aprendizaje-supervisado.html#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo final </span></span>
<span id="cb217-2"><a href="machine-learning-aprendizaje-supervisado.html#cb217-2" aria-hidden="true" tabindex="-1"></a>lasso_ridge_regression_final_model <span class="ot">&lt;-</span> lasso_ridge_regression_workflow <span class="sc">%&gt;%</span></span>
<span id="cb217-3"><a href="machine-learning-aprendizaje-supervisado.html#cb217-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">finalize_workflow</span>(lasso_ridge_regression_best_1se_model) <span class="sc">%&gt;%</span></span>
<span id="cb217-4"><a href="machine-learning-aprendizaje-supervisado.html#cb217-4" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">fit</span>(<span class="at">data =</span> ames_train)</span>
<span id="cb217-5"><a href="machine-learning-aprendizaje-supervisado.html#cb217-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb217-6"><a href="machine-learning-aprendizaje-supervisado.html#cb217-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-7"><a href="machine-learning-aprendizaje-supervisado.html#cb217-7" aria-hidden="true" tabindex="-1"></a>lasso_ridge_regression_final_model <span class="sc">%&gt;%</span> </span>
<span id="cb217-8"><a href="machine-learning-aprendizaje-supervisado.html#cb217-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb217-9"><a href="machine-learning-aprendizaje-supervisado.html#cb217-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="fu">abs</span>(estimate))) <span class="sc">%&gt;%</span> </span>
<span id="cb217-10"><a href="machine-learning-aprendizaje-supervisado.html#cb217-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">20</span>)</span></code></pre></div>
<pre><code>##              term    estimate penalty
## 1     (Intercept) 12.01919865   0.001
## 2      Year_Built  0.10302381   0.001
## 3   TotRms_AbvGrd  0.07581935   0.001
## 4      Fireplaces  0.07038602   0.001
## 5     Garage_Area  0.05397070   0.001
## 6       Full_Bath  0.05131544   0.001
## 7     Garage_Cars  0.04437585   0.001
## 8    BsmtFin_SF_1 -0.04355381   0.001
## 9    Mas_Vnr_Area  0.03407526   0.001
## 10    Bsmt_Unf_SF  0.03122835   0.001
## 11   Wood_Deck_SF  0.02581743   0.001
## 12       Lot_Area  0.02245877   0.001
## 13   Screen_Porch  0.02166848   0.001
## 14  Open_Porch_SF  0.02070449   0.001
## 15       Misc_Val -0.01964337   0.001
## 16 Enclosed_Porch  0.01926618   0.001
## 17      Longitude -0.01903978   0.001
## 18      Half_Bath  0.01895568   0.001
## 19       Latitude  0.01883234   0.001
## 20  Bedroom_AbvGr -0.01317616   0.001</code></pre>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="machine-learning-aprendizaje-supervisado.html#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicciones</span></span>
<span id="cb219-2"><a href="machine-learning-aprendizaje-supervisado.html#cb219-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-3"><a href="machine-learning-aprendizaje-supervisado.html#cb219-3" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">predict</span>(lasso_ridge_regression_final_model, ames_train) <span class="sc">%&gt;%</span> </span>
<span id="cb219-4"><a href="machine-learning-aprendizaje-supervisado.html#cb219-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(<span class="at">truth =</span> ames_train<span class="sc">$</span>Log_SalePrice) <span class="sc">%&gt;%</span> </span>
<span id="cb219-5"><a href="machine-learning-aprendizaje-supervisado.html#cb219-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">pred_laso_ridge_reg =</span> .pred, <span class="at">log_SalePrice =</span> truth)</span>
<span id="cb219-6"><a href="machine-learning-aprendizaje-supervisado.html#cb219-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-7"><a href="machine-learning-aprendizaje-supervisado.html#cb219-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(results)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 2
##   pred_laso_ridge_reg log_SalePrice
##                 &lt;dbl&gt;         &lt;dbl&gt;
## 1                12.2          12.4
## 2                11.7          11.8
## 3                12.0          12.1
## 4                13.1          13.3
## 5                12.5          12.4
## 6                11.5          11.4</code></pre>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="machine-learning-aprendizaje-supervisado.html#cb221-1" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> yardstick<span class="sc">::</span><span class="fu">metrics</span>(log_SalePrice,pred_laso_ridge_reg)</span></code></pre></div>
<pre><code>## # A tibble: 3 × 3
##   .metric .estimator .estimate
##   &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;
## 1 rmse    standard       0.210
## 2 rsq     standard       0.735
## 3 mae     standard       0.148</code></pre>
</div>
<div id="elasticnet-para-regresión-logística" class="section level3" number="6.6.5">
<h3><span class="header-section-number">6.6.5</span> ElasticNet para regresión logística</h3>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="machine-learning-aprendizaje-supervisado.html#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Declaración del modelo de regresión logística</span></span>
<span id="cb223-2"><a href="machine-learning-aprendizaje-supervisado.html#cb223-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-3"><a href="machine-learning-aprendizaje-supervisado.html#cb223-3" aria-hidden="true" tabindex="-1"></a>regularized_logistic_model <span class="ot">&lt;-</span> <span class="fu">logistic_reg</span>(</span>
<span id="cb223-4"><a href="machine-learning-aprendizaje-supervisado.html#cb223-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">mixture =</span> <span class="fu">tune</span>(), <span class="at">penalty =</span> <span class="fu">tune</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb223-5"><a href="machine-learning-aprendizaje-supervisado.html#cb223-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">&#39;classification&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb223-6"><a href="machine-learning-aprendizaje-supervisado.html#cb223-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">&quot;glmnet&quot;</span>) </span>
<span id="cb223-7"><a href="machine-learning-aprendizaje-supervisado.html#cb223-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-8"><a href="machine-learning-aprendizaje-supervisado.html#cb223-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Declaración del workflow</span></span>
<span id="cb223-9"><a href="machine-learning-aprendizaje-supervisado.html#cb223-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-10"><a href="machine-learning-aprendizaje-supervisado.html#cb223-10" aria-hidden="true" tabindex="-1"></a>regularized_logistic_workflow <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb223-11"><a href="machine-learning-aprendizaje-supervisado.html#cb223-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(telco_rec) <span class="sc">%&gt;%</span> </span>
<span id="cb223-12"><a href="machine-learning-aprendizaje-supervisado.html#cb223-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(regularized_logistic_model)</span>
<span id="cb223-13"><a href="machine-learning-aprendizaje-supervisado.html#cb223-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-14"><a href="machine-learning-aprendizaje-supervisado.html#cb223-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-15"><a href="machine-learning-aprendizaje-supervisado.html#cb223-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Fijación de parámetros</span></span>
<span id="cb223-16"><a href="machine-learning-aprendizaje-supervisado.html#cb223-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-17"><a href="machine-learning-aprendizaje-supervisado.html#cb223-17" aria-hidden="true" tabindex="-1"></a>regularized_parameters_set <span class="ot">&lt;-</span> <span class="fu">parameters</span>(</span>
<span id="cb223-18"><a href="machine-learning-aprendizaje-supervisado.html#cb223-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">penalty</span>(</span>
<span id="cb223-19"><a href="machine-learning-aprendizaje-supervisado.html#cb223-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">range =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">2</span>),</span>
<span id="cb223-20"><a href="machine-learning-aprendizaje-supervisado.html#cb223-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">trans =</span> <span class="fu">log10_trans</span>()</span>
<span id="cb223-21"><a href="machine-learning-aprendizaje-supervisado.html#cb223-21" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb223-22"><a href="machine-learning-aprendizaje-supervisado.html#cb223-22" aria-hidden="true" tabindex="-1"></a>  dials<span class="sc">::</span><span class="fu">mixture</span>()</span>
<span id="cb223-23"><a href="machine-learning-aprendizaje-supervisado.html#cb223-23" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb223-24"><a href="machine-learning-aprendizaje-supervisado.html#cb223-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-25"><a href="machine-learning-aprendizaje-supervisado.html#cb223-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Declaración del grid </span></span>
<span id="cb223-26"><a href="machine-learning-aprendizaje-supervisado.html#cb223-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-27"><a href="machine-learning-aprendizaje-supervisado.html#cb223-27" aria-hidden="true" tabindex="-1"></a>regularized_parameters_grid <span class="ot">&lt;-</span> <span class="fu">grid_regular</span>(</span>
<span id="cb223-28"><a href="machine-learning-aprendizaje-supervisado.html#cb223-28" aria-hidden="true" tabindex="-1"></a>  regularized_parameters_set, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">15</span>)</span>
<span id="cb223-29"><a href="machine-learning-aprendizaje-supervisado.html#cb223-29" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb223-30"><a href="machine-learning-aprendizaje-supervisado.html#cb223-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-31"><a href="machine-learning-aprendizaje-supervisado.html#cb223-31" aria-hidden="true" tabindex="-1"></a>ctrl_grid <span class="ot">&lt;-</span> <span class="fu">control_grid</span>(<span class="at">save_pred =</span> T, <span class="at">verbose =</span> T)</span>
<span id="cb223-32"><a href="machine-learning-aprendizaje-supervisado.html#cb223-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-33"><a href="machine-learning-aprendizaje-supervisado.html#cb223-33" aria-hidden="true" tabindex="-1"></a><span class="co"># V Fold Cross Validation</span></span>
<span id="cb223-34"><a href="machine-learning-aprendizaje-supervisado.html#cb223-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-35"><a href="machine-learning-aprendizaje-supervisado.html#cb223-35" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb223-36"><a href="machine-learning-aprendizaje-supervisado.html#cb223-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-37"><a href="machine-learning-aprendizaje-supervisado.html#cb223-37" aria-hidden="true" tabindex="-1"></a>telco_folds <span class="ot">&lt;-</span> <span class="fu">vfold_cv</span>(telco_train)</span></code></pre></div>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="machine-learning-aprendizaje-supervisado.html#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Se crea el cluster de trabajo </span></span>
<span id="cb224-2"><a href="machine-learning-aprendizaje-supervisado.html#cb224-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-3"><a href="machine-learning-aprendizaje-supervisado.html#cb224-3" aria-hidden="true" tabindex="-1"></a>UseCores <span class="ot">&lt;-</span> <span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb224-4"><a href="machine-learning-aprendizaje-supervisado.html#cb224-4" aria-hidden="true" tabindex="-1"></a>cluster <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(UseCores)</span>
<span id="cb224-5"><a href="machine-learning-aprendizaje-supervisado.html#cb224-5" aria-hidden="true" tabindex="-1"></a><span class="fu">registerDoParallel</span>(cluster)</span>
<span id="cb224-6"><a href="machine-learning-aprendizaje-supervisado.html#cb224-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-7"><a href="machine-learning-aprendizaje-supervisado.html#cb224-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-8"><a href="machine-learning-aprendizaje-supervisado.html#cb224-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Se corre tune grid </span></span>
<span id="cb224-9"><a href="machine-learning-aprendizaje-supervisado.html#cb224-9" aria-hidden="true" tabindex="-1"></a>rlmt1 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb224-10"><a href="machine-learning-aprendizaje-supervisado.html#cb224-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-11"><a href="machine-learning-aprendizaje-supervisado.html#cb224-11" aria-hidden="true" tabindex="-1"></a>regularized_tune_result <span class="ot">&lt;-</span> <span class="fu">tune_grid</span>(</span>
<span id="cb224-12"><a href="machine-learning-aprendizaje-supervisado.html#cb224-12" aria-hidden="true" tabindex="-1"></a>  regularized_logistic_workflow,</span>
<span id="cb224-13"><a href="machine-learning-aprendizaje-supervisado.html#cb224-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">resamples =</span> telco_folds,</span>
<span id="cb224-14"><a href="machine-learning-aprendizaje-supervisado.html#cb224-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">grid =</span> regularized_parameters_grid,</span>
<span id="cb224-15"><a href="machine-learning-aprendizaje-supervisado.html#cb224-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">metrics =</span> <span class="fu">metric_set</span>(roc_auc, pr_auc),</span>
<span id="cb224-16"><a href="machine-learning-aprendizaje-supervisado.html#cb224-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> ctrl_grid</span>
<span id="cb224-17"><a href="machine-learning-aprendizaje-supervisado.html#cb224-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb224-18"><a href="machine-learning-aprendizaje-supervisado.html#cb224-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-19"><a href="machine-learning-aprendizaje-supervisado.html#cb224-19" aria-hidden="true" tabindex="-1"></a>rlmt2 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>(); rlmt2 <span class="sc">-</span> rlmt1 <span class="co"># Tiempo que tardó el modelado</span></span>
<span id="cb224-20"><a href="machine-learning-aprendizaje-supervisado.html#cb224-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-21"><a href="machine-learning-aprendizaje-supervisado.html#cb224-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Se detiene el cluster de trabajo</span></span>
<span id="cb224-22"><a href="machine-learning-aprendizaje-supervisado.html#cb224-22" aria-hidden="true" tabindex="-1"></a><span class="fu">stopCluster</span>(cluster) </span>
<span id="cb224-23"><a href="machine-learning-aprendizaje-supervisado.html#cb224-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-24"><a href="machine-learning-aprendizaje-supervisado.html#cb224-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Se guarda tune_grid en formato RDS</span></span>
<span id="cb224-25"><a href="machine-learning-aprendizaje-supervisado.html#cb224-25" aria-hidden="true" tabindex="-1"></a>regularized_tune_result <span class="sc">%&gt;%</span> </span>
<span id="cb224-26"><a href="machine-learning-aprendizaje-supervisado.html#cb224-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">saveRDS</span>(<span class="st">&quot;models/ml/regularized_logistic_regression.rds&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="machine-learning-aprendizaje-supervisado.html#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Se carga el modelo</span></span>
<span id="cb225-2"><a href="machine-learning-aprendizaje-supervisado.html#cb225-2" aria-hidden="true" tabindex="-1"></a>regularized_tune_result <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;models/ml/regularized_logistic_regression.rds&quot;</span>)</span>
<span id="cb225-3"><a href="machine-learning-aprendizaje-supervisado.html#cb225-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-4"><a href="machine-learning-aprendizaje-supervisado.html#cb225-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Métricas</span></span>
<span id="cb225-5"><a href="machine-learning-aprendizaje-supervisado.html#cb225-5" aria-hidden="true" tabindex="-1"></a>regularized_tune_result <span class="sc">%&gt;%</span> <span class="fu">unnest</span>(.metrics)</span></code></pre></div>
<pre><code>## # A tibble: 4,500 × 10
##    splits   id     penalty mixture .metric .estimator .estimate .config  .notes 
##    &lt;list&gt;   &lt;chr&gt;    &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;    &lt;list&gt; 
##  1 &lt;split … Fold… 1   e-10       0 roc_auc binary         0.777 Preproc… &lt;tibbl…
##  2 &lt;split … Fold… 7.20e-10       0 roc_auc binary         0.777 Preproc… &lt;tibbl…
##  3 &lt;split … Fold… 5.18e- 9       0 roc_auc binary         0.777 Preproc… &lt;tibbl…
##  4 &lt;split … Fold… 3.73e- 8       0 roc_auc binary         0.777 Preproc… &lt;tibbl…
##  5 &lt;split … Fold… 2.68e- 7       0 roc_auc binary         0.777 Preproc… &lt;tibbl…
##  6 &lt;split … Fold… 1.93e- 6       0 roc_auc binary         0.777 Preproc… &lt;tibbl…
##  7 &lt;split … Fold… 1.39e- 5       0 roc_auc binary         0.777 Preproc… &lt;tibbl…
##  8 &lt;split … Fold… 1   e- 4       0 roc_auc binary         0.777 Preproc… &lt;tibbl…
##  9 &lt;split … Fold… 7.20e- 4       0 roc_auc binary         0.777 Preproc… &lt;tibbl…
## 10 &lt;split … Fold… 5.18e- 3       0 roc_auc binary         0.777 Preproc… &lt;tibbl…
## # … with 4,490 more rows, and 1 more variable: .predictions &lt;list&gt;</code></pre>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="machine-learning-aprendizaje-supervisado.html#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Analizando las métricas de manera visual </span></span>
<span id="cb227-2"><a href="machine-learning-aprendizaje-supervisado.html#cb227-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-3"><a href="machine-learning-aprendizaje-supervisado.html#cb227-3" aria-hidden="true" tabindex="-1"></a>graf_prec <span class="ot">&lt;-</span> regularized_tune_result <span class="sc">%&gt;%</span> </span>
<span id="cb227-4"><a href="machine-learning-aprendizaje-supervisado.html#cb227-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(.metrics) <span class="sc">%&gt;%</span> </span>
<span id="cb227-5"><a href="machine-learning-aprendizaje-supervisado.html#cb227-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(.metric <span class="sc">==</span> <span class="st">&quot;pr_auc&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb227-6"><a href="machine-learning-aprendizaje-supervisado.html#cb227-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> penalty, <span class="at">y =</span> .estimate)) <span class="sc">+</span></span>
<span id="cb227-7"><a href="machine-learning-aprendizaje-supervisado.html#cb227-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb227-8"><a href="machine-learning-aprendizaje-supervisado.html#cb227-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> id))<span class="sc">+</span></span>
<span id="cb227-9"><a href="machine-learning-aprendizaje-supervisado.html#cb227-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb227-10"><a href="machine-learning-aprendizaje-supervisado.html#cb227-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Precisión: Penalización vs. PR AUC&#39;</span>)</span>
<span id="cb227-11"><a href="machine-learning-aprendizaje-supervisado.html#cb227-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-12"><a href="machine-learning-aprendizaje-supervisado.html#cb227-12" aria-hidden="true" tabindex="-1"></a>graf_prec</span></code></pre></div>
<p><img src="Introducci%C3%B3n-a-Ciencia-de-Datos-y-Machine-Learning_files/figure-html/unnamed-chunk-235-1.png" width="672" /></p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="machine-learning-aprendizaje-supervisado.html#cb228-1" aria-hidden="true" tabindex="-1"></a>graf_roc <span class="ot">&lt;-</span> regularized_tune_result <span class="sc">%&gt;%</span> </span>
<span id="cb228-2"><a href="machine-learning-aprendizaje-supervisado.html#cb228-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(.metrics) <span class="sc">%&gt;%</span> </span>
<span id="cb228-3"><a href="machine-learning-aprendizaje-supervisado.html#cb228-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(.metric <span class="sc">==</span> <span class="st">&quot;roc_auc&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb228-4"><a href="machine-learning-aprendizaje-supervisado.html#cb228-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> penalty, <span class="at">y =</span> .estimate)) <span class="sc">+</span></span>
<span id="cb228-5"><a href="machine-learning-aprendizaje-supervisado.html#cb228-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb228-6"><a href="machine-learning-aprendizaje-supervisado.html#cb228-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> id))<span class="sc">+</span></span>
<span id="cb228-7"><a href="machine-learning-aprendizaje-supervisado.html#cb228-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb228-8"><a href="machine-learning-aprendizaje-supervisado.html#cb228-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;AUC: Penalización vs. ROC AUC&#39;</span>)</span>
<span id="cb228-9"><a href="machine-learning-aprendizaje-supervisado.html#cb228-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-10"><a href="machine-learning-aprendizaje-supervisado.html#cb228-10" aria-hidden="true" tabindex="-1"></a>graf_roc</span></code></pre></div>
<p><img src="Introducci%C3%B3n-a-Ciencia-de-Datos-y-Machine-Learning_files/figure-html/unnamed-chunk-235-2.png" width="672" /></p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="machine-learning-aprendizaje-supervisado.html#cb229-1" aria-hidden="true" tabindex="-1"></a>regularized_tune_result <span class="sc">%&gt;%</span></span>
<span id="cb229-2"><a href="machine-learning-aprendizaje-supervisado.html#cb229-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collect_metrics</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb229-3"><a href="machine-learning-aprendizaje-supervisado.html#cb229-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(mixture <span class="sc">==</span> <span class="fl">0.5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb229-4"><a href="machine-learning-aprendizaje-supervisado.html#cb229-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(penalty, mean, <span class="at">color =</span> .metric)) <span class="sc">+</span></span>
<span id="cb229-5"><a href="machine-learning-aprendizaje-supervisado.html#cb229-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(</span>
<span id="cb229-6"><a href="machine-learning-aprendizaje-supervisado.html#cb229-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">ymin =</span> mean <span class="sc">-</span> std_err, <span class="at">ymax =</span> mean <span class="sc">+</span> std_err),</span>
<span id="cb229-7"><a href="machine-learning-aprendizaje-supervisado.html#cb229-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb229-8"><a href="machine-learning-aprendizaje-supervisado.html#cb229-8" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb229-9"><a href="machine-learning-aprendizaje-supervisado.html#cb229-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb229-10"><a href="machine-learning-aprendizaje-supervisado.html#cb229-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>.metric, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>, <span class="at">nrow =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb229-11"><a href="machine-learning-aprendizaje-supervisado.html#cb229-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb229-12"><a href="machine-learning-aprendizaje-supervisado.html#cb229-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="Introducci%C3%B3n-a-Ciencia-de-Datos-y-Machine-Learning_files/figure-html/unnamed-chunk-236-1.png" width="672" /></p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="machine-learning-aprendizaje-supervisado.html#cb230-1" aria-hidden="true" tabindex="-1"></a>regularized_tune_result <span class="sc">%&gt;%</span> <span class="fu">collect_metrics</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb230-2"><a href="machine-learning-aprendizaje-supervisado.html#cb230-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(.metric) <span class="sc">%&gt;%</span> </span>
<span id="cb230-3"><a href="machine-learning-aprendizaje-supervisado.html#cb230-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb230-4"><a href="machine-learning-aprendizaje-supervisado.html#cb230-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">max =</span> <span class="fu">max</span>(mean),</span>
<span id="cb230-5"><a href="machine-learning-aprendizaje-supervisado.html#cb230-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">min =</span> <span class="fu">min</span>(mean),</span>
<span id="cb230-6"><a href="machine-learning-aprendizaje-supervisado.html#cb230-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean =</span> <span class="fu">mean</span>(mean),</span>
<span id="cb230-7"><a href="machine-learning-aprendizaje-supervisado.html#cb230-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">median =</span> <span class="fu">median</span>(mean),</span>
<span id="cb230-8"><a href="machine-learning-aprendizaje-supervisado.html#cb230-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span></span>
<span id="cb230-9"><a href="machine-learning-aprendizaje-supervisado.html#cb230-9" aria-hidden="true" tabindex="-1"></a>    )</span></code></pre></div>
<pre><code>## # A tibble: 2 × 5
##   .metric   max   min  mean median
##   &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
## 1 pr_auc  0.912 0.868 0.901  0.901
## 2 roc_auc 0.801 0.5   0.730  0.730</code></pre>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="machine-learning-aprendizaje-supervisado.html#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Mejores 10 resultados para la métrica de precisión</span></span>
<span id="cb232-2"><a href="machine-learning-aprendizaje-supervisado.html#cb232-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-3"><a href="machine-learning-aprendizaje-supervisado.html#cb232-3" aria-hidden="true" tabindex="-1"></a><span class="fu">show_best</span>(regularized_tune_result, <span class="at">n =</span> <span class="dv">10</span>, <span class="at">metric =</span> <span class="st">&quot;pr_auc&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 10 × 8
##    penalty mixture .metric .estimator  mean     n std_err .config               
##      &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;                 
##  1 0.0373    0.929 pr_auc  binary     0.912    10 0.00492 Preprocessor1_Model206
##  2 0.0373    0.857 pr_auc  binary     0.912    10 0.00494 Preprocessor1_Model191
##  3 0.0373    1     pr_auc  binary     0.912    10 0.00493 Preprocessor1_Model221
##  4 0.0373    0.786 pr_auc  binary     0.912    10 0.00496 Preprocessor1_Model176
##  5 0.0373    0.714 pr_auc  binary     0.911    10 0.00497 Preprocessor1_Model161
##  6 0.0373    0.643 pr_auc  binary     0.911    10 0.00497 Preprocessor1_Model146
##  7 0.00518   0.929 pr_auc  binary     0.911    10 0.00495 Preprocessor1_Model205
##  8 0.00518   1     pr_auc  binary     0.911    10 0.00494 Preprocessor1_Model220
##  9 0.00518   0.857 pr_auc  binary     0.911    10 0.00495 Preprocessor1_Model190
## 10 0.00518   0.786 pr_auc  binary     0.911    10 0.00495 Preprocessor1_Model175</code></pre>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="machine-learning-aprendizaje-supervisado.html#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Selección del mejor modelo según la métrica de precisión</span></span>
<span id="cb234-2"><a href="machine-learning-aprendizaje-supervisado.html#cb234-2" aria-hidden="true" tabindex="-1"></a>best_regularized_logistic_model <span class="ot">&lt;-</span> <span class="fu">select_best</span>(regularized_tune_result, <span class="at">metric =</span> <span class="st">&quot;pr_auc&quot;</span>)</span>
<span id="cb234-3"><a href="machine-learning-aprendizaje-supervisado.html#cb234-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb234-4"><a href="machine-learning-aprendizaje-supervisado.html#cb234-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Selección del mejor modelo por un error estándar</span></span>
<span id="cb234-5"><a href="machine-learning-aprendizaje-supervisado.html#cb234-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb234-6"><a href="machine-learning-aprendizaje-supervisado.html#cb234-6" aria-hidden="true" tabindex="-1"></a>best_regularized_logistic_model_1se <span class="ot">&lt;-</span> <span class="fu">select_by_one_std_err</span>(</span>
<span id="cb234-7"><a href="machine-learning-aprendizaje-supervisado.html#cb234-7" aria-hidden="true" tabindex="-1"></a>  regularized_tune_result, <span class="at">metric =</span> <span class="st">&quot;pr_auc&quot;</span>, <span class="st">&quot;pr_auc&quot;</span>)</span>
<span id="cb234-8"><a href="machine-learning-aprendizaje-supervisado.html#cb234-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb234-9"><a href="machine-learning-aprendizaje-supervisado.html#cb234-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo final</span></span>
<span id="cb234-10"><a href="machine-learning-aprendizaje-supervisado.html#cb234-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb234-11"><a href="machine-learning-aprendizaje-supervisado.html#cb234-11" aria-hidden="true" tabindex="-1"></a>final_regularized_logistic_model <span class="ot">&lt;-</span> regularized_logistic_workflow <span class="sc">%&gt;%</span> </span>
<span id="cb234-12"><a href="machine-learning-aprendizaje-supervisado.html#cb234-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">finalize_workflow</span>(best_regularized_logistic_model_1se) <span class="sc">%&gt;%</span> </span>
<span id="cb234-13"><a href="machine-learning-aprendizaje-supervisado.html#cb234-13" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">fit</span>(<span class="at">data =</span> telco_train)</span></code></pre></div>
<pre><code>## Warning: There are new levels in a factor: NA</code></pre>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="machine-learning-aprendizaje-supervisado.html#cb236-1" aria-hidden="true" tabindex="-1"></a>final_regularized_logistic_model <span class="sc">%&gt;%</span> <span class="fu">tidy</span>() </span></code></pre></div>
<pre><code>## # A tibble: 5 × 3
##   term                                                       estimate    penalty
##   &lt;chr&gt;                                                         &lt;dbl&gt;      &lt;dbl&gt;
## 1 (Intercept)                                                  -1.18       1e-10
## 2 SeniorCitizen                                                 0.233      1e-10
## 3 MonthlyCharges                                                1.13       1e-10
## 4 TotalCharges                                                 -1.20       1e-10
## 5 tenure_c..0.1.year....1.2.years....2.3.years....3.4.years…   -0.350      1e-10</code></pre>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="machine-learning-aprendizaje-supervisado.html#cb238-1" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">predict</span>(final_regularized_logistic_model, telco_train, <span class="at">type =</span> <span class="st">&#39;prob&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb238-2"><a href="machine-learning-aprendizaje-supervisado.html#cb238-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(<span class="at">truth =</span>telco_train<span class="sc">$</span>Churn) <span class="sc">%&gt;%</span> </span>
<span id="cb238-3"><a href="machine-learning-aprendizaje-supervisado.html#cb238-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">truth =</span> <span class="fu">factor</span>(truth, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&#39;No&#39;</span>, <span class="st">&#39;Yes&#39;</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;No&#39;</span>, <span class="st">&#39;Yes&#39;</span>)))</span></code></pre></div>
<pre><code>## Warning: There are new levels in a factor: NA</code></pre>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="machine-learning-aprendizaje-supervisado.html#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(results, <span class="dv">10</span>)</span></code></pre></div>
<pre><code>## # A tibble: 10 × 3
##    .pred_No .pred_Yes truth
##       &lt;dbl&gt;     &lt;dbl&gt; &lt;fct&gt;
##  1    0.900    0.100  No   
##  2    0.750    0.250  No   
##  3    0.826    0.174  No   
##  4    0.249    0.751  Yes  
##  5    0.480    0.520  Yes  
##  6    0.818    0.182  No   
##  7    0.553    0.447  No   
##  8    0.905    0.0950 No   
##  9    0.895    0.105  No   
## 10    0.790    0.210  No</code></pre>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="machine-learning-aprendizaje-supervisado.html#cb242-1" aria-hidden="true" tabindex="-1"></a>pr_curve_data <span class="ot">&lt;-</span> <span class="fu">pr_curve</span>(</span>
<span id="cb242-2"><a href="machine-learning-aprendizaje-supervisado.html#cb242-2" aria-hidden="true" tabindex="-1"></a>  results, </span>
<span id="cb242-3"><a href="machine-learning-aprendizaje-supervisado.html#cb242-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">truth =</span> truth, </span>
<span id="cb242-4"><a href="machine-learning-aprendizaje-supervisado.html#cb242-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">estimate =</span> .pred_Yes, </span>
<span id="cb242-5"><a href="machine-learning-aprendizaje-supervisado.html#cb242-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">event_level =</span> <span class="st">&#39;second&#39;</span></span>
<span id="cb242-6"><a href="machine-learning-aprendizaje-supervisado.html#cb242-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb242-7"><a href="machine-learning-aprendizaje-supervisado.html#cb242-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-8"><a href="machine-learning-aprendizaje-supervisado.html#cb242-8" aria-hidden="true" tabindex="-1"></a>roc_curve_data <span class="ot">&lt;-</span> <span class="fu">roc_curve</span>(</span>
<span id="cb242-9"><a href="machine-learning-aprendizaje-supervisado.html#cb242-9" aria-hidden="true" tabindex="-1"></a>  results, </span>
<span id="cb242-10"><a href="machine-learning-aprendizaje-supervisado.html#cb242-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">truth =</span> truth, </span>
<span id="cb242-11"><a href="machine-learning-aprendizaje-supervisado.html#cb242-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">estimate =</span> .pred_Yes, </span>
<span id="cb242-12"><a href="machine-learning-aprendizaje-supervisado.html#cb242-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">event_level =</span> <span class="st">&#39;second&#39;</span></span>
<span id="cb242-13"><a href="machine-learning-aprendizaje-supervisado.html#cb242-13" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="machine-learning-aprendizaje-supervisado.html#cb243-1" aria-hidden="true" tabindex="-1"></a>pr_curve_plot <span class="ot">&lt;-</span> pr_curve_data <span class="sc">%&gt;%</span> </span>
<span id="cb243-2"><a href="machine-learning-aprendizaje-supervisado.html#cb243-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> recall, <span class="at">y =</span> precision)) <span class="sc">+</span></span>
<span id="cb243-3"><a href="machine-learning-aprendizaje-supervisado.html#cb243-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">&#39;lightblue&#39;</span>) <span class="sc">+</span></span>
<span id="cb243-4"><a href="machine-learning-aprendizaje-supervisado.html#cb243-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>() <span class="sc">+</span></span>
<span id="cb243-5"><a href="machine-learning-aprendizaje-supervisado.html#cb243-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Precision vs Recall&quot;</span>)<span class="sc">+</span></span>
<span id="cb243-6"><a href="machine-learning-aprendizaje-supervisado.html#cb243-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb243-7"><a href="machine-learning-aprendizaje-supervisado.html#cb243-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-8"><a href="machine-learning-aprendizaje-supervisado.html#cb243-8" aria-hidden="true" tabindex="-1"></a>pr_curve_plot</span></code></pre></div>
<p><img src="Introducci%C3%B3n-a-Ciencia-de-Datos-y-Machine-Learning_files/figure-html/unnamed-chunk-242-1.png" width="672" /></p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="machine-learning-aprendizaje-supervisado.html#cb244-1" aria-hidden="true" tabindex="-1"></a>roc_curve_plot <span class="ot">&lt;-</span> roc_curve_data <span class="sc">%&gt;%</span> </span>
<span id="cb244-2"><a href="machine-learning-aprendizaje-supervisado.html#cb244-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">1</span> <span class="sc">-</span> specificity, <span class="at">y =</span> sensitivity)) <span class="sc">+</span></span>
<span id="cb244-3"><a href="machine-learning-aprendizaje-supervisado.html#cb244-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">&#39;lightblue&#39;</span>) <span class="sc">+</span></span>
<span id="cb244-4"><a href="machine-learning-aprendizaje-supervisado.html#cb244-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>() <span class="sc">+</span></span>
<span id="cb244-5"><a href="machine-learning-aprendizaje-supervisado.html#cb244-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>() <span class="sc">+</span></span>
<span id="cb244-6"><a href="machine-learning-aprendizaje-supervisado.html#cb244-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;ROC Curve&quot;</span>)<span class="sc">+</span></span>
<span id="cb244-7"><a href="machine-learning-aprendizaje-supervisado.html#cb244-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb244-8"><a href="machine-learning-aprendizaje-supervisado.html#cb244-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb244-9"><a href="machine-learning-aprendizaje-supervisado.html#cb244-9" aria-hidden="true" tabindex="-1"></a>roc_curve_plot</span></code></pre></div>
<p><img src="Introducci%C3%B3n-a-Ciencia-de-Datos-y-Machine-Learning_files/figure-html/unnamed-chunk-242-2.png" width="672" /></p>
<p>La curva Recall vs. Precision muestra la compensación entre precisión y recall
para diferentes umbrales. Un área alta debajo de la curva representa tanto un
alto recall como una alta precisión, donde la alta precisión se relaciona con
una tasa baja de falsos positivos y recall alto se relaciona con una tasa baja
de falsos negativos. Los puntajes altos para ambos muestran que el clasificador
está arrojando resultados precisos (alta precisión), así como también arroja la mayoría de todos los resultados positivos (alto recall).</p>
<p>Por ejemplo, en caso de que queramos tener una sensibilidad al rededor de 0.75, inevitablemente
se obtendrá una tasa de falsos positivos de 0.2.</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="machine-learning-aprendizaje-supervisado.html#cb245-1" aria-hidden="true" tabindex="-1"></a>roc_curve_plot</span></code></pre></div>
<p><img src="Introducci%C3%B3n-a-Ciencia-de-Datos-y-Machine-Learning_files/figure-html/unnamed-chunk-243-1.png" width="672" /></p>
<p>Una curva ROC es un gráfico que muestra el rendimiento de un modelo de clasificación
en todos los umbrales de clasificación. Esta curva traza dos parámetros:</p>
<ul>
<li><p>Tasa de verdaderos positivos:</p>
<p><span class="math display">\[TPR=\frac{TP}{TP + FN}\]</span></p></li>
<li><p>Tasa de falsos positivos:</p>
<p><span class="math display">\[FPR = \frac{FP}{FP + TN}\]</span>
Una curva <em>ROC</em> traza <em>TPR</em> frente a <em>FPR</em> en diferentes umbrales de clasificación.
Si se reduce el umbral de clasificación, se clasifican más elementos como positivos,
lo que aumenta tanto los falsos positivos como los verdaderos positivos.</p></li>
</ul>
<p>Por ejemplo, si queremos tener una precisión de 0.80, la cobertura será apenas de 0.125 del total de positivos.</p>
</div>
</div>
<div id="knn-k-nearest-neighbor" class="section level2" number="6.7">
<h2><span class="header-section-number">6.7</span> KNN: K-Nearest-Neighbor</h2>
<p>KNN es un algoritmo de aprendizaje supervisado que podemos usar para regresión o clasificación.</p>
<p>La idea detrás del algoritmo es sencilla, este clasifica una nueva observación en la categoria que tenga mas elementos de las k observaciones más cercanas. Es decir, se calculará la distancia de esta nueva observación a cada observación existente, ordenaremos estas distancias de menor a mayor, tomamos las k primeras distancias, la nueva observación sera asignada al grupo que tenga mayor número de observaciones en estas k primeras distancias.</p>
<p><strong>Clasificación</strong></p>
<p>¿Cómo debería ser clasificada la nueva observación?</p>
<p><img src="img/ml/3-10-1-knn-clasificacion.png" width="700pt" height="500pt" style="display: block; margin: auto;" /></p>
<p><img src="img/ml/3-10-1-knn-all.png" width="700pt" height="500pt" style="display: block; margin: auto;" /></p>
<p><strong>Ejemplo:</strong></p>
<p><img src="img/ml/3-10-1-knn-clasificacion2.png" width="700pt" height="500pt" style="display: block; margin: auto;" /></p>
<p><strong>Regresión:</strong></p>
<p>Considerando un modelo de 3 vecinos más cercanos, las siguientes imágenes muestran el proceso de ajuste y predicción de nuevas observaciones.</p>
<p><img src="img/ml/3-10-1-regression1.png" width="350pt" height="300pt" /><img src="img/ml/3-10-1-regression2.png" width="350pt" height="300pt" /></p>
<p><img src="img/ml/3-10-1-regression3.png" width="350pt" height="300pt" style="display: block; margin: auto;" /></p>
<p><strong>Ejemplo de balance de sesgo y varianza</strong></p>
<p><img src="img/ml/3-10-1-knn-regresion2.png" width="700pt" height="500pt" style="display: block; margin: auto;" /></p>
<div id="ajuste-del-modelo-1" class="section level3" number="6.7.1">
<h3><span class="header-section-number">6.7.1</span> Ajuste del modelo</h3>
<p>En contraste con otros algoritmos de aprendizaje supervisado, K-NN no genera un modelo del aprendizaje con datos de entrenamiento, sino que el aprendizaje sucede en el mismo momento en el que se prueban los datos de prueba. A este tipo de algoritmos se les llama <em>lazy learning methods</em> porque no aprende del conjunto de entrenamiento inmediatamente, sino que almacena el conjunto de datos y, en el momento de la clasificación, realiza una acción en el conjunto de datos.</p>
<p>El algoritmo KNN en la fase de entrenamiento simplemente almacena el conjunto de datos y cuando obtiene nuevos datos, clasifica esos datos en una categoría que es muy similar a los nuevos datos.</p>
<div id="el-algortimo-knn" class="section level4" number="6.7.1.1">
<h4><span class="header-section-number">6.7.1.1</span> <strong>El algortimo KNN</strong></h4>
<ol style="list-style-type: decimal">
<li><p>Seleccionamos K como el número elegido de vecinos.</p></li>
<li><p>Para cada observación en el conjunto de entrenamiento calculamos la distancia con la nueva observación.</p></li>
<li><p>Ordenamos las distancias de menor a mayor.</p></li>
<li><p>Tomamos las primeras K entradas de la lista ordenada.</p></li>
<li><p>Tomamos la variable respuesta de las K entradas seleccionadas, (no importa si es regresión o clasificación).</p></li>
<li><p>Si estamos en un problema de regresión el output será la media de las K variables respuesta.</p></li>
<li><p>Si es un problema de clasificación regresaremos la moda de las K variables respuesta.</p></li>
</ol>
</div>
<div id="cómo-seleccionar-k" class="section level4" number="6.7.1.2">
<h4><span class="header-section-number">6.7.1.2</span> <strong>¿Cómo seleccionar k?</strong></h4>
<p>Al configurar un modelo KNN, sólo hay algunos parámetros que deben elegirse/ajustarse para mejorar el rendimiento, uno de estos parámetros es el valor de la K.</p>
<p>No existe una forma particular de determinar el mejor valor para “K,” por lo que debemos probar algunos valores para encontrar “el mejor” de ellos.</p>
<p>Para los modelos de clasificación, especialmente si solo hay dos clases, generalmente se elige un número impar para k. Esto es para que el algoritmo nunca llegue a un “empate”</p>
<p>Una opción para seleccionar la K adecuada es ejecutar el algoritmo KNN varias veces con diferentes valores de K y elegimos la K que reduce la cantidad de errores mientras se mantiene la capacidad del algoritmo para hacer predicciones con precisión.</p>
<p>Observemos lo siguiente:</p>
<p><img src="img/ml/3-10-1-kerror2.png" width="500pt" height="300pt" style="display: block; margin: auto;" /></p>
<p>Estas gráficas se conoce como “gráfica de codo” y generalmente se usan para determinar el valor K.</p>
<ul>
<li><p>A medida que disminuimos el valor de K a 1, nuestras predicciones se vuelven menos estables. Imaginemos que tomamos K = 1 y tenemos un punto de consulta rodeado por varios rojos y uno verde, pero el verde es el vecino más cercano. Razonablemente, pensaríamos que el punto de consulta es probablemente rojo, pero como K = 1, KNN predice incorrectamente que el punto de consulta es verde.</p></li>
<li><p>Inversamente, a medida que aumentamos el valor de K, nuestras predicciones se vuelven más estables debido a que tenemos más observaciones con quienes comparar, por lo tanto, es más probable que hagan predicciones más precisas. Eventualmente, comenzamos a presenciar un número creciente de errores, es en este punto que sabemos que hemos llevado el valor de K demasiado lejos.</p></li>
</ul>
</div>
<div id="métodos-de-cálculo-de-la-distancia-entre-observaciones" class="section level4" number="6.7.1.3">
<h4><span class="header-section-number">6.7.1.3</span> <strong>Métodos de cálculo de la distancia entre observaciones</strong></h4>
<p>Otro parámetro que podemos ajustar para el modelo es la distancia usada, existen diferentes formas de medir qué tan “cerca” están dos puntos entre sí, y las diferencias entre estos métodos pueden volverse significativas en dimensiones superiores.</p>
<ul>
<li>La más utilizada es la distancia euclidiana, el tipo estándar de distancia.</li>
</ul>
<p><span class="math display">\[d(X,Y) = \sqrt{\sum_{i=1}^{n} (x_i-y_i)^2}\]</span></p>
<ul>
<li>Otra métrica es la llamada distancia de Manhattan, que mide la distancia tomada en cada dirección cardinal, en lugar de a lo largo de la diagonal.</li>
</ul>
<p><span class="math display">\[d(X,Y) = \sum_{i=1}^{n} |x_i - y_i|\]</span></p>
<ul>
<li>De manera más general, las anteriores son casos particulares de la distancia de Minkowski, cuya fórmula es:</li>
</ul>
<p><span class="math display">\[d(X,Y) = (\sum_{i=1}^{n} |x_i-y_i|^p)^{\frac{1}{p}}\]</span></p>
<ul>
<li>Para variables categóricas podemos usar la distancia de Hamming, donde si X es igual a Y entonces la distancia es 0, si son distintos la distancia es 1.</li>
</ul>
</div>
</div>
<div id="implementación-en-r-2" class="section level3" number="6.7.2">
<h3><span class="header-section-number">6.7.2</span> Implementación en R</h3>
<p>Usaremos las recetas antes implementadas para ajustar tanto el modelo de regresión como el de clasificación. Exploraremos un conjunto de hiperparámetros para elegir el mejor modelo.</p>
<div id="regresión-1" class="section level4" number="6.7.2.1">
<h4><span class="header-section-number">6.7.2.1</span> Regresión:</h4>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="machine-learning-aprendizaje-supervisado.html#cb246-1" aria-hidden="true" tabindex="-1"></a>knn_model <span class="ot">&lt;-</span> <span class="fu">nearest_neighbor</span>(</span>
<span id="cb246-2"><a href="machine-learning-aprendizaje-supervisado.html#cb246-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">mode =</span> <span class="st">&quot;regression&quot;</span>,</span>
<span id="cb246-3"><a href="machine-learning-aprendizaje-supervisado.html#cb246-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">neighbors =</span> <span class="fu">tune</span>(<span class="st">&quot;K&quot;</span>),</span>
<span id="cb246-4"><a href="machine-learning-aprendizaje-supervisado.html#cb246-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">weight_func =</span> <span class="fu">tune</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb246-5"><a href="machine-learning-aprendizaje-supervisado.html#cb246-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">&quot;kknn&quot;</span>)</span>
<span id="cb246-6"><a href="machine-learning-aprendizaje-supervisado.html#cb246-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb246-7"><a href="machine-learning-aprendizaje-supervisado.html#cb246-7" aria-hidden="true" tabindex="-1"></a>knn_workflow <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb246-8"><a href="machine-learning-aprendizaje-supervisado.html#cb246-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(receta_casas) <span class="sc">%&gt;%</span> </span>
<span id="cb246-9"><a href="machine-learning-aprendizaje-supervisado.html#cb246-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(knn_model)</span>
<span id="cb246-10"><a href="machine-learning-aprendizaje-supervisado.html#cb246-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb246-11"><a href="machine-learning-aprendizaje-supervisado.html#cb246-11" aria-hidden="true" tabindex="-1"></a>knn_parameters_set <span class="ot">&lt;-</span> <span class="fu">parameters</span>(knn_workflow) <span class="sc">%&gt;%</span> </span>
<span id="cb246-12"><a href="machine-learning-aprendizaje-supervisado.html#cb246-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">update</span>(<span class="at">K =</span> dials<span class="sc">::</span><span class="fu">neighbors</span>(<span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">80</span>)),</span>
<span id="cb246-13"><a href="machine-learning-aprendizaje-supervisado.html#cb246-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">weight_func =</span> <span class="fu">weight_func</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;rectangular&quot;</span>, <span class="st">&quot;inv&quot;</span>, <span class="st">&quot;gaussian&quot;</span>, <span class="st">&quot;cos&quot;</span>)))</span>
<span id="cb246-14"><a href="machine-learning-aprendizaje-supervisado.html#cb246-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb246-15"><a href="machine-learning-aprendizaje-supervisado.html#cb246-15" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb246-16"><a href="machine-learning-aprendizaje-supervisado.html#cb246-16" aria-hidden="true" tabindex="-1"></a>knn_grid <span class="ot">&lt;-</span> knn_parameters_set <span class="sc">%&gt;%</span> </span>
<span id="cb246-17"><a href="machine-learning-aprendizaje-supervisado.html#cb246-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">grid_max_entropy</span>(<span class="at">size =</span> <span class="dv">150</span>)</span>
<span id="cb246-18"><a href="machine-learning-aprendizaje-supervisado.html#cb246-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb246-19"><a href="machine-learning-aprendizaje-supervisado.html#cb246-19" aria-hidden="true" tabindex="-1"></a>ctrl_grid <span class="ot">&lt;-</span> <span class="fu">control_grid</span>(<span class="at">save_pred =</span> T, <span class="at">verbose =</span> T)</span></code></pre></div>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="machine-learning-aprendizaje-supervisado.html#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(doParallel)</span>
<span id="cb247-2"><a href="machine-learning-aprendizaje-supervisado.html#cb247-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-3"><a href="machine-learning-aprendizaje-supervisado.html#cb247-3" aria-hidden="true" tabindex="-1"></a>UseCores <span class="ot">&lt;-</span> <span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb247-4"><a href="machine-learning-aprendizaje-supervisado.html#cb247-4" aria-hidden="true" tabindex="-1"></a>cluster <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(UseCores)</span>
<span id="cb247-5"><a href="machine-learning-aprendizaje-supervisado.html#cb247-5" aria-hidden="true" tabindex="-1"></a><span class="fu">registerDoParallel</span>(cluster)</span>
<span id="cb247-6"><a href="machine-learning-aprendizaje-supervisado.html#cb247-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-7"><a href="machine-learning-aprendizaje-supervisado.html#cb247-7" aria-hidden="true" tabindex="-1"></a>casas_folds <span class="ot">&lt;-</span> <span class="fu">vfold_cv</span>(ames_train)</span>
<span id="cb247-8"><a href="machine-learning-aprendizaje-supervisado.html#cb247-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-9"><a href="machine-learning-aprendizaje-supervisado.html#cb247-9" aria-hidden="true" tabindex="-1"></a>knnt1 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb247-10"><a href="machine-learning-aprendizaje-supervisado.html#cb247-10" aria-hidden="true" tabindex="-1"></a>knn_tune_result <span class="ot">&lt;-</span> <span class="fu">tune_grid</span>(</span>
<span id="cb247-11"><a href="machine-learning-aprendizaje-supervisado.html#cb247-11" aria-hidden="true" tabindex="-1"></a>  knn_workflow,</span>
<span id="cb247-12"><a href="machine-learning-aprendizaje-supervisado.html#cb247-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">resamples =</span> casas_folds,</span>
<span id="cb247-13"><a href="machine-learning-aprendizaje-supervisado.html#cb247-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">grid =</span> knn_grid,</span>
<span id="cb247-14"><a href="machine-learning-aprendizaje-supervisado.html#cb247-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">metrics =</span> <span class="fu">metric_set</span>(rmse, mae, mape),</span>
<span id="cb247-15"><a href="machine-learning-aprendizaje-supervisado.html#cb247-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> ctrl_grid</span>
<span id="cb247-16"><a href="machine-learning-aprendizaje-supervisado.html#cb247-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb247-17"><a href="machine-learning-aprendizaje-supervisado.html#cb247-17" aria-hidden="true" tabindex="-1"></a>knnt2 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>(); knnt2 <span class="sc">-</span> knnt1</span>
<span id="cb247-18"><a href="machine-learning-aprendizaje-supervisado.html#cb247-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-19"><a href="machine-learning-aprendizaje-supervisado.html#cb247-19" aria-hidden="true" tabindex="-1"></a><span class="fu">stopCluster</span>(cluster)</span>
<span id="cb247-20"><a href="machine-learning-aprendizaje-supervisado.html#cb247-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-21"><a href="machine-learning-aprendizaje-supervisado.html#cb247-21" aria-hidden="true" tabindex="-1"></a>knn_tune_result <span class="sc">%&gt;%</span> <span class="fu">saveRDS</span>(<span class="st">&quot;models/ml/knn_model_reg.rds&quot;</span>)</span></code></pre></div>
<p>Podemos obtener las métricas de cada <em>fold</em> con el siguiente código:</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="machine-learning-aprendizaje-supervisado.html#cb248-1" aria-hidden="true" tabindex="-1"></a>knn_tune_result <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;models/ml/knn_model_reg.rds&quot;</span>)</span>
<span id="cb248-2"><a href="machine-learning-aprendizaje-supervisado.html#cb248-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb248-3"><a href="machine-learning-aprendizaje-supervisado.html#cb248-3" aria-hidden="true" tabindex="-1"></a>knn_tune_result <span class="sc">%&gt;%</span> <span class="fu">unnest</span>(.metrics)</span></code></pre></div>
<pre><code>## # A tibble: 3,660 × 10
##    splits  id         K weight_func .metric .estimator .estimate .config  .notes
##    &lt;list&gt;  &lt;chr&gt;  &lt;int&gt; &lt;chr&gt;       &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;    &lt;list&gt;
##  1 &lt;split… Fold01    11 gaussian    rmse    standard       0.247 Preproc… &lt;tibb…
##  2 &lt;split… Fold01    13 gaussian    rmse    standard       0.249 Preproc… &lt;tibb…
##  3 &lt;split… Fold01    15 gaussian    rmse    standard       0.248 Preproc… &lt;tibb…
##  4 &lt;split… Fold01    20 gaussian    rmse    standard       0.249 Preproc… &lt;tibb…
##  5 &lt;split… Fold01    21 gaussian    rmse    standard       0.249 Preproc… &lt;tibb…
##  6 &lt;split… Fold01    23 gaussian    rmse    standard       0.250 Preproc… &lt;tibb…
##  7 &lt;split… Fold01    25 gaussian    rmse    standard       0.251 Preproc… &lt;tibb…
##  8 &lt;split… Fold01    26 gaussian    rmse    standard       0.251 Preproc… &lt;tibb…
##  9 &lt;split… Fold01    28 gaussian    rmse    standard       0.250 Preproc… &lt;tibb…
## 10 &lt;split… Fold01    30 gaussian    rmse    standard       0.252 Preproc… &lt;tibb…
## # … with 3,650 more rows, and 1 more variable: .predictions &lt;list&gt;</code></pre>
<p>En la siguiente gráfica observamos el error cuadrático medio de las distintas métricas con distintos números de vecinos.</p>
<p>En los argumentos de la funcion, se puede seleccionar el kernel, esto es las opciones posibles para ponderar el promedio respecto a la distancia seleccinada. “Rectangular” (que es knn estándar no ponderado), “triangular,” “cos,” “inv,” “gaussiano,” “rango” y “óptimo.”</p>
<p>Para conocer más a cerca de las distintas métricas de distancia pueden consultar:
<a href="https://towardsdatascience.com/9-distance-measures-in-data-science-918109d069fa">Measures</a> y <a href="https://rdrr.io/cran/kknn/man/kknn.html">KNN function</a></p>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="machine-learning-aprendizaje-supervisado.html#cb250-1" aria-hidden="true" tabindex="-1"></a>knn_tune_result <span class="sc">%&gt;%</span> </span>
<span id="cb250-2"><a href="machine-learning-aprendizaje-supervisado.html#cb250-2" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(<span class="at">metric =</span> <span class="st">&quot;rmse&quot;</span>)</span></code></pre></div>
<p><img src="Introducci%C3%B3n-a-Ciencia-de-Datos-y-Machine-Learning_files/figure-html/unnamed-chunk-253-1.png" width="672" /></p>
<p>En la siguiente gráfica observamos el error absoluto promedio de las distintas métricas con distintos números de vecinos.</p>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="machine-learning-aprendizaje-supervisado.html#cb251-1" aria-hidden="true" tabindex="-1"></a>knn_tune_result <span class="sc">%&gt;%</span> </span>
<span id="cb251-2"><a href="machine-learning-aprendizaje-supervisado.html#cb251-2" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(<span class="at">metric =</span> <span class="st">&quot;mae&quot;</span>)</span></code></pre></div>
<p><img src="Introducci%C3%B3n-a-Ciencia-de-Datos-y-Machine-Learning_files/figure-html/unnamed-chunk-254-1.png" width="672" /></p>
<p>Con el siguiente código obtenemos los mejores 10 modelos respecto al <em>rmse</em>.</p>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="machine-learning-aprendizaje-supervisado.html#cb252-1" aria-hidden="true" tabindex="-1"></a><span class="fu">show_best</span>(knn_tune_result, <span class="at">n =</span> <span class="dv">10</span>, <span class="at">metric =</span> <span class="st">&quot;rmse&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 10 × 8
##        K weight_func .metric .estimator  mean     n std_err .config             
##    &lt;int&gt; &lt;chr&gt;       &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;               
##  1    22 triangular  rmse    standard   0.203    10 0.00887 Preprocessor1_Model…
##  2    12 triangular  rmse    standard   0.203    10 0.00891 Preprocessor1_Model…
##  3    11 triangular  rmse    standard   0.203    10 0.00884 Preprocessor1_Model…
##  4    27 triangular  rmse    standard   0.203    10 0.00887 Preprocessor1_Model…
##  5    28 triangular  rmse    standard   0.204    10 0.00891 Preprocessor1_Model…
##  6    30 triangular  rmse    standard   0.204    10 0.00889 Preprocessor1_Model…
##  7    13 gaussian    rmse    standard   0.204    10 0.00873 Preprocessor1_Model…
##  8    33 triangular  rmse    standard   0.204    10 0.00891 Preprocessor1_Model…
##  9    15 gaussian    rmse    standard   0.205    10 0.00868 Preprocessor1_Model…
## 10    11 gaussian    rmse    standard   0.205    10 0.00855 Preprocessor1_Model…</code></pre>
<p>Ahora obtendremos el modelo que mejor desempeño tiene tomando en cuenta el <em>rmse</em> y haremos las predicciones del conjunto de prueba con este modelo.</p>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="machine-learning-aprendizaje-supervisado.html#cb254-1" aria-hidden="true" tabindex="-1"></a>best_knn_model_reg <span class="ot">&lt;-</span> <span class="fu">select_best</span>(knn_tune_result, <span class="at">metric =</span> <span class="st">&quot;rmse&quot;</span>)</span>
<span id="cb254-2"><a href="machine-learning-aprendizaje-supervisado.html#cb254-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-3"><a href="machine-learning-aprendizaje-supervisado.html#cb254-3" aria-hidden="true" tabindex="-1"></a>final_knn_model_reg <span class="ot">&lt;-</span> knn_workflow <span class="sc">%&gt;%</span> </span>
<span id="cb254-4"><a href="machine-learning-aprendizaje-supervisado.html#cb254-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">finalize_workflow</span>(best_knn_model_reg) <span class="sc">%&gt;%</span> </span>
<span id="cb254-5"><a href="machine-learning-aprendizaje-supervisado.html#cb254-5" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">fit</span>(<span class="at">data =</span> ames_train)</span>
<span id="cb254-6"><a href="machine-learning-aprendizaje-supervisado.html#cb254-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-7"><a href="machine-learning-aprendizaje-supervisado.html#cb254-7" aria-hidden="true" tabindex="-1"></a>results_reg <span class="ot">&lt;-</span> <span class="fu">predict</span>(final_knn_model_reg, ames_test) <span class="sc">%&gt;%</span> </span>
<span id="cb254-8"><a href="machine-learning-aprendizaje-supervisado.html#cb254-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(<span class="at">truth =</span> ames_test<span class="sc">$</span>Log_SalePrice)</span></code></pre></div>
<div id="métricas-de-desempeño-4" class="section level5" number="6.7.2.1.1">
<h5><span class="header-section-number">6.7.2.1.1</span> Métricas de desempeño</h5>
<p>Ahora para calcular las métricas de desempeño usaremos la paqueteria <em>MLmetrics</em></p>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="machine-learning-aprendizaje-supervisado.html#cb255-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MLmetrics)</span></code></pre></div>
<p><strong>MAE</strong></p>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="machine-learning-aprendizaje-supervisado.html#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(results_reg,MLmetrics<span class="sc">::</span><span class="fu">MAE</span>(.pred, truth))</span></code></pre></div>
<pre><code>## [1] 0.1410695</code></pre>
<p><strong>MAPE</strong></p>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="machine-learning-aprendizaje-supervisado.html#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(results_reg,MLmetrics<span class="sc">::</span><span class="fu">MAPE</span>(.pred, truth))</span></code></pre></div>
<pre><code>## [1] 0.01175324</code></pre>
<p><strong>RMSE</strong></p>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="machine-learning-aprendizaje-supervisado.html#cb260-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(results_reg,MLmetrics<span class="sc">::</span><span class="fu">RMSE</span>(.pred, truth))</span></code></pre></div>
<pre><code>## [1] 0.197986</code></pre>
<p><strong><span class="math inline">\(R^2\)</span></strong></p>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="machine-learning-aprendizaje-supervisado.html#cb262-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(results_reg,MLmetrics<span class="sc">::</span><span class="fu">R2_Score</span>(.pred, truth))</span></code></pre></div>
<pre><code>## [1] 0.7648524</code></pre>
<p><strong>RMSLE</strong></p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="machine-learning-aprendizaje-supervisado.html#cb264-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(results_reg,MLmetrics<span class="sc">::</span><span class="fu">RMSLE</span>(.pred, truth))</span></code></pre></div>
<pre><code>## [1] 0.01528504</code></pre>
</div>
</div>
<div id="clasificación-1" class="section level4" number="6.7.2.2">
<h4><span class="header-section-number">6.7.2.2</span> Clasificación:</h4>
<p>Repetiremos el proceso para el problema de clasificación.</p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="machine-learning-aprendizaje-supervisado.html#cb266-1" aria-hidden="true" tabindex="-1"></a>knn_model <span class="ot">&lt;-</span> <span class="fu">nearest_neighbor</span>(</span>
<span id="cb266-2"><a href="machine-learning-aprendizaje-supervisado.html#cb266-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">mode =</span> <span class="st">&quot;classification&quot;</span>,</span>
<span id="cb266-3"><a href="machine-learning-aprendizaje-supervisado.html#cb266-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">neighbors =</span> <span class="fu">tune</span>(<span class="st">&quot;K&quot;</span>),</span>
<span id="cb266-4"><a href="machine-learning-aprendizaje-supervisado.html#cb266-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">weight_func =</span> <span class="fu">tune</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb266-5"><a href="machine-learning-aprendizaje-supervisado.html#cb266-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">&quot;kknn&quot;</span>)</span>
<span id="cb266-6"><a href="machine-learning-aprendizaje-supervisado.html#cb266-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-7"><a href="machine-learning-aprendizaje-supervisado.html#cb266-7" aria-hidden="true" tabindex="-1"></a>knn_workflow <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb266-8"><a href="machine-learning-aprendizaje-supervisado.html#cb266-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(telco_rec) <span class="sc">%&gt;%</span> </span>
<span id="cb266-9"><a href="machine-learning-aprendizaje-supervisado.html#cb266-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(knn_model)</span>
<span id="cb266-10"><a href="machine-learning-aprendizaje-supervisado.html#cb266-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-11"><a href="machine-learning-aprendizaje-supervisado.html#cb266-11" aria-hidden="true" tabindex="-1"></a>knn_parameters_set <span class="ot">&lt;-</span> <span class="fu">parameters</span>(knn_workflow) <span class="sc">%&gt;%</span> </span>
<span id="cb266-12"><a href="machine-learning-aprendizaje-supervisado.html#cb266-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">update</span>(<span class="at">K =</span> dials<span class="sc">::</span><span class="fu">neighbors</span>(<span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">80</span>)),</span>
<span id="cb266-13"><a href="machine-learning-aprendizaje-supervisado.html#cb266-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">weight_func =</span> <span class="fu">weight_func</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;rectangular&quot;</span>, <span class="st">&quot;inv&quot;</span>, <span class="st">&quot;gaussian&quot;</span>, <span class="st">&quot;cos&quot;</span>)))</span>
<span id="cb266-14"><a href="machine-learning-aprendizaje-supervisado.html#cb266-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-15"><a href="machine-learning-aprendizaje-supervisado.html#cb266-15" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb266-16"><a href="machine-learning-aprendizaje-supervisado.html#cb266-16" aria-hidden="true" tabindex="-1"></a>knn_grid <span class="ot">&lt;-</span> knn_parameters_set <span class="sc">%&gt;%</span> </span>
<span id="cb266-17"><a href="machine-learning-aprendizaje-supervisado.html#cb266-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">grid_max_entropy</span>(<span class="at">size =</span> <span class="dv">150</span>)</span>
<span id="cb266-18"><a href="machine-learning-aprendizaje-supervisado.html#cb266-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-19"><a href="machine-learning-aprendizaje-supervisado.html#cb266-19" aria-hidden="true" tabindex="-1"></a>ctrl_grid <span class="ot">&lt;-</span> <span class="fu">control_grid</span>(<span class="at">save_pred =</span> T, <span class="at">verbose =</span> T)</span></code></pre></div>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="machine-learning-aprendizaje-supervisado.html#cb267-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(doParallel)</span>
<span id="cb267-2"><a href="machine-learning-aprendizaje-supervisado.html#cb267-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-3"><a href="machine-learning-aprendizaje-supervisado.html#cb267-3" aria-hidden="true" tabindex="-1"></a>UseCores <span class="ot">&lt;-</span> <span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb267-4"><a href="machine-learning-aprendizaje-supervisado.html#cb267-4" aria-hidden="true" tabindex="-1"></a>cluster <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(UseCores)</span>
<span id="cb267-5"><a href="machine-learning-aprendizaje-supervisado.html#cb267-5" aria-hidden="true" tabindex="-1"></a><span class="fu">registerDoParallel</span>(cluster)</span>
<span id="cb267-6"><a href="machine-learning-aprendizaje-supervisado.html#cb267-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-7"><a href="machine-learning-aprendizaje-supervisado.html#cb267-7" aria-hidden="true" tabindex="-1"></a>telco_folds <span class="ot">&lt;-</span> <span class="fu">vfold_cv</span>(telco_train)</span>
<span id="cb267-8"><a href="machine-learning-aprendizaje-supervisado.html#cb267-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-9"><a href="machine-learning-aprendizaje-supervisado.html#cb267-9" aria-hidden="true" tabindex="-1"></a>knnt1 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb267-10"><a href="machine-learning-aprendizaje-supervisado.html#cb267-10" aria-hidden="true" tabindex="-1"></a>knn_tune_result <span class="ot">&lt;-</span> <span class="fu">tune_grid</span>(</span>
<span id="cb267-11"><a href="machine-learning-aprendizaje-supervisado.html#cb267-11" aria-hidden="true" tabindex="-1"></a>  knn_workflow,</span>
<span id="cb267-12"><a href="machine-learning-aprendizaje-supervisado.html#cb267-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">resamples =</span> telco_folds,</span>
<span id="cb267-13"><a href="machine-learning-aprendizaje-supervisado.html#cb267-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">grid =</span> knn_grid,</span>
<span id="cb267-14"><a href="machine-learning-aprendizaje-supervisado.html#cb267-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">metrics =</span> <span class="fu">metric_set</span>(roc_auc, pr_auc, sens),</span>
<span id="cb267-15"><a href="machine-learning-aprendizaje-supervisado.html#cb267-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> ctrl_grid</span>
<span id="cb267-16"><a href="machine-learning-aprendizaje-supervisado.html#cb267-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb267-17"><a href="machine-learning-aprendizaje-supervisado.html#cb267-17" aria-hidden="true" tabindex="-1"></a>knnt2 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>(); knnt2 <span class="sc">-</span> knnt1</span>
<span id="cb267-18"><a href="machine-learning-aprendizaje-supervisado.html#cb267-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-19"><a href="machine-learning-aprendizaje-supervisado.html#cb267-19" aria-hidden="true" tabindex="-1"></a><span class="fu">stopCluster</span>(cluster)</span>
<span id="cb267-20"><a href="machine-learning-aprendizaje-supervisado.html#cb267-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-21"><a href="machine-learning-aprendizaje-supervisado.html#cb267-21" aria-hidden="true" tabindex="-1"></a>knn_tune_result <span class="sc">%&gt;%</span> <span class="fu">saveRDS</span>(<span class="st">&quot;models/ml/knn_model_cla.rds&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="machine-learning-aprendizaje-supervisado.html#cb268-1" aria-hidden="true" tabindex="-1"></a>knn_tune_result <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;models/ml/knn_model_cla.rds&quot;</span>)</span>
<span id="cb268-2"><a href="machine-learning-aprendizaje-supervisado.html#cb268-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb268-3"><a href="machine-learning-aprendizaje-supervisado.html#cb268-3" aria-hidden="true" tabindex="-1"></a>knn_tune_result <span class="sc">%&gt;%</span> <span class="fu">unnest</span>(.metrics)</span></code></pre></div>
<pre><code>## # A tibble: 3,660 × 10
##    splits  id         K weight_func .metric .estimator .estimate .config  .notes
##    &lt;list&gt;  &lt;chr&gt;  &lt;int&gt; &lt;chr&gt;       &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;    &lt;list&gt;
##  1 &lt;split… Fold01    11 cos         sens    binary         0.899 Preproc… &lt;tibb…
##  2 &lt;split… Fold01    12 cos         sens    binary         0.899 Preproc… &lt;tibb…
##  3 &lt;split… Fold01    22 cos         sens    binary         0.904 Preproc… &lt;tibb…
##  4 &lt;split… Fold01    27 cos         sens    binary         0.910 Preproc… &lt;tibb…
##  5 &lt;split… Fold01    28 cos         sens    binary         0.910 Preproc… &lt;tibb…
##  6 &lt;split… Fold01    30 cos         sens    binary         0.910 Preproc… &lt;tibb…
##  7 &lt;split… Fold01    33 cos         sens    binary         0.915 Preproc… &lt;tibb…
##  8 &lt;split… Fold01    35 cos         sens    binary         0.918 Preproc… &lt;tibb…
##  9 &lt;split… Fold01    37 cos         sens    binary         0.918 Preproc… &lt;tibb…
## 10 &lt;split… Fold01    39 cos         sens    binary         0.918 Preproc… &lt;tibb…
## # … with 3,650 more rows, and 1 more variable: .predictions &lt;list&gt;</code></pre>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="machine-learning-aprendizaje-supervisado.html#cb270-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(knn_tune_result, <span class="at">metric =</span> <span class="st">&quot;pr_auc&quot;</span>)</span></code></pre></div>
<p><img src="Introducci%C3%B3n-a-Ciencia-de-Datos-y-Machine-Learning_files/figure-html/unnamed-chunk-266-1.png" width="672" /></p>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="machine-learning-aprendizaje-supervisado.html#cb271-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(knn_tune_result, <span class="at">metric =</span> <span class="st">&quot;roc_auc&quot;</span>)</span></code></pre></div>
<p><img src="Introducci%C3%B3n-a-Ciencia-de-Datos-y-Machine-Learning_files/figure-html/unnamed-chunk-267-1.png" width="672" /></p>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="machine-learning-aprendizaje-supervisado.html#cb272-1" aria-hidden="true" tabindex="-1"></a><span class="fu">show_best</span>(knn_tune_result, <span class="at">n =</span> <span class="dv">10</span>, <span class="at">metric =</span> <span class="st">&quot;pr_auc&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 10 × 8
##        K weight_func .metric .estimator  mean     n std_err .config             
##    &lt;int&gt; &lt;chr&gt;       &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;               
##  1    79 gaussian    pr_auc  binary     0.925    10 0.00268 Preprocessor1_Model…
##  2    78 gaussian    pr_auc  binary     0.925    10 0.00270 Preprocessor1_Model…
##  3    71 gaussian    pr_auc  binary     0.924    10 0.00276 Preprocessor1_Model…
##  4    74 gaussian    pr_auc  binary     0.924    10 0.00275 Preprocessor1_Model…
##  5    79 cos         pr_auc  binary     0.924    10 0.00272 Preprocessor1_Model…
##  6    77 cos         pr_auc  binary     0.924    10 0.00274 Preprocessor1_Model…
##  7    73 gaussian    pr_auc  binary     0.924    10 0.00276 Preprocessor1_Model…
##  8    67 gaussian    pr_auc  binary     0.924    10 0.00280 Preprocessor1_Model…
##  9    66 gaussian    pr_auc  binary     0.924    10 0.00281 Preprocessor1_Model…
## 10    68 cos         pr_auc  binary     0.924    10 0.00278 Preprocessor1_Model…</code></pre>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="machine-learning-aprendizaje-supervisado.html#cb274-1" aria-hidden="true" tabindex="-1"></a>best_knn_model_cla <span class="ot">&lt;-</span> <span class="fu">select_best</span>(knn_tune_result, <span class="at">metric =</span> <span class="st">&quot;pr_auc&quot;</span>)</span>
<span id="cb274-2"><a href="machine-learning-aprendizaje-supervisado.html#cb274-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb274-3"><a href="machine-learning-aprendizaje-supervisado.html#cb274-3" aria-hidden="true" tabindex="-1"></a>final_knn_model_cla <span class="ot">&lt;-</span> knn_workflow <span class="sc">%&gt;%</span> </span>
<span id="cb274-4"><a href="machine-learning-aprendizaje-supervisado.html#cb274-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">finalize_workflow</span>(best_knn_model_cla) <span class="sc">%&gt;%</span> </span>
<span id="cb274-5"><a href="machine-learning-aprendizaje-supervisado.html#cb274-5" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">fit</span>(<span class="at">data =</span> telco_train)</span></code></pre></div>
<pre><code>## Warning: There are new levels in a factor: NA</code></pre>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="machine-learning-aprendizaje-supervisado.html#cb276-1" aria-hidden="true" tabindex="-1"></a>results_cla <span class="ot">&lt;-</span> <span class="fu">predict</span>(final_knn_model_cla, telco_test, <span class="at">type =</span> <span class="st">&#39;prob&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb276-2"><a href="machine-learning-aprendizaje-supervisado.html#cb276-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(<span class="at">truth =</span>telco_test<span class="sc">$</span>Churn) <span class="sc">%&gt;%</span> </span>
<span id="cb276-3"><a href="machine-learning-aprendizaje-supervisado.html#cb276-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">truth =</span> <span class="fu">factor</span>(truth, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&#39;No&#39;</span>, <span class="st">&#39;Yes&#39;</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;No&#39;</span>, <span class="st">&#39;Yes&#39;</span>)))</span></code></pre></div>
<pre><code>## Warning: There are new levels in a factor: NA</code></pre>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="machine-learning-aprendizaje-supervisado.html#cb278-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(results_cla, <span class="dv">10</span>)</span></code></pre></div>
<pre><code>## # A tibble: 10 × 3
##    .pred_No .pred_Yes truth
##       &lt;dbl&gt;     &lt;dbl&gt; &lt;fct&gt;
##  1    0.887    0.113  No   
##  2    0.290    0.710  Yes  
##  3    0.704    0.296  No   
##  4    0.931    0.0688 No   
##  5    0.857    0.143  No   
##  6    0.548    0.452  No   
##  7    0.945    0.0546 No   
##  8    0.846    0.154  No   
##  9    0.660    0.340  Yes  
## 10    0.982    0.0182 No</code></pre>
<p>::::::::::::::</p>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="machine-learning-aprendizaje-supervisado.html#cb280-1" aria-hidden="true" tabindex="-1"></a>pr_curve_data <span class="ot">&lt;-</span> <span class="fu">pr_curve</span>(</span>
<span id="cb280-2"><a href="machine-learning-aprendizaje-supervisado.html#cb280-2" aria-hidden="true" tabindex="-1"></a>  results_cla, </span>
<span id="cb280-3"><a href="machine-learning-aprendizaje-supervisado.html#cb280-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">truth =</span> truth, </span>
<span id="cb280-4"><a href="machine-learning-aprendizaje-supervisado.html#cb280-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">estimate =</span> .pred_Yes, </span>
<span id="cb280-5"><a href="machine-learning-aprendizaje-supervisado.html#cb280-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">event_level =</span> <span class="st">&#39;second&#39;</span></span>
<span id="cb280-6"><a href="machine-learning-aprendizaje-supervisado.html#cb280-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb280-7"><a href="machine-learning-aprendizaje-supervisado.html#cb280-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb280-8"><a href="machine-learning-aprendizaje-supervisado.html#cb280-8" aria-hidden="true" tabindex="-1"></a>roc_curve_data <span class="ot">&lt;-</span> <span class="fu">roc_curve</span>(</span>
<span id="cb280-9"><a href="machine-learning-aprendizaje-supervisado.html#cb280-9" aria-hidden="true" tabindex="-1"></a>  results_cla, </span>
<span id="cb280-10"><a href="machine-learning-aprendizaje-supervisado.html#cb280-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">truth =</span> truth, </span>
<span id="cb280-11"><a href="machine-learning-aprendizaje-supervisado.html#cb280-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">estimate =</span> .pred_Yes, </span>
<span id="cb280-12"><a href="machine-learning-aprendizaje-supervisado.html#cb280-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">event_level =</span> <span class="st">&#39;second&#39;</span></span>
<span id="cb280-13"><a href="machine-learning-aprendizaje-supervisado.html#cb280-13" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="machine-learning-aprendizaje-supervisado.html#cb281-1" aria-hidden="true" tabindex="-1"></a>pr_curve_plot <span class="ot">&lt;-</span> pr_curve_data <span class="sc">%&gt;%</span> </span>
<span id="cb281-2"><a href="machine-learning-aprendizaje-supervisado.html#cb281-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> recall, <span class="at">y =</span> precision)) <span class="sc">+</span></span>
<span id="cb281-3"><a href="machine-learning-aprendizaje-supervisado.html#cb281-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">&#39;lightblue&#39;</span>) <span class="sc">+</span></span>
<span id="cb281-4"><a href="machine-learning-aprendizaje-supervisado.html#cb281-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>() <span class="sc">+</span></span>
<span id="cb281-5"><a href="machine-learning-aprendizaje-supervisado.html#cb281-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Precision vs Recall&quot;</span>)<span class="sc">+</span></span>
<span id="cb281-6"><a href="machine-learning-aprendizaje-supervisado.html#cb281-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb281-7"><a href="machine-learning-aprendizaje-supervisado.html#cb281-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb281-8"><a href="machine-learning-aprendizaje-supervisado.html#cb281-8" aria-hidden="true" tabindex="-1"></a>pr_curve_plot</span></code></pre></div>
<p><img src="Introducci%C3%B3n-a-Ciencia-de-Datos-y-Machine-Learning_files/figure-html/unnamed-chunk-271-1.png" width="672" /></p>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="machine-learning-aprendizaje-supervisado.html#cb282-1" aria-hidden="true" tabindex="-1"></a>roc_curve_plot <span class="ot">&lt;-</span> roc_curve_data <span class="sc">%&gt;%</span> </span>
<span id="cb282-2"><a href="machine-learning-aprendizaje-supervisado.html#cb282-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">1</span> <span class="sc">-</span> specificity, <span class="at">y =</span> sensitivity)) <span class="sc">+</span></span>
<span id="cb282-3"><a href="machine-learning-aprendizaje-supervisado.html#cb282-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">&#39;lightblue&#39;</span>) <span class="sc">+</span></span>
<span id="cb282-4"><a href="machine-learning-aprendizaje-supervisado.html#cb282-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>() <span class="sc">+</span></span>
<span id="cb282-5"><a href="machine-learning-aprendizaje-supervisado.html#cb282-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>() <span class="sc">+</span></span>
<span id="cb282-6"><a href="machine-learning-aprendizaje-supervisado.html#cb282-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;ROC Curve&quot;</span>)<span class="sc">+</span></span>
<span id="cb282-7"><a href="machine-learning-aprendizaje-supervisado.html#cb282-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb282-8"><a href="machine-learning-aprendizaje-supervisado.html#cb282-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb282-9"><a href="machine-learning-aprendizaje-supervisado.html#cb282-9" aria-hidden="true" tabindex="-1"></a>roc_curve_plot</span></code></pre></div>
<p><img src="Introducci%C3%B3n-a-Ciencia-de-Datos-y-Machine-Learning_files/figure-html/unnamed-chunk-271-2.png" width="672" /></p>
</div>
</div>
</div>
<div id="árboles-de-decisión-decision-trees" class="section level2" number="6.8">
<h2><span class="header-section-number">6.8</span> Árboles de decisión (Decision trees)</h2>
<p><img src="img/ml/3-11-0-arboles.png" width="500pt" height="300pt" style="display: block; margin: auto;" /></p>
<p>Un árbol de decisiones es un algoritmo del aprendizaje supervisado que se puede utilizar tanto para problemas de <strong>clasificación</strong> como de <strong>regresión</strong>. Es un clasificador estructurado en árbol, donde los nodos internos representan las características de un conjunto de datos, las ramas representan las reglas de decisión y cada nodo hoja representa el resultado. La idea básica de los árboles es buscar puntos de cortes en las variables de entrada para hacer predicciones, ir dividiendo la muestra, y encontrar cortes sucesivos para refinar las predicciones.</p>
<p>En un árbol de decisión, hay dos tipos nodos, el nodo de decisión o nodos internos (Decision Node) y el nodo hoja o nodo terminal (Leaf node). Los nodos de decisión se utilizan para tomar cualquier decisión y tienen múltiples ramas, mientras que los nodos hoja son el resultado de esas decisiones y no contienen más ramas.</p>
<p><img src="img/ml/3-11-1-arboles.png" width="500pt" height="300pt" style="display: block; margin: auto;" />
- Clasificación:</p>
<p><img src="img/ml/3-11-1-ejemplocla.jpeg" width="500pt" height="300pt" style="display: block; margin: auto;" /></p>
<ul>
<li>Regresión:</li>
</ul>
<p><img src="img/ml/3-11-1-ejemploreg.png" width="500pt" height="300pt" style="display: block; margin: auto;" /></p>
<div id="ajuste-del-modelo-2" class="section level3" number="6.8.1">
<h3><span class="header-section-number">6.8.1</span> Ajuste del modelo</h3>
<p>En un árbol de decisión, para predecir la clase del conjunto de datos, el algoritmo comienza desde el nodo raíz del árbol. Este algoritmo compara los valores de la variable raíz con la variable de registro y, según la comparación, sigue una rama y salta al siguiente nodo.</p>
<p>Para el siguiente nodo, el algoritmo vuelve a comparar el valor de la siguiente variable con los otros subnodos y avanza. Continúa el proceso hasta que se llega a un nodo hoja. El proceso completo se puede comprender mejor con los siguientes pasos:</p>
<ol style="list-style-type: decimal">
<li><p>Comenzamos el árbol con el nodo raíz, llamémoslo S, que contiene el conjunto de entrenamiento completo.</p></li>
<li><p>Encuentre la mejor variable en el conjunto de datos usando <em>Attribute Selective Measure</em> (ASM).</p></li>
<li><p>Divida la S en subconjuntos que contengan valores posibles para la mejor variable.</p></li>
<li><p>Genere el nodo del árbol de decisión, que contiene la mejor variable.</p></li>
<li><p>Cree de forma recursiva nuevos árboles de decisión utilizando los subconjuntos del conjunto de datos creado en el paso 3. Continúe este proceso hasta que se alcance una etapa en la que no pueda particionar más los nodos y este nodo final sera un nodo hoja.</p></li>
<li><p>Para clasificación nos quedaremos la moda de la variable respuesta del nodo hoja y para regresión usaremos la media de la variable respuesta.</p></li>
</ol>
<div id="qué-es-attribute-selective-measure-asm" class="section level4" number="6.8.1.1">
<h4><span class="header-section-number">6.8.1.1</span> ¿Qué es <em>Attribute Selective Measure</em> (ASM)?</h4>
<p>Al implementar un árbol de decisión, surge el problema principal de cómo seleccionar la mejor variable para el nodo raíz y para los subnodos. Para resolver este problemas existe una técnica que se llama medida de selección de atributos o <em>ASM</em>. Mediante esta medición, podemos seleccionar fácilmente la mejor variable para los nodos del árbol. Hay dos técnicas populares para <em>ASM</em>, que son:</p>
<ul>
<li>Índice de Gini</li>
</ul>
<p>La medida del grado de probabilidad de que una variable en particular se clasifique incorrectamente cuando se elige al azar se llama índice de Gini o impureza de Gini. Los datos se distribuyen por igual según el índice de Gini.</p>
<p><span class="math display">\[Gini = 1 -\sum_{i=1}^{n}(p_i)²\]</span></p>
<p>Con <span class="math inline">\(p_i\)</span> como la probabilidad de que un objeto se clasifique en una clase particular.</p>
<p>Cuando se utiliza el índice de Gini como criterio seleccionar la variable para el nodo raíz, seleccionaremos la variable con el índice de Gini menor.</p>
<ul>
<li>Ganancia de información</li>
</ul>
<p>La entropía es el concepto principal de este algoritmo, que ayuda a determinar una variable o atributo que brinda la máxima información sobre una clase. Al usar este método, podemos reducir el nivel de entropía desde el nodo raíz hasta el nodo hoja. En otras palabaras calcula cuánta información nos proporciona una variable sobre una clase.</p>
<p>La entropia la calculamos con la siguiente ecuación:</p>
<p><span class="math display">\[E(S) = \sum_{i=1}^{n}-p_i log_2(p_i)\]</span></p>
<p>Ahora la ganancia de información se calcula:</p>
<p><span class="math display">\[IG(S,a) = E(S)-E(S|a)\]</span></p>
<p>Donde <span class="math inline">\(IG(S,a)\)</span> es la información para el conjunto de datos <span class="math inline">\(S\)</span> para la variable <span class="math inline">\(a\)</span>, <span class="math inline">\(E(S)\)</span> es la entropía del conjunto de datos antes de cualquier cambioy <span class="math inline">\(H (S | a)\)</span> es la entropía condicional para el conjunto de datos dada la variable <span class="math inline">\(a\)</span>.</p>
<p>Un árbol de decisión intenta maximizar el valor de la ganancia de información, y un nodo/variable que tiene la mayor ganancia de información se divide primero.</p>
</div>
<div id="cuándo-dejar-de-dividir-un-nodo" class="section level4" number="6.8.1.2">
<h4><span class="header-section-number">6.8.1.2</span> ¿Cuándo dejar de dividir un nodo?</h4>
<p>Podríamos preguntarnos cuándo dejar de crecer un árbol. Pueden existir problemas que tengan un gran conjunto de variables y esto da como resultado una gran cantidad de divisiones, lo que a su vez genera un árbol de decisión muy grande Estos árboles son complejos y pueden provocar un sobreajuste. Entonces, necesitamos saber cuándo parar, una forma de hacer esto es establecer un número mínimo de entradas de entrenamiento para dividir un nodo. Otra forma es establecer la profundidad máxima de su modelo. La profundidad máxima se refiere a la longitud del camino más largo desde el nodo raíz hasta un nodo hoja.</p>
</div>
<div id="cuándo-podar-un-árbol" class="section level4" number="6.8.1.3">
<h4><span class="header-section-number">6.8.1.3</span> ¿Cuándo podar un árbol?</h4>
<p>El rendimiento de un árbol se puede aumentar aún más mediante la poda del árbol. Esto se refiere a eliminar las ramas que hacen uso de variables de poca importancia. De esta manera, reducimos la complejidad del árbol y, por lo tanto, aumentamos su poder predictivo al reducir el sobreajuste.</p>
<p><img src="img/ml/3-11-3-podar.jpg" width="500pt" height="300pt" style="display: block; margin: auto;" /></p>
<p>La poda puede comenzar en la raíz o en las hojas. El método más simple de poda comienza en las hojas y elimina cada nodo con la clase más popular en esa hoja, este cambio se mantiene si no deteriora la precisión. Se pueden usar métodos de poda más sofisticados, como la poda de complejidad de costos, donde se usa un parámetro de aprendizaje (alfa) para observar si los nodos se pueden eliminar en función del tamaño del subárbol.</p>
</div>
</div>
<div id="implementación-en-r-3" class="section level3" number="6.8.2">
<h3><span class="header-section-number">6.8.2</span> Implementación en R</h3>
<p>Usaremos las recetas antes implementadas para ajustar tanto el modelo de regresión como el de clasificación. Exploraremos un conjunto de hiperparámetros para elegir el mejor modelo. En esta ocasión usamos la función <em>grid_regular()</em> donde con el parámetro <em>levels</em> le indicamos cuantos distintos números queremos para cada parámetro a ajustar.</p>
<div id="regresión-2" class="section level4" number="6.8.2.1">
<h4><span class="header-section-number">6.8.2.1</span> Regresión:</h4>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="machine-learning-aprendizaje-supervisado.html#cb283-1" aria-hidden="true" tabindex="-1"></a>tree_model <span class="ot">&lt;-</span> <span class="fu">decision_tree</span>(</span>
<span id="cb283-2"><a href="machine-learning-aprendizaje-supervisado.html#cb283-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">mode =</span> <span class="st">&quot;regression&quot;</span>,</span>
<span id="cb283-3"><a href="machine-learning-aprendizaje-supervisado.html#cb283-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">tree_depth =</span> <span class="fu">tune</span>(),</span>
<span id="cb283-4"><a href="machine-learning-aprendizaje-supervisado.html#cb283-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">cost_complexity =</span> <span class="fu">tune</span>(),</span>
<span id="cb283-5"><a href="machine-learning-aprendizaje-supervisado.html#cb283-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">min_n =</span> <span class="fu">tune</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb283-6"><a href="machine-learning-aprendizaje-supervisado.html#cb283-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">&quot;rpart&quot;</span>)</span>
<span id="cb283-7"><a href="machine-learning-aprendizaje-supervisado.html#cb283-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb283-8"><a href="machine-learning-aprendizaje-supervisado.html#cb283-8" aria-hidden="true" tabindex="-1"></a>tree_workflow <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb283-9"><a href="machine-learning-aprendizaje-supervisado.html#cb283-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(receta_casas) <span class="sc">%&gt;%</span> </span>
<span id="cb283-10"><a href="machine-learning-aprendizaje-supervisado.html#cb283-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(tree_model)</span>
<span id="cb283-11"><a href="machine-learning-aprendizaje-supervisado.html#cb283-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb283-12"><a href="machine-learning-aprendizaje-supervisado.html#cb283-12" aria-hidden="true" tabindex="-1"></a>tree_grid <span class="ot">&lt;-</span> <span class="fu">grid_regular</span>(<span class="fu">min_n</span>(),</span>
<span id="cb283-13"><a href="machine-learning-aprendizaje-supervisado.html#cb283-13" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">tree_depth</span>(),</span>
<span id="cb283-14"><a href="machine-learning-aprendizaje-supervisado.html#cb283-14" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">cost_complexity</span>(),</span>
<span id="cb283-15"><a href="machine-learning-aprendizaje-supervisado.html#cb283-15" aria-hidden="true" tabindex="-1"></a>                          <span class="at">levels =</span> <span class="dv">5</span>)</span>
<span id="cb283-16"><a href="machine-learning-aprendizaje-supervisado.html#cb283-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb283-17"><a href="machine-learning-aprendizaje-supervisado.html#cb283-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb283-18"><a href="machine-learning-aprendizaje-supervisado.html#cb283-18" aria-hidden="true" tabindex="-1"></a>ctrl_grid <span class="ot">&lt;-</span> <span class="fu">control_grid</span>(<span class="at">save_pred =</span> T, <span class="at">verbose =</span> T)</span></code></pre></div>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="machine-learning-aprendizaje-supervisado.html#cb284-1" aria-hidden="true" tabindex="-1"></a>UseCores <span class="ot">&lt;-</span> <span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb284-2"><a href="machine-learning-aprendizaje-supervisado.html#cb284-2" aria-hidden="true" tabindex="-1"></a>cluster <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(UseCores)</span>
<span id="cb284-3"><a href="machine-learning-aprendizaje-supervisado.html#cb284-3" aria-hidden="true" tabindex="-1"></a><span class="fu">registerDoParallel</span>(cluster)</span>
<span id="cb284-4"><a href="machine-learning-aprendizaje-supervisado.html#cb284-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-5"><a href="machine-learning-aprendizaje-supervisado.html#cb284-5" aria-hidden="true" tabindex="-1"></a>casas_folds <span class="ot">&lt;-</span> <span class="fu">vfold_cv</span>(ames_train)</span>
<span id="cb284-6"><a href="machine-learning-aprendizaje-supervisado.html#cb284-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-7"><a href="machine-learning-aprendizaje-supervisado.html#cb284-7" aria-hidden="true" tabindex="-1"></a>knnt1 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb284-8"><a href="machine-learning-aprendizaje-supervisado.html#cb284-8" aria-hidden="true" tabindex="-1"></a>tree_tune_result <span class="ot">&lt;-</span> <span class="fu">tune_grid</span>(</span>
<span id="cb284-9"><a href="machine-learning-aprendizaje-supervisado.html#cb284-9" aria-hidden="true" tabindex="-1"></a>  tree_workflow,</span>
<span id="cb284-10"><a href="machine-learning-aprendizaje-supervisado.html#cb284-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">resamples =</span> casas_folds,</span>
<span id="cb284-11"><a href="machine-learning-aprendizaje-supervisado.html#cb284-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">grid =</span> tree_grid,</span>
<span id="cb284-12"><a href="machine-learning-aprendizaje-supervisado.html#cb284-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">metrics =</span> <span class="fu">metric_set</span>(rmse, mae, mape),</span>
<span id="cb284-13"><a href="machine-learning-aprendizaje-supervisado.html#cb284-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> ctrl_grid</span>
<span id="cb284-14"><a href="machine-learning-aprendizaje-supervisado.html#cb284-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb284-15"><a href="machine-learning-aprendizaje-supervisado.html#cb284-15" aria-hidden="true" tabindex="-1"></a>knnt2 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>(); knnt2 <span class="sc">-</span> knnt1</span>
<span id="cb284-16"><a href="machine-learning-aprendizaje-supervisado.html#cb284-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-17"><a href="machine-learning-aprendizaje-supervisado.html#cb284-17" aria-hidden="true" tabindex="-1"></a><span class="fu">stopCluster</span>(cluster)</span>
<span id="cb284-18"><a href="machine-learning-aprendizaje-supervisado.html#cb284-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-19"><a href="machine-learning-aprendizaje-supervisado.html#cb284-19" aria-hidden="true" tabindex="-1"></a>tree_tune_result <span class="sc">%&gt;%</span> <span class="fu">saveRDS</span>(<span class="st">&quot;models/ml/tree_model_reg.rds&quot;</span>)</span></code></pre></div>
<p>Podemos obtener las métricas de cada <em>fold</em> con el siguiente código:</p>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb285-1"><a href="machine-learning-aprendizaje-supervisado.html#cb285-1" aria-hidden="true" tabindex="-1"></a>tree_tune_result <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;models/ml/tree_model_reg.rds&quot;</span>)</span>
<span id="cb285-2"><a href="machine-learning-aprendizaje-supervisado.html#cb285-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb285-3"><a href="machine-learning-aprendizaje-supervisado.html#cb285-3" aria-hidden="true" tabindex="-1"></a>tree_tune_result <span class="sc">%&gt;%</span> <span class="fu">unnest</span>(.metrics)</span></code></pre></div>
<pre><code>## # A tibble: 3,750 × 11
##    splits    id    cost_complexity tree_depth min_n .metric .estimator .estimate
##    &lt;list&gt;    &lt;chr&gt;           &lt;dbl&gt;      &lt;int&gt; &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;
##  1 &lt;split [… Fold…    0.0000000001          1     2 rmse    standard       0.326
##  2 &lt;split [… Fold…    0.0000000001          1     2 mae     standard       0.235
##  3 &lt;split [… Fold…    0.0000000001          1     2 mape    standard       1.97 
##  4 &lt;split [… Fold…    0.0000000001          1    11 rmse    standard       0.326
##  5 &lt;split [… Fold…    0.0000000001          1    11 mae     standard       0.235
##  6 &lt;split [… Fold…    0.0000000001          1    11 mape    standard       1.97 
##  7 &lt;split [… Fold…    0.0000000001          1    21 rmse    standard       0.326
##  8 &lt;split [… Fold…    0.0000000001          1    21 mae     standard       0.235
##  9 &lt;split [… Fold…    0.0000000001          1    21 mape    standard       1.97 
## 10 &lt;split [… Fold…    0.0000000001          1    30 rmse    standard       0.326
## # … with 3,740 more rows, and 3 more variables: .config &lt;chr&gt;, .notes &lt;list&gt;,
## #   .predictions &lt;list&gt;</code></pre>
<p>En la siguiente gráfica observamos el error cuadrático medio de las distintas métricas con distintos números de vecinos.</p>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="machine-learning-aprendizaje-supervisado.html#cb287-1" aria-hidden="true" tabindex="-1"></a>tree_tune_result <span class="sc">%&gt;%</span> </span>
<span id="cb287-2"><a href="machine-learning-aprendizaje-supervisado.html#cb287-2" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(<span class="at">metric =</span> <span class="st">&quot;rmse&quot;</span>)</span></code></pre></div>
<p><img src="Introducci%C3%B3n-a-Ciencia-de-Datos-y-Machine-Learning_files/figure-html/unnamed-chunk-280-1.png" width="672" /></p>
<p>En la siguiente gráfica observamos el error absoluto promedio de las distintas métricas con distintos números de vecinos.</p>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb288-1"><a href="machine-learning-aprendizaje-supervisado.html#cb288-1" aria-hidden="true" tabindex="-1"></a>tree_tune_result <span class="sc">%&gt;%</span> </span>
<span id="cb288-2"><a href="machine-learning-aprendizaje-supervisado.html#cb288-2" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(<span class="at">metric =</span> <span class="st">&quot;mae&quot;</span>)</span></code></pre></div>
<p><img src="Introducci%C3%B3n-a-Ciencia-de-Datos-y-Machine-Learning_files/figure-html/unnamed-chunk-281-1.png" width="672" /></p>
<p>Con el siguiente código obtenemos los mejores 10 modelos respecto al <em>rmse</em>.</p>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="machine-learning-aprendizaje-supervisado.html#cb289-1" aria-hidden="true" tabindex="-1"></a><span class="fu">show_best</span>(tree_tune_result, <span class="at">n =</span> <span class="dv">10</span>, <span class="at">metric =</span> <span class="st">&quot;rmse&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 10 × 9
##    cost_complexity tree_depth min_n .metric .estimator  mean     n std_err
##              &lt;dbl&gt;      &lt;int&gt; &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;
##  1    0.0000000001         11    40 rmse    standard   0.217    10 0.00828
##  2    0.0000000178         11    40 rmse    standard   0.217    10 0.00828
##  3    0.00000316           11    40 rmse    standard   0.217    10 0.00828
##  4    0.0000000001         15    40 rmse    standard   0.217    10 0.00831
##  5    0.0000000178         15    40 rmse    standard   0.217    10 0.00831
##  6    0.00000316           15    40 rmse    standard   0.217    10 0.00831
##  7    0.0000000001          8    40 rmse    standard   0.217    10 0.00818
##  8    0.0000000178          8    40 rmse    standard   0.217    10 0.00818
##  9    0.00000316            8    40 rmse    standard   0.217    10 0.00818
## 10    0.0000000001          8    30 rmse    standard   0.217    10 0.00799
## # … with 1 more variable: .config &lt;chr&gt;</code></pre>
<p>Ahora obtendremos el modelo que mejor desempeño tiene tomando en cuenta el <em>rmse</em> y haremos las predicciones del conjunto de prueba con este modelo.</p>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="machine-learning-aprendizaje-supervisado.html#cb291-1" aria-hidden="true" tabindex="-1"></a>best_tree_model_reg <span class="ot">&lt;-</span> <span class="fu">select_best</span>(tree_tune_result, <span class="at">metric =</span> <span class="st">&quot;rmse&quot;</span>)</span>
<span id="cb291-2"><a href="machine-learning-aprendizaje-supervisado.html#cb291-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-3"><a href="machine-learning-aprendizaje-supervisado.html#cb291-3" aria-hidden="true" tabindex="-1"></a>final_tree_model_reg <span class="ot">&lt;-</span> tree_workflow <span class="sc">%&gt;%</span> </span>
<span id="cb291-4"><a href="machine-learning-aprendizaje-supervisado.html#cb291-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">finalize_workflow</span>(best_tree_model_reg) <span class="sc">%&gt;%</span> </span>
<span id="cb291-5"><a href="machine-learning-aprendizaje-supervisado.html#cb291-5" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">fit</span>(<span class="at">data =</span> ames_train)</span>
<span id="cb291-6"><a href="machine-learning-aprendizaje-supervisado.html#cb291-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-7"><a href="machine-learning-aprendizaje-supervisado.html#cb291-7" aria-hidden="true" tabindex="-1"></a>results_reg <span class="ot">&lt;-</span> <span class="fu">predict</span>(final_tree_model_reg, ames_test) <span class="sc">%&gt;%</span> </span>
<span id="cb291-8"><a href="machine-learning-aprendizaje-supervisado.html#cb291-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(<span class="at">truth =</span> ames_test<span class="sc">$</span>Log_SalePrice)</span></code></pre></div>
<p>Nuestro árbol final se ve de la siguiente manera:</p>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="machine-learning-aprendizaje-supervisado.html#cb292-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart.plot)</span></code></pre></div>
<pre><code>## Loading required package: rpart</code></pre>
<pre><code>## 
## Attaching package: &#39;rpart&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:dials&#39;:
## 
##     prune</code></pre>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="machine-learning-aprendizaje-supervisado.html#cb296-1" aria-hidden="true" tabindex="-1"></a>final_tree_model_reg <span class="sc">%&gt;%</span></span>
<span id="cb296-2"><a href="machine-learning-aprendizaje-supervisado.html#cb296-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_fit_engine</span>() <span class="sc">%&gt;%</span></span>
<span id="cb296-3"><a href="machine-learning-aprendizaje-supervisado.html#cb296-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rpart.plot</span>(<span class="at">roundint =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Warning: labs do not fit even at cex 0.15, there may be some overplotting</code></pre>
<p><img src="Introducci%C3%B3n-a-Ciencia-de-Datos-y-Machine-Learning_files/figure-html/unnamed-chunk-284-1.png" width="672" /></p>
<p>Podemos obtener la impotancia de las variables:</p>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="machine-learning-aprendizaje-supervisado.html#cb298-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vip)</span>
<span id="cb298-2"><a href="machine-learning-aprendizaje-supervisado.html#cb298-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb298-3"><a href="machine-learning-aprendizaje-supervisado.html#cb298-3" aria-hidden="true" tabindex="-1"></a>final_tree_model_reg <span class="sc">%&gt;%</span> </span>
<span id="cb298-4"><a href="machine-learning-aprendizaje-supervisado.html#cb298-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_fit_parsnip</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb298-5"><a href="machine-learning-aprendizaje-supervisado.html#cb298-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">vip</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;Importancia de las variables&quot;</span>)</span></code></pre></div>
<p><img src="Introducci%C3%B3n-a-Ciencia-de-Datos-y-Machine-Learning_files/figure-html/unnamed-chunk-285-1.png" width="672" /></p>
</div>
<div id="métricas-de-desempeño-5" class="section level4" number="6.8.2.2">
<h4><span class="header-section-number">6.8.2.2</span> Métricas de desempeño</h4>
</div>
<div id="regresión-3" class="section level4" number="6.8.2.3">
<h4><span class="header-section-number">6.8.2.3</span> Regresión:</h4>
<p>Ahora para calcular las métricas de desempeño usaremos la paqueteria <em>MLmetrics</em></p>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="machine-learning-aprendizaje-supervisado.html#cb299-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MLmetrics)</span></code></pre></div>
<p><strong>MAE</strong></p>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="machine-learning-aprendizaje-supervisado.html#cb300-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(results_reg,MLmetrics<span class="sc">::</span><span class="fu">MAE</span>(.pred,truth))</span></code></pre></div>
<pre><code>## [1] 0.1545343</code></pre>
<p><strong>MAPE</strong></p>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="machine-learning-aprendizaje-supervisado.html#cb302-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(results_reg,MLmetrics<span class="sc">::</span><span class="fu">MAPE</span>(.pred,truth))</span></code></pre></div>
<pre><code>## [1] 0.01290951</code></pre>
<p><strong>RMSE</strong></p>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb304-1"><a href="machine-learning-aprendizaje-supervisado.html#cb304-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(results_reg,MLmetrics<span class="sc">::</span><span class="fu">RMSE</span>(.pred,truth))</span></code></pre></div>
<pre><code>## [1] 0.2108708</code></pre>
<p><strong><span class="math inline">\(R^2\)</span></strong></p>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb306-1"><a href="machine-learning-aprendizaje-supervisado.html#cb306-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(results_reg,MLmetrics<span class="sc">::</span><span class="fu">R2_Score</span>(.pred,truth))</span></code></pre></div>
<pre><code>## [1] 0.73325</code></pre>
<p><strong>RMSLE</strong></p>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb308-1"><a href="machine-learning-aprendizaje-supervisado.html#cb308-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(results_reg,MLmetrics<span class="sc">::</span><span class="fu">RMSLE</span>(.pred,truth))</span></code></pre></div>
<pre><code>## [1] 0.01633546</code></pre>
</div>
<div id="clasificación-2" class="section level4" number="6.8.2.4">
<h4><span class="header-section-number">6.8.2.4</span> Clasificación:</h4>

</div>
</div>
</div>
</div>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script>

$('.pipehover_incremental tr').hover(function() {
  $(this).removeClass()
  $(this).prevAll().removeClass()
  $(this).nextAll().removeClass()
  $(this).addClass('hover');
  $(this).prevAll().addClass('hover');
  $(this).closest('div').next().find('img').attr("src", $(this).attr("link"));
});


$('.pipehover_select_one_row tr').hover(function() {
  $(this).removeClass()
  $(this).prevAll().removeClass()
  $(this).nextAll().removeClass()
  $(this).addClass('hover');
  $(this).closest('div').next().find('img').attr("src", $(this).attr("link"));
});

</script>
            </section>

          </div>
        </div>
      </div>
<a href="machine-learning-conceptos-básicos.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="machine-learning-aprendizaje-no-supervisado.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Introducción a Ciencia de Datos y Machine Learning.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
